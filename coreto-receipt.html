<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CORETO â€” é ˜åæ›¸ãƒ»è«‹æ±‚æ›¸ç™ºè¡Œ</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Noto+Serif+JP:wght@400;700&family=DM+Mono:wght@400;500&family=Syne:wght@700;800&display=swap');
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#07090f;--card:#0f1119;--card2:#141720;--border:#1e2235;--border2:#252a3d;
  --gold:#c9a84c;--gold-dim:#7a5f22;
  --blue:#4f9cf9;--green:#34d399;--red:#f87171;--orange:#fb923c;--purple:#a78bfa;
  --muted:#4a5270;--sub:#7a849e;--text:#e2e6f3;
}
html,body{min-height:100%;font-family:'Noto Sans JP',sans-serif;background:var(--bg);color:var(--text)}
.hdr{height:54px;display:flex;align-items:center;justify-content:space-between;
  padding:0 26px;border-bottom:1px solid var(--border);background:rgba(7,9,15,.95);
  position:sticky;top:0;z-index:100}
.logo{font-family:'Syne',sans-serif;font-size:17px;font-weight:800;color:var(--gold);letter-spacing:3px}
.layout{display:flex;min-height:calc(100vh - 54px)}
/* Sidebar */
.sidebar{width:200px;flex-shrink:0;border-right:1px solid var(--border);
  background:var(--card);padding:14px 0}
.sb-section{font-size:8px;color:var(--muted);letter-spacing:2px;padding:12px 16px 5px;text-transform:uppercase}
.sb-item{display:flex;align-items:center;gap:9px;padding:8px 16px;font-size:12px;
  cursor:pointer;color:var(--sub);border-left:2px solid transparent;transition:.15s}
.sb-item:hover{color:var(--text);background:rgba(255,255,255,.02)}
.sb-item.on{color:var(--blue);background:rgba(79,156,249,.07);border-left-color:var(--blue)}
/* Main */
.main{flex:1;padding:26px 30px 80px;overflow-y:auto}
.ptitle{font-family:'Syne',sans-serif;font-size:17px;font-weight:800;margin-bottom:4px}
.psub{font-size:11px;color:var(--sub);margin-bottom:22px}
/* Cards */
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;margin-bottom:14px}
.ch{padding:12px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.ch-t{font-size:9px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;display:flex;align-items:center;gap:8px}
.ch-t::before{content:'';width:3px;height:11px;border-radius:2px;background:var(--gold)}
.cb{padding:18px 20px}
/* Pills */
.pill{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:6px;font-size:9px;font-weight:700}
.pg{background:rgba(52,211,153,.13);color:var(--green);border:1px solid rgba(52,211,153,.3)}
.pb{background:rgba(79,156,249,.12);color:var(--blue);border:1px solid rgba(79,156,249,.25)}
.po{background:rgba(251,146,60,.12);color:var(--orange);border:1px solid rgba(251,146,60,.3)}
.pr{background:rgba(248,113,113,.12);color:var(--red);border:1px solid rgba(248,113,113,.3)}
.pm{background:rgba(74,82,112,.15);color:var(--sub);border:1px solid var(--border2)}
.pgd{background:rgba(201,168,76,.13);color:var(--gold);border:1px solid var(--gold-dim)}
/* Buttons */
.btn{padding:9px 18px;border-radius:9px;font-size:11px;font-weight:700;cursor:pointer;
  font-family:'Noto Sans JP',sans-serif;transition:.15s;border:none;display:inline-flex;align-items:center;gap:6px}
.btn-blue{background:linear-gradient(135deg,var(--blue),#3070c0);color:#fff}
.btn-gold{background:linear-gradient(135deg,var(--gold),#a8742a);color:#0a0c10}
.btn-ghost{background:transparent;border:1px solid var(--border2);color:var(--sub)}
.btn-ghost:hover{color:var(--text);border-color:var(--sub)}
.btn-ok{background:rgba(52,211,153,.12);border:1px solid rgba(52,211,153,.3);color:var(--green)}
.btn-danger{background:rgba(248,113,113,.12);border:1px solid rgba(248,113,113,.3);color:var(--red)}
.btn-sm{padding:5px 12px;font-size:10px;border-radius:7px}
.btn:disabled{opacity:.4;cursor:not-allowed}
/* Grid */
.g2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
/* Fields */
.field{margin-bottom:12px}
.field label{display:block;font-size:10px;color:var(--sub);margin-bottom:5px;font-weight:600}
.field input,.field select,.field textarea{
  width:100%;background:#090b13;border:1px solid var(--border2);border-radius:9px;
  padding:9px 13px;color:var(--text);font-size:12px;font-family:'Noto Sans JP',sans-serif;outline:none;transition:.15s}
.field input:focus,.field select:focus,.field textarea:focus{border-color:var(--blue)}
.mono{font-family:'DM Mono',monospace}
/* Table */
.tbl{width:100%;border-collapse:collapse}
.tbl th{padding:8px 14px;font-size:9px;color:var(--muted);font-weight:700;letter-spacing:.5px;
  text-transform:uppercase;border-bottom:1px solid var(--border);background:var(--card2);text-align:left}
.tbl td{padding:10px 14px;border-bottom:1px solid rgba(30,34,53,.5);font-size:12px;vertical-align:middle}
.tbl tr:last-child td{border:none}
.tbl tr:hover td{background:rgba(255,255,255,.015)}
/* KPI cards */
.kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:20px}
.kpi{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px 16px}
.kv{font-family:'DM Mono',monospace;font-size:22px;font-weight:500;color:var(--gold);margin-bottom:3px}
.kl{font-size:10px;color:var(--muted)}
/* Stat row */
.stat-row{display:flex;gap:8px;align-items:center;padding:8px 0;border-bottom:1px solid rgba(30,34,53,.4);font-size:12px}
.stat-row:last-child{border:none}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px}
</style>
</head>
<body>
<div class="hdr">
  <div style="display:flex;align-items:center;gap:12px">
    <div class="logo">CORETO</div>
    <div style="width:1px;height:18px;background:var(--border2)"></div>
    <span style="font-size:10px;color:var(--muted);letter-spacing:1px">é ˜åæ›¸ãƒ»è«‹æ±‚æ›¸</span>
  </div>
  <div style="display:flex;gap:8px">
    <button class="btn btn-ghost btn-sm" onclick="location.href='coreto-hub.html'">ğŸ  ãƒ›ãƒ¼ãƒ </button>
  </div>
</div>

<div class="layout">
<div class="sidebar">
  <div class="sb-section">ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</div>
  <div class="sb-item on" id="sb-my"   onclick="showPage('my')">  <span>ğŸ“„</span>é ˜åæ›¸ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</div>
  <div class="sb-item" id="sb-req"  onclick="showPage('req')"> <span>ğŸ“</span>è«‹æ±‚æ›¸ç™ºè¡Œ</div>
  <div class="sb-section" style="margin-top:8px">HQç®¡ç†</div>
  <div class="sb-item" id="sb-hq"   onclick="showPage('hq')">  <span>ğŸ¢</span>ç™ºè¡Œç®¡ç†ãƒ»ä¸€æ‹¬å‡ºåŠ›</div>
  <div class="sb-item" id="sb-fee"  onclick="showPage('fee')"> <span>ğŸ’°</span>æœˆä¼šè²»é ˜åæ›¸</div>
  <div class="sb-section" style="margin-top:8px">ç´¹ä»‹</div>
  <div class="sb-item" onclick="openRefModal()" style="color:var(--gold)"> <span>ğŸ”—</span>ç´¹ä»‹ãƒªãƒ³ã‚¯ç™ºè¡Œ</div>
</div>

<div class="main" id="main"></div>
</div>

<script>
// â”€â”€â”€ Demo Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ME = {
  id:'10012', name:'å±±ç”° èª ', nameKana:'ãƒ¤ãƒãƒ€ ãƒã‚³ãƒˆ',
  type:'re', rank:'gold',
  phone:'090-1234-5678', email:'yamada@example.com',
  address:'æ±äº¬éƒ½æ¸‹è°·åŒºæµæ¯”å¯¿1-2-3 ã‚³ãƒ¬ãƒ¼ãƒˆãƒãƒ³ã‚·ãƒ§ãƒ³101',
};

const COMPANY = {
  name:'æ ªå¼ä¼šç¤¾CORETO', zip:'150-0013',
  address:'æ±äº¬éƒ½æ¸‹è°·åŒºæµæ¯”å¯¿1-1-1 COREBLDGãƒ“ãƒ«8F',
  tel:'03-1234-5678', email:'info@coreto.jp',
  regNum:'T1234567890123', // ã‚¤ãƒ³ãƒœã‚¤ã‚¹ç™»éŒ²ç•ªå·
};

const PAYSLIPS = [
  { month:'2026å¹´2æœˆ', gross:350000, fee:52500, tax:35735, net:261765, cases:3, date:'2026-02-25', status:'ç¢ºå®š' },
  { month:'2026å¹´1æœˆ', gross:210000, fee:31500, tax:21441, net:157059, cases:2, date:'2026-01-25', status:'æŒ¯è¾¼æ¸ˆ' },
  { month:'2025å¹´12æœˆ',gross:420000, fee:63000, tax:42882, net:314118, cases:4, date:'2025-12-25', status:'æŒ¯è¾¼æ¸ˆ' },
  { month:'2025å¹´11æœˆ',gross:280000, fee:42000, tax:28588, net:209412, cases:2, date:'2025-11-25', status:'æŒ¯è¾¼æ¸ˆ' },
];

const MONTHLY_FEE = [
  { month:'2026å¹´2æœˆ', amount:0,    date:'2026-02-01', status:'å¯¾è±¡å¤–ï¼ˆGoldãƒ©ãƒ³ã‚¯ï¼‰', receipt:'' },
  { month:'2026å¹´1æœˆ', amount:0,    date:'2026-01-01', status:'å¯¾è±¡å¤–ï¼ˆGoldãƒ©ãƒ³ã‚¯ï¼‰', receipt:'' },
  { month:'2025å¹´12æœˆ',amount:980,  date:'2025-12-01', status:'å¼•è½æ¸ˆï¼ˆBronzeæ™‚ï¼‰',  receipt:'RC-202512-10012' },
];

const ALL_AGENTS = [
  { id:'10012', name:'å±±ç”° èª ',   type:'re', month:'2026å¹´2æœˆ', gross:350000, net:261765, status:'ç¢ºå®š' },
  { id:'10008', name:'ä½è—¤ èŠ±å­', type:'re', month:'2026å¹´2æœˆ', gross:180000, net:133047, status:'æŒ¯è¾¼æ¸ˆ' },
  { id:'10023', name:'éˆ´æœ¨ å¥å¤ª', type:'re', month:'2026å¹´2æœˆ', gross:420000, net:314118, status:'ç¢ºå®š' },
  { id:'20005', name:'ç”°ä¸­ ç¾ç©‚', type:'hr', month:'2026å¹´2æœˆ', gross:290000, net:218523, status:'æŒ¯è¾¼æ¸ˆ' },
];

// â”€â”€â”€ Page routing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showPage(p) {
  document.querySelectorAll('.sb-item').forEach(el=>el.classList.remove('on'));
  document.getElementById('sb-'+p).classList.add('on');
  ({my:pageMy, req:pageReq, hq:pageHq, fee:pageFee}[p]||pageMy)();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE: é ˜åæ›¸ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè‡ªèº«ï¼‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function pageMy() {
  const rows = PAYSLIPS.map(p => `
    <tr>
      <td class="mono" style="font-size:11px">${p.month}</td>
      <td class="mono">Â¥${p.gross.toLocaleString()}</td>
      <td class="mono" style="color:var(--red)">-Â¥${p.fee.toLocaleString()}</td>
      <td class="mono" style="color:var(--orange)">-Â¥${p.tax.toLocaleString()}</td>
      <td class="mono" style="color:var(--green);font-weight:700">Â¥${p.net.toLocaleString()}</td>
      <td>${p.cases}ä»¶</td>
      <td><span class="pill ${p.status==='æŒ¯è¾¼æ¸ˆ'?'pg':p.status==='ç¢ºå®š'?'pb':'pm'}">${p.status}</span></td>
      <td>
        <div style="display:flex;gap:6px">
          <button class="btn btn-ghost btn-sm" onclick="printReceipt('reward','${p.month}')">ğŸ“„ é ˜åæ›¸</button>
          <button class="btn btn-ghost btn-sm" onclick="printPayslip('${p.month}')">ğŸ“Š æ˜ç´°æ›¸</button>
        </div>
      </td>
    </tr>`).join('');

  document.getElementById('main').innerHTML = `
    <div class="ptitle">é ˜åæ›¸ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</div>
    <div class="psub">æ¥­å‹™å§”è¨—å ±é…¬ã®é ˜åæ›¸ãƒ»æ˜ç´°æ›¸ã‚’æœˆæ¬¡ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™</div>

    <div class="kpi-grid">
      <div class="kpi"><div class="kv">Â¥1,260,000</div><div class="kl">2025å¹´åº¦ ç´¯è¨ˆå ±é…¬ï¼ˆç¨å¼•å‰ï¼‰</div></div>
      <div class="kpi"><div class="kv">Â¥946,354</div><div class="kl">2025å¹´åº¦ æ‰‹å–ã‚Šåˆè¨ˆ</div></div>
      <div class="kpi"><div class="kv">Â¥128,718</div><div class="kl">2025å¹´åº¦ æºæ³‰å¾´ååˆè¨ˆ</div></div>
      <div class="kpi"><div class="kv">11ä»¶</div><div class="kl">2025å¹´åº¦ æˆç´„ä»¶æ•°</div></div>
    </div>

    <div class="card">
      <div class="ch">
        <div class="ch-t">å ±é…¬æ˜ç´°ãƒ»é ˜åæ›¸ä¸€è¦§</div>
        <button class="btn btn-ghost btn-sm" onclick="printAllReceipts()">ğŸ“¦ å…¨æœŸé–“ã¾ã¨ã‚ã¦DL</button>
      </div>
      <div style="overflow-x:auto">
        <table class="tbl">
          <thead><tr>
            <th>å¯¾è±¡æœˆ</th><th>å ±é…¬é¡ï¼ˆç¨å¼•å‰ï¼‰</th><th>å³æ™‚æ‰•ã„æ‰‹æ•°æ–™</th><th>æºæ³‰å¾´åç¨</th>
            <th>æŒ¯è¾¼é¡</th><th>ä»¶æ•°</th><th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th><th>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</th>
          </tr></thead>
          <tbody>${rows}</tbody>
        </table>
      </div>
    </div>

    <div class="card">
      <div class="ch"><div class="ch-t">æºæ³‰å¾´åç¥¨ï¼ˆå¹´æ¬¡ï¼‰</div></div>
      <div class="cb">
        <div style="display:flex;align-items:center;justify-content:space-between;
                    padding:12px 16px;background:var(--card2);border-radius:10px">
          <div>
            <div style="font-size:12px;font-weight:700">2025å¹´åº¦ æºæ³‰å¾´åç¥¨</div>
            <div style="font-size:10px;color:var(--muted)">æ”¯æ‰•é‡‘é¡ï¼šÂ¥1,260,000 / æºæ³‰å¾´åç¨é¡ï¼šÂ¥128,718</div>
          </div>
          <button class="btn btn-ghost btn-sm" onclick="printGensen()">ğŸ“„ æºæ³‰å¾´åç¥¨ã‚’DL</button>
        </div>
        <div style="font-size:10px;color:var(--muted);margin-top:10px;line-height:1.8">
          ğŸ“Œ ç¢ºå®šç”³å‘Šã«ä½¿ç”¨ã™ã‚‹å ´åˆã¯æœ¬PDFã‚’ç¨å‹™ç½²ã¾ãŸã¯e-Taxã«æå‡ºã—ã¦ãã ã•ã„<br>
          ğŸ“Œ ç™ºè¡Œã¯ç¿Œå¹´1æœˆæœ«ã¾ã§ã«å®Œäº†ã—ã¾ã™
        </div>
      </div>
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE: è«‹æ±‚æ›¸ç™ºè¡Œï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒä»»æ„ç™ºè¡Œï¼‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function pageReq() {
  const now = new Date();
  const ym = `${now.getFullYear()}å¹´${now.getMonth()+1}æœˆ`;
  document.getElementById('main').innerHTML = `
    <div class="ptitle">è«‹æ±‚æ›¸ç™ºè¡Œ</div>
    <div class="psub">æ¥­å‹™å§”è¨—å ±é…¬ã®è«‹æ±‚æ›¸ã‚’ç™ºè¡Œã§ãã¾ã™ï¼ˆä»»æ„ï¼‰</div>

    <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;align-items:start">
      <div>
        <div class="card">
          <div class="ch"><div class="ch-t">è«‹æ±‚æ›¸æƒ…å ±</div></div>
          <div class="cb">
            <div class="field">
              <label>è«‹æ±‚æ›¸ç•ªå·ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰</label>
              <input type="text" value="INV-${now.getFullYear()}${String(now.getMonth()+1).padStart(2,'0')}-10012" readonly
                     style="color:var(--muted);cursor:not-allowed;background:rgba(255,255,255,.02)">
            </div>
            <div class="g2">
              <div class="field">
                <label>ç™ºè¡Œæ—¥</label>
                <input type="date" id="inv-date" value="${now.toISOString().slice(0,10)}" oninput="updatePreview()">
              </div>
              <div class="field">
                <label>æ”¯æ‰•æœŸé™</label>
                <input type="date" id="inv-due" value="${new Date(now.getTime()+30*864e5).toISOString().slice(0,10)}" oninput="updatePreview()">
              </div>
            </div>
            <div class="field">
              <label>è«‹æ±‚å…ˆ</label>
              <select id="inv-to" oninput="updatePreview()">
                <option>æ ªå¼ä¼šç¤¾CORETOï¼ˆæœ¬éƒ¨ï¼‰</option>
              </select>
            </div>
            <div class="field">
              <label>ä»¶å</label>
              <input type="text" id="inv-title" value="${ym}åˆ† æ¥­å‹™å§”è¨—å ±é…¬" oninput="updatePreview()">
            </div>
            <div class="field">
              <label>é‡‘é¡ï¼ˆç¨å¼•å‰ï¼‰</label>
              <input type="number" id="inv-amount" value="350000" oninput="updatePreview()"
                     placeholder="ä¾‹ï¼š350000">
            </div>
            <div class="field">
              <label>å‚™è€ƒ</label>
              <textarea id="inv-note" rows="2" oninput="updatePreview()"
                placeholder="ä¾‹ï¼š2026å¹´2æœˆåˆ† è³ƒè²¸ä»²ä»‹3ä»¶">${ym}åˆ† è³ƒè²¸ä»²ä»‹æ¥­å‹™ 3ä»¶åˆ†</textarea>
            </div>
            <button class="btn btn-gold" onclick="printInvoice()" style="width:100%;justify-content:center">
              ğŸ“„ è«‹æ±‚æ›¸ã‚’ç™ºè¡Œãƒ»å°åˆ·ã™ã‚‹
            </button>
          </div>
        </div>
      </div>

      <!-- Preview -->
      <div class="card" id="inv-preview-card">
        <div class="ch"><div class="ch-t">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</div><span class="pill pm">A4</span></div>
        <div id="inv-preview" style="padding:20px;font-size:11px"></div>
      </div>
    </div>`;
  updatePreview();
}

function updatePreview() {
  const date   = document.getElementById('inv-date')?.value || '';
  const due    = document.getElementById('inv-due')?.value || '';
  const title  = document.getElementById('inv-title')?.value || '';
  const amount = parseInt(document.getElementById('inv-amount')?.value || 0);
  const note   = document.getElementById('inv-note')?.value || '';
  const tax    = amount <= 1000000 ? Math.floor(amount*0.1021) : Math.floor(1000000*0.1021+(amount-1000000)*0.2042);
  const net    = amount - tax;
  const fmt    = v => 'Â¥'+v.toLocaleString();

  document.getElementById('inv-preview').innerHTML = `
    <div style="background:white;color:#1a1a1a;border-radius:8px;padding:24px;font-family:'Noto Sans JP',sans-serif">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:20px">
        <div>
          <div style="font-size:20px;font-weight:800;letter-spacing:2px;color:#c9a84c;margin-bottom:4px">è«‹æ±‚æ›¸</div>
          <div style="font-size:9px;color:#999">INV-${new Date().getFullYear()}${String(new Date().getMonth()+1).padStart(2,'0')}-10012</div>
        </div>
        <div style="text-align:right;font-size:9px;color:#666;line-height:1.8">
          ${COMPANY.name}<br>${COMPANY.address}<br>
          ç™»éŒ²ç•ªå·ï¼š${COMPANY.regNum}
        </div>
      </div>
      <div style="font-size:11px;margin-bottom:16px">
        <div style="font-weight:700;margin-bottom:4px">${COMPANY.name} å¾¡ä¸­</div>
        <div style="color:#666">ç™ºè¡Œæ—¥ï¼š${date.replace(/-/g,'/')} &nbsp;&nbsp; æ”¯æ‰•æœŸé™ï¼š${due.replace(/-/g,'/')}</div>
      </div>
      <div style="background:#f8f8f8;padding:12px 14px;border-radius:6px;margin-bottom:14px">
        <div style="font-size:12px;font-weight:700;margin-bottom:8px">${title}</div>
        <div style="font-size:10px;color:#666;line-height:1.8">${note}</div>
      </div>
      <table style="width:100%;border-collapse:collapse;font-size:10px;margin-bottom:12px">
        <tr style="background:#f0f0f0">
          <th style="padding:6px 10px;text-align:left;border:0.5px solid #ddd">æ‘˜è¦</th>
          <th style="padding:6px 10px;text-align:right;border:0.5px solid #ddd">é‡‘é¡</th>
        </tr>
        <tr>
          <td style="padding:8px 10px;border:0.5px solid #ddd">${title}</td>
          <td style="padding:8px 10px;border:0.5px solid #ddd;text-align:right;font-family:monospace">${fmt(amount)}</td>
        </tr>
        <tr style="background:#fff9ee">
          <td style="padding:6px 10px;border:0.5px solid #ddd;color:#c9a84c;font-weight:700">æºæ³‰å¾´åç¨ï¼ˆæ§é™¤é¡ï¼‰</td>
          <td style="padding:6px 10px;border:0.5px solid #ddd;text-align:right;color:#e86;font-family:monospace">-${fmt(tax)}</td>
        </tr>
        <tr style="background:#f0fff4">
          <td style="padding:8px 10px;border:0.5px solid #ddd;font-weight:700">æŒ¯è¾¼é¡ï¼ˆç¨å¼•å¾Œï¼‰</td>
          <td style="padding:8px 10px;border:0.5px solid #ddd;text-align:right;font-weight:700;color:#168;font-family:monospace">${fmt(net)}</td>
        </tr>
      </table>
      <div style="font-size:9px;color:#999;line-height:1.8">
        æŒ¯è¾¼å…ˆï¼šâ—‹â—‹éŠ€è¡Œ â—‹â—‹æ”¯åº— æ™®é€š 0000000 ãƒ¤ãƒãƒ€ ãƒã‚³ãƒˆ<br>
        è«‹æ±‚è€…ï¼š${ME.name}ï¼ˆ${ME.nameKana}ï¼‰/ ID: ${ME.id}<br>
        ${ME.address}
      </div>
    </div>`;
}

function printInvoice() {
  const previewHTML = document.getElementById('inv-preview').innerHTML;
  const w = window.open('','_blank','width=800,height:900');
  w.document.write(`<!DOCTYPE html><html><head><meta charset="UTF-8">
    <title>è«‹æ±‚æ›¸</title>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap');
      *{box-sizing:border-box;margin:0;padding:0} body{background:white;font-family:'Noto Sans JP',sans-serif}
      .wrap{max-width:700px;margin:20px auto;padding:30px}
      @media print{@page{size:A4;margin:15mm} .no-print{display:none}}
    </style></head><body>
    <div class="no-print" style="text-align:center;padding:16px;background:#f5f5f5;margin-bottom:20px">
      <button onclick="window.print()" style="padding:10px 24px;background:#c9a84c;color:#fff;
        border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">
        ğŸ“„ å°åˆ·ãƒ»PDFã«ä¿å­˜
      </button>
      <button onclick="window.close()" style="margin-left:10px;padding:10px 16px;background:#fff;
        border:1px solid #ccc;border-radius:8px;font-size:12px;cursor:pointer">é–‰ã˜ã‚‹</button>
    </div>
    <div class="wrap">${previewHTML}</div>
    </body></html>`);
  w.document.close();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE: HQ ç™ºè¡Œç®¡ç†
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function pageHq() {
  document.getElementById('main').innerHTML = `
    <div class="ptitle">é ˜åæ›¸ãƒ»æ˜ç´°æ›¸ ç™ºè¡Œç®¡ç†</div>
    <div class="psub">å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å ±é…¬æ˜ç´°æ›¸ãƒ»é ˜åæ›¸ã®ç™ºè¡Œãƒ»ä¸€æ‹¬å‡ºåŠ›ã‚’ç®¡ç†ã—ã¾ã™</div>

    <div class="kpi-grid">
      <div class="kpi"><div class="kv">24å</div><div class="kl">å¯¾è±¡ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ•°</div></div>
      <div class="kpi"><div class="kv">Â¥8,240,000</div><div class="kl">2026å¹´2æœˆ ç·å ±é…¬é¡</div></div>
      <div class="kpi"><div class="kv">18å</div><div class="kl">æ˜ç´°æ›¸ç¢ºèªæ¸ˆã¿</div></div>
      <div class="kpi"><div class="kv">6å</div><div class="kl">æœªç¢ºèªï¼ˆè¦ãƒ•ã‚©ãƒ­ãƒ¼ï¼‰</div></div>
    </div>

    <div class="card">
      <div class="ch">
        <div class="ch-t">ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¥ ç™ºè¡ŒçŠ¶æ³</div>
        <div style="display:flex;gap:8px">
          <select style="background:#090b13;border:1px solid var(--border2);color:var(--sub);
                         padding:5px 10px;border-radius:7px;font-size:11px">
            <option>2026å¹´2æœˆ</option><option>2026å¹´1æœˆ</option><option>2025å¹´12æœˆ</option>
          </select>
          <button class="btn btn-gold btn-sm" onclick="bulkPrint()">ğŸ“¦ å…¨å“¡åˆ†ã¾ã¨ã‚ã¦ç™ºè¡Œ</button>
          <button class="btn btn-ghost btn-sm" onclick="exportAllCSV()">ğŸ“¥ CSVå‡ºåŠ›</button>
        </div>
      </div>
      <table class="tbl">
        <thead><tr>
          <th>ID</th><th>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</th><th>ç¨®åˆ¥</th><th>å ±é…¬é¡ï¼ˆç¨å¼•å‰ï¼‰</th>
          <th>æ‰‹å–ã‚Š</th><th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th><th>æ“ä½œ</th>
        </tr></thead>
        <tbody>
          ${ALL_AGENTS.map(a=>`<tr>
            <td class="mono" style="font-size:11px">${a.id}</td>
            <td style="font-weight:700">${a.name}</td>
            <td><span class="pill ${a.type==='re'?'pb':'po'}">${a.type==='re'?'è³ƒè²¸':'HR'}</span></td>
            <td class="mono">Â¥${a.gross.toLocaleString()}</td>
            <td class="mono" style="color:var(--green)">Â¥${a.net.toLocaleString()}</td>
            <td><span class="pill ${a.status==='æŒ¯è¾¼æ¸ˆ'?'pg':'pb'}">${a.status}</span></td>
            <td>
              <div style="display:flex;gap:5px">
                <button class="btn btn-ghost btn-sm" onclick="printAgentReceipt('${a.id}','${a.name}')">ğŸ“„ ç™ºè¡Œ</button>
                <button class="btn btn-ghost btn-sm" onclick="sendEmail('${a.name}')">ğŸ“§ é€ä¿¡</button>
              </div>
            </td>
          </tr>`).join('')}
        </tbody>
      </table>
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE: æœˆä¼šè²»é ˜åæ›¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function pageFee() {
  document.getElementById('main').innerHTML = `
    <div class="ptitle">æœˆä¼šè²» é ˜åæ›¸</div>
    <div class="psub">æœˆé¡ä¼šè²»ã®é ˜åæ›¸ã‚’ç™ºè¡Œã—ã¾ã™</div>

    <div class="card" style="max-width:700px">
      <div class="ch"><div class="ch-t">æœˆä¼šè²» å¼•ãè½ã¨ã—å±¥æ­´</div></div>
      <table class="tbl">
        <thead><tr><th>å¯¾è±¡æœˆ</th><th>é‡‘é¡</th><th>å¼•ãè½ã¨ã—æ—¥</th><th>çŠ¶æ…‹</th><th>é ˜åæ›¸</th></tr></thead>
        <tbody>
          ${MONTHLY_FEE.map(f=>`<tr>
            <td>${f.month}</td>
            <td class="mono">Â¥${f.amount.toLocaleString()}</td>
            <td class="mono" style="font-size:11px">${f.date}</td>
            <td><span class="pill pg">${f.status}</span></td>
            <td>
              <button class="btn btn-ghost btn-sm" onclick="printFeeReceipt('${f.month}','${f.receipt}',${f.amount})">
                ğŸ“„ ${f.receipt}
              </button>
            </td>
          </tr>`).join('')}
        </tbody>
      </table>
    </div>

    <div class="card" style="max-width:700px">
      <div class="ch"><div class="ch-t">æœˆä¼šè²»ã«ã¤ã„ã¦</div></div>
      <div class="cb" style="font-size:12px;color:var(--sub);line-height:2">
        æœˆé¡ä¼šè²»ï¼š<strong style="color:var(--text)">Â¥980 / Â¥0ï¼ˆGoldãƒ©ãƒ³ã‚¯ä»¥ä¸Šã¯ç„¡æ–™ï¼‰ï¼ˆç¨è¾¼ï¼‰</strong><br>
        å¼•ãè½ã¨ã—æ—¥ï¼šæ¯æœˆ1æ—¥ï¼ˆç™»éŒ²ã‚«ãƒ¼ãƒ‰ã‹ã‚‰è‡ªå‹•æ±ºæ¸ˆï¼‰<br>
        é ˜åæ›¸ï¼šå¼•ãè½ã¨ã—å®Œäº†å¾Œã€ç¿Œæ—¥ã‚ˆã‚Šãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½<br>
        ã‚¤ãƒ³ãƒœã‚¤ã‚¹å¯¾å¿œï¼šé©æ ¼è«‹æ±‚æ›¸ç™ºè¡Œäº‹æ¥­è€…ï¼ˆç™»éŒ²ç•ªå· T1234567890123ï¼‰
      </div>
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Print helpers
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openPrintWindow(html, title) {
  const w = window.open('','_blank','width=700,height=850');
  w.document.write(`<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8">
    <title>${title}</title>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Noto+Serif+JP:wght@400;700&display=swap');
      *{box-sizing:border-box;margin:0;padding:0}
      body{background:white;font-family:'Noto Sans JP',sans-serif;color:#1a1a1a}
      .ctrl{padding:16px;background:#f5f5f5;text-align:center;border-bottom:1px solid #ddd}
      .ctrl button{padding:9px 20px;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;margin:0 5px;border:none}
      .print-btn{background:#c9a84c;color:#fff} .close-btn{background:white;border:1px solid #ccc!important;color:#666}
      @media print{.ctrl{display:none}@page{size:A4;margin:15mm}}
    
/* â”€â”€ ç´¹ä»‹ãƒªãƒ³ã‚¯ãƒ¢ãƒ¼ãƒ€ãƒ« â”€â”€ */
#ref-modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.65);z-index:9000;align-items:center;justify-content:center}
#ref-modal-overlay.open{display:flex}
#ref-modal{background:var(--card);border:1px solid var(--border2);border-radius:16px;padding:0;width:min(460px,92vw);overflow:hidden}
.ref-mhdr{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.ref-mhdr-t{font-family:'Syne',sans-serif;font-size:14px;font-weight:800;color:var(--gold)}
.ref-mbody{padding:20px}
.ref-url{background:var(--card2);border:1px solid var(--border2);border-radius:8px;padding:10px 12px;font-family:'DM Mono',monospace;font-size:11px;color:var(--sub);word-break:break-all;margin:10px 0;min-height:36px}
.ref-copy-btn{width:100%;padding:10px;border-radius:8px;border:none;cursor:pointer;font-family:inherit;font-size:13px;font-weight:700;background:var(--gold);color:#0a0c10;margin-top:4px}
.ref-copy-btn:hover{opacity:.9}
</style></head><body>
    <div class="ctrl">
      <button class="print-btn" onclick="window.print()">ğŸ“„ å°åˆ·ãƒ»PDFã«ä¿å­˜</button>
      <button class="close-btn" onclick="window.close()">é–‰ã˜ã‚‹</button>
    </div>
    <div style="padding:40px">${html}</div></body></html>`);
  w.document.close();
}

function printReceipt(type, month) {
  const p = PAYSLIPS.find(x=>x.month===month) || PAYSLIPS[0];
  const html = `
    <div style="max-width:600px;margin:0 auto">
      <div style="text-align:center;margin-bottom:24px">
        <div style="font-family:'Noto Serif JP',serif;font-size:24px;font-weight:700;
                    letter-spacing:4px;margin-bottom:8px">é ˜ å æ›¸</div>
        <div style="font-size:10px;color:#999">No. RC-${month.replace(/[å¹´æœˆ]/g,'')}-${ME.id}</div>
      </div>
      <div style="font-size:12px;margin-bottom:20px;border-bottom:1px solid #eee;padding-bottom:16px">
        <strong>${ME.name}ï¼ˆ${ME.nameKana}ï¼‰</strong> æ®¿<br>
        <span style="color:#666">ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆID: ${ME.id}</span>
      </div>
      <div style="background:#f9f9f9;border-radius:8px;padding:20px;margin-bottom:20px">
        <div style="font-size:28px;font-weight:700;text-align:center;margin-bottom:8px;
                    font-family:'Noto Serif JP',serif">Â¥${p.net.toLocaleString()}</div>
        <div style="text-align:center;font-size:10px;color:#999">ï¼ˆæŒ¯è¾¼é‡‘é¡ãƒ»æºæ³‰å¾´åç¨æ§é™¤å¾Œï¼‰</div>
      </div>
      <table style="width:100%;border-collapse:collapse;font-size:11px;margin-bottom:16px">
        <tr><td style="padding:8px;border-bottom:0.5px solid #eee;color:#666">å¯¾è±¡æœˆ</td>
            <td style="padding:8px;border-bottom:0.5px solid #eee;text-align:right">${month}</td></tr>
        <tr><td style="padding:8px;border-bottom:0.5px solid #eee;color:#666">æ¥­å‹™å§”è¨—å ±é…¬</td>
            <td style="padding:8px;border-bottom:0.5px solid #eee;text-align:right">Â¥${p.gross.toLocaleString()}</td></tr>
        <tr><td style="padding:8px;border-bottom:0.5px solid #eee;color:#c9a84c">å³æ™‚æ‰•ã„æ‰‹æ•°æ–™</td>
            <td style="padding:8px;border-bottom:0.5px solid #eee;text-align:right;color:#c9a84c">-Â¥${p.fee.toLocaleString()}</td></tr>
        <tr><td style="padding:8px;border-bottom:0.5px solid #eee;color:#e86">æºæ³‰å¾´åç¨</td>
            <td style="padding:8px;border-bottom:0.5px solid #eee;text-align:right;color:#e86">-Â¥${p.tax.toLocaleString()}</td></tr>
        <tr style="font-weight:700"><td style="padding:8px;color:#168">æŒ¯è¾¼é¡</td>
            <td style="padding:8px;text-align:right;color:#168">Â¥${p.net.toLocaleString()}</td></tr>
      </table>
      <div style="border-top:2px solid #1a1a1a;padding-top:16px;margin-top:16px;font-size:11px;color:#666">
        ä¸Šè¨˜ã®é‡‘é¡ã‚’ç¢ºã‹ã«é ˜åã„ãŸã—ã¾ã—ãŸ<br><br>
        ç™ºè¡Œæ—¥ï¼š${new Date().toLocaleDateString('ja-JP')}<br>
        ${COMPANY.name}<br>
        ${COMPANY.address}<br>
        é©æ ¼è«‹æ±‚æ›¸ç™ºè¡Œäº‹æ¥­è€…ç™»éŒ²ç•ªå·ï¼š${COMPANY.regNum}
      </div>
    </div>`;
  openPrintWindow(html, `é ˜åæ›¸_${month}_${ME.name}`);
}

function printPayslip(month) {
  const p = PAYSLIPS.find(x=>x.month===month) || PAYSLIPS[0];
  alert(`ğŸ“Š ${month}åˆ†ã®æ”¯æ‰•æ˜ç´°æ›¸ã‚’å°åˆ·ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é–‹ãã¾ã™`);
}

function printGensen() {
  const html = `
    <div style="max-width:600px;margin:0 auto">
      <div style="text-align:center;font-family:'Noto Serif JP',serif;font-size:20px;font-weight:700;
                  letter-spacing:2px;margin-bottom:24px">æºæ³‰å¾´åç¥¨</div>
      <table style="width:100%;border-collapse:collapse;font-size:11px">
        <tr style="background:#f5f5f5">
          <td style="padding:8px 12px;border:0.5px solid #ddd;font-weight:700">æ”¯æ‰•è€…</td>
          <td style="padding:8px 12px;border:0.5px solid #ddd">${COMPANY.name}</td>
        </tr>
        <tr>
          <td style="padding:8px 12px;border:0.5px solid #ddd;font-weight:700">å—çµ¦è€…</td>
          <td style="padding:8px 12px;border:0.5px solid #ddd">${ME.name}ï¼ˆ${ME.nameKana}ï¼‰</td>
        </tr>
        <tr style="background:#f5f5f5">
          <td style="padding:8px 12px;border:0.5px solid #ddd;font-weight:700">æ”¯æ‰•é‡‘é¡</td>
          <td style="padding:8px 12px;border:0.5px solid #ddd;font-weight:700;font-size:14px">Â¥1,260,000</td>
        </tr>
        <tr>
          <td style="padding:8px 12px;border:0.5px solid #ddd;font-weight:700">æºæ³‰å¾´åç¨é¡</td>
          <td style="padding:8px 12px;border:0.5px solid #ddd">Â¥128,718</td>
        </tr>
        <tr style="background:#f5f5f5">
          <td style="padding:8px 12px;border:0.5px solid #ddd;font-weight:700">å¯¾è±¡å¹´åº¦</td>
          <td style="padding:8px 12px;border:0.5px solid #ddd">2025å¹´ï¼ˆä»¤å’Œ7å¹´ï¼‰</td>
        </tr>
      </table>
      <div style="margin-top:20px;font-size:10px;color:#999;line-height:1.8">
        ç™ºè¡Œæ—¥ï¼š${new Date().toLocaleDateString('ja-JP')}<br>
        ${COMPANY.name} / ${COMPANY.address}
      </div>
    </div>`;
  openPrintWindow(html, `æºæ³‰å¾´åç¥¨_2025_${ME.name}`);
}

function printFeeReceipt(month, rcNum, amount) {
  amount = amount || 980;
  const tax = Math.round(amount - amount / 1.1);
  const excl = amount - tax;
  const html = `
    <div style="max-width:500px;margin:0 auto;text-align:center">
      <div style="font-family:'Noto Serif JP',serif;font-size:22px;font-weight:700;
                  letter-spacing:4px;margin-bottom:20px">é ˜ å æ›¸</div>
      <div style="text-align:left;margin-bottom:16px;font-size:12px">
        <strong>${ME.name}ï¼ˆ${ME.nameKana}ï¼‰</strong> æ®¿
      </div>
      <div style="background:#f9f9f9;border-radius:8px;padding:20px;margin-bottom:16px">
        <div style="font-size:32px;font-weight:700;font-family:'Noto Serif JP',serif">Â¥${amount.toLocaleString()}</div>
        <div style="font-size:10px;color:#999;margin-top:4px">ï¼ˆç¨è¾¼ / æ¶ˆè²»ç¨ Â¥${tax.toLocaleString()} / ç¨æŠœ Â¥${excl.toLocaleString()}ï¼‰</div>
      </div>
      <table style="width:100%;border-collapse:collapse;font-size:11px;margin-bottom:16px;text-align:left">
        <tr><td style="padding:7px;border-bottom:0.5px solid #eee;color:#666">å“ç›®</td>
            <td style="padding:7px;border-bottom:0.5px solid #eee">CORETO æœˆé¡ä¼šè²»ï¼ˆ${month}ï¼‰</td></tr>
        <tr><td style="padding:7px;border-bottom:0.5px solid #eee;color:#666">é ˜åæ›¸ç•ªå·</td>
            <td style="padding:7px;border-bottom:0.5px solid #eee">${rcNum}</td></tr>
      </table>
      <div style="border-top:1px solid #ddd;padding-top:14px;font-size:10px;color:#666;text-align:left">
        ä¸Šè¨˜ã®é‡‘é¡ã‚’ç¢ºã‹ã«é ˜åã„ãŸã—ã¾ã—ãŸ<br><br>
        ${COMPANY.name} / ${COMPANY.address}<br>
        é©æ ¼è«‹æ±‚æ›¸ç™ºè¡Œäº‹æ¥­è€…ç™»éŒ²ç•ªå·ï¼š${COMPANY.regNum}
      </div>
    </div>`;
  openPrintWindow(html, `æœˆä¼šè²»é ˜åæ›¸_${month}`);
}

function printAgentReceipt(id, name) { alert(`ğŸ“„ ${name}ï¼ˆ${id}ï¼‰ã®æ˜ç´°æ›¸ã‚’ç™ºè¡Œã—ã¾ã™`); }
function sendEmail(name) { alert(`ğŸ“§ ${name} ã¸æ˜ç´°æ›¸ã‚’ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã—ã¾ã—ãŸ`); }
function bulkPrint() { alert('ğŸ“¦ å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ†ã®æ˜ç´°æ›¸PDFï¼ˆZIPï¼‰ã®ç”Ÿæˆã‚’é–‹å§‹ã—ã¾ã—ãŸ\nå‡¦ç†å®Œäº†å¾Œã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ãŒå±Šãã¾ã™'); }
function exportAllCSV() { alert('ğŸ“¥ CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ'); }
function printAllReceipts() { alert('ğŸ“¦ å…¨æœŸé–“åˆ†ã®é ˜åæ›¸ã‚’ã¾ã¨ã‚ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™'); }

// Init
showPage('my');

// â”€â”€ ç´¹ä»‹ãƒªãƒ³ã‚¯ãƒ¢ãƒ¼ãƒ€ãƒ« â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var _refCurrentCode = '';
function openRefModal() {
  var overlay = document.getElementById('ref-modal-overlay');
  var selector = document.getElementById('ref-code-selector');
  var isExec = (typeof session !== 'undefined' && session && session.hqRole === 'exec')
            || (typeof CURRENT_USER !== 'undefined' && CURRENT_USER && CURRENT_USER.hqRole === 'exec');
  var agentId = (typeof session !== 'undefined' && session && session.userId) ? session.userId
              : (typeof ME !== 'undefined' && ME && ME.id) ? ME.id
              : (typeof AGENT !== 'undefined' && AGENT && AGENT.id) ? AGENT.id : '10012';
  if (isExec) {
    var SPECIAL = ['FOUNDER2026','WELCOME2026','GOLD_START','HR_PRO75'];
    var opts = SPECIAL.map(function(c){ return '<option value="'+c+'">â­ '+c+'</option>'; }).join('');
    selector.innerHTML =
      '<div style="margin-bottom:12px"><div style="font-size:10px;color:var(--sub);font-weight:600;margin-bottom:5px">ã‚³ãƒ¼ãƒ‰ç¨®åˆ¥</div>'
      +'<select id="ref-code-select" onchange="updateRefLink()" style="width:100%;padding:8px 10px;background:var(--card2);border:1px solid var(--border2);border-radius:8px;color:var(--text);font-size:12px;font-family:inherit">'
      +'<option value="'+agentId+'">è‡ªåˆ†ã®IDï¼ˆ'+agentId+'ï¼‰</option>'
      +'<optgroup label="â”€â”€ ç‰¹åˆ¥ã‚³ãƒ¼ãƒ‰ â”€â”€">'+opts+'</optgroup>'
      +'</select></div>';
    _refCurrentCode = agentId;
  } else {
    selector.innerHTML =
      '<div style="display:flex;align-items:center;gap:8px;margin-bottom:12px;padding:8px 12px;background:rgba(201,168,76,.06);border:1px solid rgba(201,168,76,.2);border-radius:8px">'
      +'<span style="font-size:11px;color:var(--muted)">ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ï¼š</span>'
      +'<span style="font-family:\'DM Mono\',monospace;font-size:13px;font-weight:700;color:var(--gold)">'+agentId+'</span>'
      +'</div>';
    _refCurrentCode = agentId;
  }
  updateRefLink();
  overlay.classList.add('open');
}
function updateRefLink() {
  var sel = document.getElementById('ref-code-select');
  if (sel) _refCurrentCode = sel.value;
  var base = location.origin + location.pathname.replace(/[^/]*$/, '') + 'coreto-agent-signup.html';
  var url = base + '?ref=' + encodeURIComponent(_refCurrentCode);
  document.getElementById('ref-url-display').textContent = url;
}
function closeRefModal() {
  document.getElementById('ref-modal-overlay').classList.remove('open');
}
function copyRefLink() {
  var url = document.getElementById('ref-url-display').textContent;
  navigator.clipboard.writeText(url).then(function() {
    var btn = document.querySelector('.ref-copy-btn');
    btn.textContent = 'âœ… ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ';
    setTimeout(function(){ btn.textContent = 'ğŸ“‹ ã‚³ãƒ”ãƒ¼'; }, 2000);
  }).catch(function() {
    var ta = document.createElement('textarea');
    ta.value = url; document.body.appendChild(ta); ta.select();
    document.execCommand('copy'); document.body.removeChild(ta);
  });
}
</script>

<div id="ref-modal-overlay" onclick="if(event.target===this)closeRefModal()">
  <div id="ref-modal">
    <div class="ref-mhdr">
      <div class="ref-mhdr-t">ğŸ”— ç´¹ä»‹ãƒªãƒ³ã‚¯ç™ºè¡Œ</div>
      <button onclick="closeRefModal()" style="background:none;border:none;color:var(--muted);font-size:20px;cursor:pointer;line-height:1">Ã—</button>
    </div>
    <div class="ref-mbody">
      <div style="font-size:11px;color:var(--sub);margin-bottom:14px;line-height:1.8">ã“ã®ãƒªãƒ³ã‚¯ã‹ã‚‰å…¥ä¼šã™ã‚‹ã¨ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ãŒè‡ªå‹•å…¥åŠ›ã•ã‚Œã¾ã™ã€‚</div>
      <div id="ref-code-selector"></div>
      <div style="font-size:10px;color:var(--muted);margin-bottom:4px;font-weight:600;letter-spacing:.5px">ç™ºè¡Œãƒªãƒ³ã‚¯</div>
      <div class="ref-url" id="ref-url-display">â€”</div>
      <button class="ref-copy-btn" onclick="copyRefLink()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
    </div>
  </div>
</div>
</body>
</html>
