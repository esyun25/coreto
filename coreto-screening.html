<!DOCTYPE html>
<html lang="ja">
<head>
  <!-- â”€â”€ Content Security Policy (XSSè»½æ¸›) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       å¤‰æ›´æ™‚: ä½¿ç”¨ã™ã‚‹å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚ªãƒªã‚¸ãƒ³ã‚’è¿½åŠ ã—ã¦ãã ã•ã„
       Kintoneè¿½åŠ æ™‚: connect-src ã« *.cybozu.com ã‚’è¿½åŠ 
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline'
      https://cdnjs.cloudflare.com
      https://js.stripe.com
      https://cdn-cgi/scripts;
    style-src 'self' 'unsafe-inline'
      https://fonts.googleapis.com;
    font-src 'self'
      https://fonts.gstatic.com;
    img-src 'self' data: blob:;
    connect-src 'self'
      https://hooks.slack.com
      https://hooks.zapier.com
      https://api.stripe.com
      https://js.stripe.com
      https://www.houjin-bangou.nta.go.jp
      https://www.retio.or.jp;
    frame-src 'none';
    object-src 'none';
    base-uri 'self';
  ">

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CORETO æ›¸é¡å¯©æŸ»ãƒã‚§ãƒƒã‚¯ã‚·ãƒ¼ãƒˆ</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=DM+Mono:wght@400;500&family=Syne:wght@700;800&display=swap');
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#07090f;--card:#0f1119;--card2:#141720;--border:#1e2235;--border2:#252a3d;
  --gold:#c9a84c;--gold-l:#e8c96a;--gold-dim:#7a5f22;
  --blue:#4f9cf9;--green:#34d399;--red:#f87171;--orange:#fb923c;--purple:#a78bfa;
  --muted:#4a5270;--sub:#7a849e;--text:#e2e6f3;
}
body{font-family:'Noto Sans JP',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;
  background-image:radial-gradient(ellipse 60% 50% at 20% 0%,rgba(79,156,249,.04) 0%,transparent 60%)}

/* â”€ Header â”€ */
.header{display:flex;align-items:center;justify-content:space-between;padding:0 28px;height:54px;
  border-bottom:1px solid var(--border);background:rgba(7,9,15,.9);backdrop-filter:blur(12px);
  position:sticky;top:0;z-index:200}
.logo{font-family:'Syne',sans-serif;font-size:18px;font-weight:800;color:var(--gold);letter-spacing:3px}
.hdr-badge{background:rgba(248,113,113,.12);border:1px solid rgba(248,113,113,.25);
  color:var(--red);font-size:10px;font-weight:700;padding:3px 10px;border-radius:4px;letter-spacing:1px}
.hdr-right{display:flex;align-items:center;gap:14px}
.timer-wrap{display:flex;align-items:center;gap:8px;
  background:var(--card2);border:1px solid var(--border2);border-radius:8px;padding:6px 12px}
.timer-label{font-size:9px;color:var(--muted);letter-spacing:1px}
.timer-val{font-family:'DM Mono',monospace;font-size:16px;font-weight:700;color:var(--gold);min-width:52px}

/* â”€ Layout â”€ */
.layout{display:grid;grid-template-columns:320px 1fr;gap:0;height:calc(100vh - 54px)}

/* â”€ Left sidebar: applicant list â”€ */
.sidebar{background:var(--card2);border-right:1px solid var(--border);overflow-y:auto;padding:16px 0}
.sidebar-hd{padding:0 16px 10px;font-size:9px;color:var(--muted);letter-spacing:2px;
  text-transform:uppercase;border-bottom:1px solid var(--border);margin-bottom:8px}
.sidebar-filter{display:flex;gap:4px;padding:8px 12px}
.sf-btn{flex:1;padding:5px 0;font-size:10px;font-weight:700;border-radius:6px;
  border:1px solid var(--border2);background:transparent;color:var(--muted);cursor:pointer;
  font-family:'Noto Sans JP',sans-serif;transition:all .15s;text-align:center}
.sf-btn.on{background:rgba(79,156,249,.12);border-color:rgba(79,156,249,.35);color:var(--blue)}

.app-card{padding:12px 16px;cursor:pointer;border-bottom:1px solid rgba(30,34,53,.6);
  transition:background .15s;position:relative}
.app-card:hover{background:rgba(255,255,255,.025)}
.app-card.active{background:rgba(79,156,249,.06);border-left:2px solid var(--blue)}
.app-card.active{padding-left:14px}
.ac-name{font-size:13px;font-weight:700;margin-bottom:3px}
.ac-meta{display:flex;align-items:center;gap:6px;flex-wrap:wrap}
.ac-type{font-size:9px;font-weight:700;padding:1px 6px;border-radius:3px}
.t-re{background:rgba(79,156,249,.15);color:var(--blue)}
.t-hr{background:rgba(20,184,166,.15);color:#2dd4bf}
.t-pt{background:rgba(52,211,153,.15);color:var(--green)}
.ac-time{font-size:10px;color:var(--muted)}
.ac-status{position:absolute;top:12px;right:12px;width:8px;height:8px;border-radius:50%}
.s-pending{background:var(--orange)}
.s-pass{background:var(--green)}
.s-fail{background:var(--red)}
.s-hold{background:var(--purple)}

/* â”€ Main area â”€ */
.main{overflow-y:auto;display:flex;flex-direction:column}

/* â”€ Applicant header â”€ */
.app-hdr{padding:20px 28px 0;position:sticky;top:0;background:var(--bg);z-index:100;
  border-bottom:1px solid var(--border)}
.app-hdr-inner{display:flex;align-items:flex-start;justify-content:space-between;gap:20px;padding-bottom:16px}
.app-name-area{display:flex;align-items:center;gap:14px}
.app-avatar{width:52px;height:52px;border-radius:50%;display:flex;align-items:center;
  justify-content:center;font-size:22px;flex-shrink:0;border:2px solid var(--border2)}
.app-name{font-size:20px;font-weight:700;margin-bottom:4px}
.app-meta-row{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.type-pill{font-size:10px;font-weight:700;padding:3px 10px;border-radius:5px}
.app-id{font-family:'DM Mono',monospace;font-size:11px;color:var(--muted)}
.app-applied{font-size:10px;color:var(--muted)}

/* Progress ring */
.progress-area{display:flex;flex-direction:column;align-items:center;gap:6px;flex-shrink:0}
.ring-wrap{position:relative;width:72px;height:72px}
.ring-wrap svg{transform:rotate(-90deg)}
.ring-bg{fill:none;stroke:var(--border2);stroke-width:5}
.ring-fill{fill:none;stroke-width:5;stroke-linecap:round;transition:stroke-dashoffset .4s}
.ring-label{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.ring-pct{font-family:'DM Mono',monospace;font-size:14px;font-weight:700}
.ring-sub{font-size:8px;color:var(--muted);letter-spacing:.5px}
.progress-text{font-size:10px;color:var(--sub);text-align:center}

/* â”€ Info grid â”€ */
.info-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:0;
  border-top:1px solid var(--border);padding:0}
.info-cell{padding:10px 16px;border-right:1px solid var(--border)}
.info-cell:last-child{border-right:none}
.ic-label{font-size:9px;color:var(--muted);letter-spacing:1px;margin-bottom:3px}
.ic-val{font-size:12px;font-weight:600}

/* â”€ Checklist body â”€ */
.checklist-body{padding:20px 28px;flex:1}
.section{background:var(--card);border:1px solid var(--border);border-radius:12px;
  margin-bottom:14px;overflow:hidden}
.sec-hdr{display:flex;align-items:center;justify-content:space-between;
  padding:13px 18px;cursor:pointer;user-select:none;transition:background .15s}
.sec-hdr:hover{background:rgba(255,255,255,.02)}
.sec-title{display:flex;align-items:center;gap:10px;font-size:12px;font-weight:700}
.sec-icon{font-size:16px;width:28px;text-align:center}
.sec-time{font-size:9px;color:var(--muted);margin-left:4px;font-weight:400}
.sec-meta{display:flex;align-items:center;gap:10px}
.sec-progress{font-size:10px;font-family:'DM Mono',monospace;color:var(--sub)}
.sec-chevron{color:var(--muted);font-size:12px;transition:transform .2s}
.sec-chevron.open{transform:rotate(90deg)}
.sec-body{border-top:1px solid var(--border);padding:0}
.sec-body.collapsed{display:none}

/* â”€ Check items â”€ */
.chk-item{display:grid;grid-template-columns:24px 1fr auto;gap:12px;align-items:start;
  padding:13px 18px;border-bottom:1px solid rgba(30,34,53,.5);transition:background .1s}
.chk-item:last-child{border-bottom:none}
.chk-item.ng-row{background:rgba(248,113,113,.04)}
.chk-item.ok-row{background:rgba(52,211,153,.02)}
.chk-num{font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);padding-top:2px}
.chk-content{flex:1}
.chk-label{font-size:12px;font-weight:600;margin-bottom:3px;line-height:1.5}
.chk-desc{font-size:10px;color:var(--sub);line-height:1.7}
.chk-desc a{color:var(--blue);text-decoration:none}
.chk-desc a:hover{text-decoration:underline}
.chk-alert{font-size:10px;color:var(--red);margin-top:4px;display:none}
.chk-alert.show{display:block}

/* â”€ Status buttons â”€ */
.status-btns{display:flex;gap:4px;flex-shrink:0;margin-top:1px}
.sb{width:32px;height:28px;border-radius:6px;border:1px solid var(--border2);
  background:transparent;cursor:pointer;font-size:13px;display:flex;align-items:center;
  justify-content:center;transition:all .15s;position:relative}
.sb:hover{border-color:var(--border);background:rgba(255,255,255,.03)}
.sb.ok-active{background:rgba(52,211,153,.15);border-color:rgba(52,211,153,.4);color:var(--green)}
.sb.ng-active{background:rgba(248,113,113,.15);border-color:rgba(248,113,113,.4);color:var(--red)}
.sb.skip-active{background:rgba(74,82,112,.2);border-color:var(--border2);color:var(--muted)}
.sb[title]:hover::after{content:attr(title);position:absolute;bottom:calc(100% + 6px);left:50%;
  transform:translateX(-50%);background:#1a1e2c;border:1px solid var(--border2);
  color:var(--sub);font-size:9px;padding:3px 7px;border-radius:4px;white-space:nowrap;
  font-family:'Noto Sans JP',sans-serif;pointer-events:none}

/* â”€ Memo per item â”€ */
.item-memo{margin-top:6px;display:none}
.item-memo.show{display:block}
.item-memo input{width:100%;background:#090b13;border:1px solid var(--border2);border-radius:6px;
  padding:6px 10px;color:var(--sub);font-size:11px;font-family:'Noto Sans JP',sans-serif}
.item-memo input:focus{outline:none;border-color:var(--blue)}

/* â”€ Instant fail banner â”€ */
.instant-fail{background:rgba(248,113,113,.08);border:1px solid rgba(248,113,113,.3);
  border-radius:8px;padding:10px 14px;margin:10px 18px;font-size:11px;color:var(--red);
  display:none;align-items:center;gap:8px}
.instant-fail.show{display:flex}

/* â”€ Verdict panel â”€ */
.verdict-panel{position:sticky;bottom:0;background:rgba(7,9,15,.95);backdrop-filter:blur(12px);
  border-top:1px solid var(--border);padding:16px 28px}
.verdict-inner{display:flex;align-items:center;gap:16px}
.verdict-label{font-size:10px;color:var(--muted);letter-spacing:1px;text-transform:uppercase;
  flex-shrink:0}
.verdict-btns{display:flex;gap:8px}
.vb{padding:9px 20px;border-radius:9px;font-size:12px;font-weight:700;cursor:pointer;
  border:none;font-family:'Noto Sans JP',sans-serif;transition:all .2s;letter-spacing:.5px}
.vb-pass{background:linear-gradient(135deg,var(--green),#22a876);color:#0a0c10}
.vb-pass:hover{filter:brightness(1.1);transform:translateY(-1px)}
.vb-fail{background:rgba(248,113,113,.15);color:var(--red);border:1px solid rgba(248,113,113,.3)}
.vb-fail:hover{background:rgba(248,113,113,.25)}
.vb-hold{background:rgba(167,139,250,.12);color:var(--purple);border:1px solid rgba(167,139,250,.3)}
.vb-hold:hover{background:rgba(167,139,250,.22)}
.verdict-note{flex:1}
.verdict-note input{width:100%;background:#0a0c14;border:1px solid var(--border2);border-radius:8px;
  padding:9px 14px;color:var(--text);font-size:12px;font-family:'Noto Sans JP',sans-serif}
.verdict-note input:focus{outline:none;border-color:var(--gold)}
.verdict-actions{display:flex;gap:8px;flex-shrink:0}
.va-btn{padding:8px 14px;border-radius:8px;font-size:11px;font-weight:700;cursor:pointer;
  border:1px solid var(--border2);background:transparent;color:var(--sub);
  font-family:'Noto Sans JP',sans-serif;transition:all .15s;white-space:nowrap}
.va-btn:hover{color:var(--text);border-color:var(--sub)}
.va-btn.primary{background:rgba(201,168,76,.12);border-color:var(--gold-dim);color:var(--gold)}
.va-btn.primary:hover{background:rgba(201,168,76,.2)}

/* â”€ Modal: applicant details â”€ */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.7);backdrop-filter:blur(4px);
  z-index:300;display:none;align-items:center;justify-content:center}
.modal-overlay.show{display:flex}
.modal{background:var(--card);border:1px solid var(--border);border-radius:16px;
  width:560px;max-height:80vh;overflow-y:auto;padding:24px}
.modal-hd{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
.modal-title{font-family:'Syne',sans-serif;font-size:14px;font-weight:700;color:var(--gold)}
.modal-close{font-size:18px;color:var(--muted);cursor:pointer;background:none;border:none;
  color:var(--sub);padding:4px 8px;border-radius:4px}
.modal-close:hover{color:var(--text);background:var(--card2)}
.detail-sec{margin-bottom:16px}
.detail-sec-title{font-size:9px;color:var(--muted);letter-spacing:2px;
  text-transform:uppercase;margin-bottom:8px;padding-bottom:5px;border-bottom:1px solid var(--border)}
.detail-row{display:flex;justify-content:space-between;padding:5px 0;font-size:12px;
  border-bottom:1px solid rgba(30,34,53,.4)}
.detail-row:last-child{border:none}
.dr-key{color:var(--muted)}
.dr-val{font-weight:600;text-align:right;max-width:300px}
.motivation-box{background:var(--card2);border-radius:8px;padding:12px;font-size:12px;
  line-height:1.8;color:var(--sub);border-left:2px solid var(--blue)}
.char-count{font-size:10px;color:var(--muted);margin-top:6px;text-align:right}
.referral-badge{display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:5px;
  background:rgba(201,168,76,.12);border:1px solid var(--gold-dim);color:var(--gold);
  font-size:10px;font-weight:700}

/* â”€ Verdict result banner â”€ */
.result-banner{padding:12px 28px;font-size:12px;font-weight:700;display:none;
  align-items:center;gap:10px;letter-spacing:.5px}
.result-banner.show{display:flex}
.rb-pass{background:rgba(52,211,153,.08);border-bottom:1px solid rgba(52,211,153,.2);color:var(--green)}
.rb-fail{background:rgba(248,113,113,.08);border-bottom:1px solid rgba(248,113,113,.2);color:var(--red)}
.rb-hold{background:rgba(167,139,250,.08);border-bottom:1px solid rgba(167,139,250,.2);color:var(--purple)}

/* â”€ Empty state â”€ */
.empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;
  height:100%;color:var(--muted);gap:12px}
.empty-icon{font-size:48px;opacity:.4}
.empty-text{font-size:13px}

/* â”€ Scroll â”€ */
::-webkit-scrollbar{width:4px}
::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px}

/* â”€ Tag â”€ */
.tag{display:inline-block;font-size:9px;padding:1px 6px;border-radius:3px;font-weight:700}
.tag-ng{background:rgba(248,113,113,.15);color:var(--red)}
.tag-ok{background:rgba(52,211,153,.12);color:var(--green)}
.tag-warn{background:rgba(251,146,60,.15);color:var(--orange)}
.tag-info{background:rgba(79,156,249,.12);color:var(--blue)}
</style>
</head>
<body>

<!-- â”€ Header â”€ -->
<div class="header">
  <div style="display:flex;align-items:center;gap:12px">
    <div class="logo">CORETO</div>
    <div style="width:1px;height:18px;background:var(--border2)"></div>
    <div style="font-size:10px;color:var(--muted);letter-spacing:1px">æ›¸é¡å¯©æŸ»ãƒã‚§ãƒƒã‚¯ã‚·ãƒ¼ãƒˆ</div>
    <div class="hdr-badge">HQ ONLY</div>
  </div>
  <div class="hdr-right">
    <button onclick="window.open('coreto-apply.html','_blank')" style="padding:6px 14px;border:1px solid var(--border2);border-radius:7px;background:var(--card2);color:var(--sub);font-size:11px;cursor:pointer;margin-right:8px">ğŸ“‹ å¿œå‹Ÿãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡¨ç¤º</button>
    <div class="timer-wrap">
      <div>
        <div class="timer-label">å¯©æŸ»çµŒéæ™‚é–“</div>
        <div class="timer-val" id="timer-display">00:00</div>
      </div>
    </div>
    <button onclick="window.location.href='coreto-hub.html'"
            style="font-size:10px;padding:5px 12px;border-radius:6px;border:1px solid var(--border2);
            background:transparent;color:var(--muted);cursor:pointer;font-family:'Noto Sans JP',sans-serif">
      â† ç®¡ç†ãƒãƒ¼ã‚¿ãƒ«
    </button>
  </div>
</div>

<!-- â”€ Layout â”€ -->
<div class="layout">

<!-- â”€ Left: Applicant list â”€ -->
<div class="sidebar">
  <div class="sidebar-hd">å¯©æŸ»å¾…ã¡ä¸€è¦§ <span id="pending-count" style="color:var(--orange)">â€” ä»¶</span></div>
  <div class="sidebar-filter">
    <div class="sf-btn on" data-f="all" onclick="filterApps('all',this)">å…¨ã¦</div>
    <div class="sf-btn" data-f="re" onclick="filterApps('re',this)">ä¸å‹•ç”£</div>
    <div class="sf-btn" data-f="hr" onclick="filterApps('hr',this)">äººæ</div>
    <div class="sf-btn" data-f="pt" onclick="filterApps('pt',this)">Partner</div>
  </div>
  <div id="app-list"></div>
</div>

<!-- â”€ Right: Main â”€ -->
<div class="main" id="main-area">
  <div class="empty-state" id="empty-state">
    <div class="empty-icon">ğŸ“‹</div>
    <div class="empty-text">å·¦ã‹ã‚‰ç”³è«‹è€…ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
  </div>

  <!-- Applicant header (hidden until selected) -->
  <div id="app-hdr-wrap" style="display:none">
    <div class="app-hdr">
      <div class="app-hdr-inner">
        <div class="app-name-area">
          <div class="app-avatar" id="app-avatar">ğŸ‘¤</div>
          <div>
            <div class="app-name" id="app-name">â€”</div>
            <div class="app-meta-row">
              <div class="type-pill" id="app-type-pill"></div>
              <div class="app-id" id="app-sub-id"></div>
              <div class="app-applied" id="app-applied"></div>
            </div>
          </div>
        </div>
        <div style="display:flex;gap:10px;align-items:center">
          <div class="progress-area">
            <div class="ring-wrap">
              <svg width="72" height="72" viewBox="0 0 72 72">
                <circle class="ring-bg" cx="36" cy="36" r="31"/>
                <circle class="ring-fill" id="ring-fill" cx="36" cy="36" r="31"
                        stroke-dasharray="194.8" stroke-dashoffset="194.8"/>
              </svg>
              <div class="ring-label">
                <div class="ring-pct" id="ring-pct">0%</div>
                <div class="ring-sub">å®Œäº†</div>
              </div>
            </div>
            <div class="progress-text" id="progress-text">0 / 0 é …ç›®</div>
          </div>
          <button class="va-btn" onclick="showDetailModal()" style="align-self:flex-start;margin-top:4px">
            ğŸ“„ ç”³è«‹è©³ç´°
          </button>
        </div>
      </div>
      <div class="info-grid" id="info-grid"></div>
    </div>

    <!-- Result banner -->
    <div class="result-banner" id="result-banner"></div>

    <!-- Instant fail banner -->
    <div class="instant-fail" id="instant-fail-banner">
      <span style="font-size:18px">ğŸš«</span>
      <div>
        <div style="font-weight:700;margin-bottom:2px" id="ifb-title">å³æ™‚ä¸åˆæ ¼</div>
        <div id="ifb-reason" style="font-size:10px;opacity:.8"></div>
      </div>
    </div>

    <!-- Checklist -->
    <div class="checklist-body" id="checklist-body"></div>

    <!-- Verdict panel -->
    <div class="verdict-panel">
      <div class="verdict-inner">
        <div class="verdict-label">å¯©æŸ»çµæœ</div>
        <div class="verdict-btns">
          <button class="vb vb-pass" onclick="setVerdict('pass')">âœ… åˆæ ¼ã€€â†’é¢æ¥ã¸</button>
          <button class="vb vb-fail" onclick="setVerdict('fail')">âŒ ä¸åˆæ ¼</button>
          <button class="vb vb-hold" onclick="setVerdict('hold')">â¸ ä¿ç•™</button>
        </div>
        <div class="verdict-note">
          <input type="text" id="verdict-note" placeholder="æ‰€è¦‹ãƒ»åˆ¤å®šç†ç”±ã‚’å…¥åŠ›ï¼ˆä»»æ„ï¼‰">
        </div>
        <div class="verdict-actions">
          <button class="va-btn primary" onclick="saveToKintone()">ğŸ’¾ Kintoneã«ä¿å­˜</button>
          <button class="va-btn" onclick="sendCalendly()" id="btn-calendly" style="display:none">
            ğŸ“… Calendlyãƒªãƒ³ã‚¯ç™ºè¡Œ
          </button>
          <button class="va-btn" onclick="sendRejection()" id="btn-reject" style="display:none">
            âœ‰ ä¸åˆæ ¼é€šçŸ¥ãƒ¡ãƒ¼ãƒ«
          </button>
        </div>
      </div>
    </div>
  </div>
</div><!-- /main -->
</div><!-- /layout -->

<!-- â”€ Detail modal â”€ -->
<div class="modal-overlay" id="modal-overlay" onclick="if(event.target===this)closeModal()">
<div class="modal">
  <div class="modal-hd">
    <div class="modal-title">ç”³è«‹è©³ç´°</div>
    <button class="modal-close" onclick="closeModal()">âœ•</button>
  </div>
  <div id="modal-body"></div>
</div>
</div>

<script>
// â”€â”€ XSSå¯¾ç­–: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›å€¤ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function escHtml(s) {
  if (s == null) return '';
  return String(s)
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#39;');
}

// â•â• AUTH GUARD (HQå°‚ç”¨ãƒšãƒ¼ã‚¸) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function() {
  var s = null;
  try { s = JSON.parse(sessionStorage.getItem('coreto_session') || 'null'); } catch(e) {}
  if (!s || !s.userId || !s.sessionToken || s.sessionToken.length !== 64) { sessionStorage.removeItem('coreto_session'); location.replace('coreto-login.html'); return; }
  var _la = new Date(s.loginAt).getTime();
  if (isNaN(_la) || (Date.now() - _la) > 28800000) { sessionStorage.removeItem('coreto_session'); alert('ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã¾ã—ãŸã€‚'); location.replace('coreto-login.html'); return; }
  if (s.type !== 'hq') { location.replace('coreto-hub.html'); return; }
  window._SESSION = s;
})();

// ================================================================
//  ç”³è«‹è€…ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿
// ================================================================
const APPLICANTS = [
  {
    id:'APP-20260218-001', name:'ç”°ä¸­ é›„ä»‹', kana:'ã‚¿ãƒŠã‚« ãƒ¦ã‚¦ã‚¹ã‚±',
    type:'re', applied:'2026-02-18 10:23', status:'pending',
    age:34, addr:'æ±äº¬éƒ½æ¸‹è°·åŒº', email:'tanaka.y@example.com', tel:'090-1234-5678',
    takken:true, takkenNo:'æ±äº¬(2)098765', takkenExp:'2028-01-15',
    experience:'3å¹´ä»¥ä¸Š', expDetail:'è³ƒè²¸ãƒ»å£²è²·ã‚’æ‹…å½“ã€‚æœˆå¹³å‡3ä»¶æˆç´„ã€‚',
    area:'æ¸‹è°·ãƒ»æ¸¯åŒºãƒ»æ–°å®¿', propType:'ãƒãƒ³ã‚·ãƒ§ãƒ³ãƒ»æˆ¸å»ºã¦',
    motivation:'ç‹¬ç«‹ã—ã¦è‡ªç”±ã«åƒããªãŒã‚‰ã€ã‚ˆã‚Šå¤šãã®é¡§å®¢ã«è²¢çŒ®ã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚COREMATOã®ã‚·ã‚¹ãƒ†ãƒ ã§åŠ¹ç‡ã‚ˆãæ¡ˆä»¶ã‚’é€²ã‚ãŸã„ã¨æ€ã„å¿œå‹Ÿã—ã¾ã—ãŸã€‚ã“ã‚Œã¾ã§ã®çµŒé¨“ã‚’æ´»ã‹ã—ã¦å³æˆ¦åŠ›ã«ãªã‚Œã‚‹ã¨ç¢ºä¿¡ã—ã¦ã„ã¾ã™ã€‚',
    referralCode:'PT-GOLD-001', referralName:'å±±ç”°ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼', referralRank:'Gold',
    contractType:'individual',
  },
  {
    id:'APP-20260218-002', name:'ä½è—¤ éº»è¡£', kana:'ã‚µãƒˆã‚¦ ãƒã‚¤',
    type:'hr', applied:'2026-02-18 11:45', status:'pending',
    age:29, addr:'ç¥å¥ˆå·çœŒæ¨ªæµœå¸‚', email:'sato.m@example.com', tel:'080-9876-5432',
    experience:'3å¹´ä»¥ä¸Š', expDetail:'CA/RAä¸¡é¢å‹ã€‚ITãƒ»è£½é€ æ¥­ç•Œã«å¼·ã¿ã€‚å¹´é–“è»¢è·æ”¯æ´50åè¶…ã€‚',
    jobTypes:['CAï¼ˆã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒ‰ãƒã‚¤ã‚¶ãƒ¼ï¼‰','RAï¼ˆãƒªã‚¯ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¢ãƒ‰ãƒã‚¤ã‚¶ãƒ¼ï¼‰','ä¸¡é¢å‹'],
    industry:'ITãƒ»è£½é€ ãƒ»é‡‘è', occupation:'ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒ»å–¶æ¥­è·',
    motivation:'ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã¨ã—ã¦äººæç´¹ä»‹æ¥­ã‚’ç¶šã‘ã¦ãã¾ã—ãŸã€‚COREMATOã®ä»•çµ„ã¿ã‚’æ´»ç”¨ã—ã¦ã‚ˆã‚Šå¤šãã®è»¢è·æˆåŠŸè€…ã‚’è¼©å‡ºã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚CAãƒ»RAä¸¡æ–¹ã®çµŒé¨“ãŒã‚ã‚Šã€å³æ—¥ã‹ã‚‰æ¡ˆä»¶å¯¾å¿œã§ãã¾ã™ã€‚',
    referralCode:'', referralName:'', referralRank:'',
    contractType:'individual',
  },
  {
    id:'APP-20260218-003', name:'éˆ´æœ¨ å•†äº‹', kana:'ã‚¹ã‚ºã‚­ ã‚·ãƒ§ã‚¦ã‚¸',
    type:'pt', applied:'2026-02-18 13:10', status:'pending',
    age:52, addr:'æ±äº¬éƒ½åƒä»£ç”°åŒº', email:'info@suzuki-sh.example.com', tel:'03-1234-5678',
    contractType:'corporate', corpName:'éˆ´æœ¨å•†äº‹æ ªå¼ä¼šç¤¾', corpNo:'1234567890123', repName:'éˆ´æœ¨ ä¸€éƒ',
    motivation:'å¼Šç¤¾ã®é¡§å®¢ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ´»ç”¨ã—ã¦ä¸å‹•ç”£ãƒ»äººæã®ç´¹ä»‹äº‹æ¥­ã‚’å±•é–‹ã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚é–¢æ±åœã‚’ä¸­å¿ƒã«300ç¤¾ä»¥ä¸Šã®å–å¼•å…ˆã‚’æŒã¡ã€å„ªè‰¯ãªç´¹ä»‹ãƒ«ãƒ¼ãƒˆã‚’æä¾›ã§ãã¾ã™ã€‚ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã€‚',
    referralCode:'', referralName:'', referralRank:'',
  },
  {
    id:'APP-20260217-004', name:'æ¸¡è¾º æ‹“ä¹Ÿ', kana:'ãƒ¯ã‚¿ãƒŠãƒ™ ã‚¿ã‚¯ãƒ¤',
    type:'re', applied:'2026-02-17 09:00', status:'pending',
    age:22, addr:'åŸ¼ç‰çœŒã•ã„ãŸã¾å¸‚', email:'watanabe.t@example.com', tel:'090-1111-2222',
    takken:false, takkenNo:'', takkenExp:'',
    experience:'æœªçµŒé¨“', expDetail:'',
    area:'åŸ¼ç‰çœŒ', propType:'',
    motivation:'ä¸å‹•ç”£ã«èˆˆå‘³ãŒã‚ã‚Šã¾ã™ã€‚',
    referralCode:'', referralName:'', referralRank:'',
    contractType:'individual',
  },
  {
    id:'APP-20260217-005', name:'é«˜æ©‹ æµå­', kana:'ã‚¿ã‚«ãƒã‚· ã‚±ã‚¤ã‚³',
    type:'hr', applied:'2026-02-17 14:30', status:'pass',
    age:38, addr:'å¤§é˜ªåºœå¤§é˜ªå¸‚', email:'takahashi.k@example.com', tel:'06-1234-5678',
    experience:'3å¹´ä»¥ä¸Š', expDetail:'CAå°‚ä»»ã€‚åŒ»ç™‚ãƒ»ä»‹è­·åˆ†é‡ã«ç‰¹åŒ–ã€‚',
    jobTypes:['CAï¼ˆã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒ‰ãƒã‚¤ã‚¶ãƒ¼ï¼‰'],
    industry:'åŒ»ç™‚ãƒ»ä»‹è­·', occupation:'çœ‹è­·å¸«ãƒ»ä»‹è­·å£«',
    motivation:'åŒ»ç™‚ãƒ»ä»‹è­·åˆ†é‡ã®è»¢è·æ”¯æ´ã«10å¹´ä»¥ä¸Šå¾“äº‹ã—ã¦ãã¾ã—ãŸã€‚COREMATOã®ä»•çµ„ã¿ã‚’ä½¿ã£ã¦ã€ã‚ˆã‚Šå¤šãã®æ–¹ã«è»¢è·ã‚’ã‚µãƒãƒ¼ãƒˆã—ãŸã„ã§ã™ã€‚',
    referralCode:'SPECIAL-001', referralName:'æœ¬éƒ¨æ¨è–¦', referralRank:'Platinum',
    contractType:'individual',
  },
];

// ================================================================
//  ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆå®šç¾©
// ================================================================
const CHECKLISTS = {
  re: {
    estTime: '15ã€œ30åˆ†',
    sections: [
      {
        id:'basic', icon:'ğŸ‘¤', title:'åŸºæœ¬æƒ…å ±ç¢ºèª', time:'ç´„2åˆ†',
        items:[
          { id:'name',    label:'æ°åãƒ»ãƒ•ãƒªã‚¬ãƒŠã®ä¸€è‡´ç¢ºèª',     desc:'ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ ã®æ°åã¨ãƒ•ãƒªã‚¬ãƒŠãŒæ­£ç¢ºã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã‹' },
          { id:'age',     label:'å¹´é½¢ç¢ºèªï¼ˆ18æ­³ä»¥ä¸Šï¼‰',         desc:'ç”Ÿå¹´æœˆæ—¥ã‹ã‚‰è¨ˆç®—ã—18æ­³ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª',
            autoCheck: app => app.age < 18 ? 'ng' : null,
            ngAlert: '18æ­³æœªæº€ã®ãŸã‚å³æ™‚ä¸åˆæ ¼' },
          { id:'addr',    label:'ä½æ‰€ãƒ»é€£çµ¡å…ˆã®æœ‰åŠ¹æ€§ç¢ºèª',     desc:'éƒµä¾¿ç•ªå·ãƒ»ä½æ‰€ãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ»é›»è©±ãŒæœ‰åŠ¹ãªå½¢å¼ã‹' },
          { id:'indiv',   label:'å€‹äººäº‹æ¥­ä¸»ç¢ºèªï¼ˆæ³•äººä¸å¯ï¼‰',   desc:'ä¸å‹•ç”£ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯å®…å»ºæ¥­æ³•ã«ã‚ˆã‚Šå€‹äººå¥‘ç´„ã®ã¿ã€‚æ³•äººå¸Œæœ›ã®å ´åˆã¯å³ä¸åˆæ ¼',
            ngTag:'å³ä¸åˆæ ¼', ngAlert:'æ³•äººå¥‘ç´„å¸Œæœ›ã®å ´åˆã¯å³æ™‚ä¸åˆæ ¼' },
        ]
      },
      {
        id:'antisocial', icon:'ğŸ”', title:'åç¤¾ãƒã‚§ãƒƒã‚¯', time:'ç´„2åˆ†',
        items:[
          { id:'google',  label:'Googleæ¤œç´¢ãƒã‚§ãƒƒã‚¯',           desc:'æ°åãƒ»ä½æ‰€ã§æ¤œç´¢ã—åç¤¾ãƒ»è©æ¬ºãƒ»çŠ¯ç½ªæ­´ç­‰ã®æƒ…å ±ãŒãªã„ã‹ç¢ºèª' },
          { id:'kintone', label:'Kintoneå†…éƒ¨DBç…§åˆ',            desc:'éå»ã®é™¤åãƒ»ãƒˆãƒ©ãƒ–ãƒ«äº‹ä¾‹ã¨ç…§åˆ',
            ngTag:'å³ä¸åˆæ ¼', ngAlert:'éå»é™¤åè¨˜éŒ²ãŒã‚ã‚‹å ´åˆã¯å³æ™‚ä¸åˆæ ¼' },
        ]
      },
      {
        id:'takken', icon:'ğŸ“œ', title:'å®…å»ºå£«è³‡æ ¼ç¢ºèª', time:'ç´„5åˆ†',
        items:[
          { id:'tk-held',  label:'è³‡æ ¼ä¿æœ‰æœ‰ç„¡ã®ç¢ºèª',          desc:'ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ ã®å›ç­”ã‚’ç¢ºèªï¼ˆä¿æœ‰ã—ã¦ã„ãªã„å ´åˆã¯ä»¥ä¸‹ã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼‰' },
          { id:'tk-fmt',   label:'ç™»éŒ²ç•ªå·ã®å½¢å¼ãƒã‚§ãƒƒã‚¯',      desc:'å½¢å¼ï¼šéƒ½é“åºœçœŒåï¼ˆæ•°å­—ï¼‰ç™»éŒ²ç•ªå·ã€€ä¾‹ï¼šæ±äº¬(2)098765',
            hint:'ä¿æœ‰è€…ã®ã¿' },
          { id:'tk-exp',   label:'æœ‰åŠ¹æœŸé™å†…ã‹ç¢ºèª',            desc:'å®…å»ºå£«è¨¼ã®æœ‰åŠ¹æœŸé™ãŒç¾åœ¨æ—¥ä»˜ã‚ˆã‚Šå¾Œã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª',
            hint:'ä¿æœ‰è€…ã®ã¿' },
          { id:'tk-img',   label:'å®…å»ºå£«è¨¼ç”»åƒã®çœŸæ­£æ€§ç¢ºèª',    desc:'ãƒ»æ°åã¨ç•ªå·ãŒç”³è«‹ã¨ä¸€è‡´ã€€ãƒ»ç”»åƒãŒé®®æ˜ã€€ãƒ»å½é€ ã®ç–‘ã„ãªã—',
            hint:'ä¿æœ‰è€…ã®ã¿' },
          { id:'tk-db',    label:'å›½äº¤çœDBã¨ã®ç…§åˆ',
            desc:'<a href="https://www.retio.or.jp/" target="_blank">ğŸ”— retio.or.jpï¼ˆå›½äº¤çœDBï¼‰</a>ã€€ã§ç™»éŒ²ç•ªå·ã‚’ç…§åˆã—ã€æ°åãƒ»æœ‰åŠ¹æœŸé™ãŒä¸€è‡´ã™ã‚‹ã‹ç¢ºèª',
            hint:'ä¿æœ‰è€…ã®ã¿', ngTag:'å³ä¸åˆæ ¼' },
        ]
      },
      {
        id:'career', icon:'ğŸ’¼', title:'è·æ­´ãƒ»çµŒé¨“ç¢ºèª', time:'ç´„5åˆ†',
        items:[
          { id:'exp-yr',  label:'æ¥­ç•ŒçµŒé¨“å¹´æ•°ã®è©•ä¾¡',
            desc:'3å¹´ä»¥ä¸Šï¼šå„ªé‡ã€€ï¼ã€€1ã€œ3å¹´ï¼šå•é¡Œãªã—ã€€ï¼ã€€1å¹´æœªæº€ï¼šé¢æ¥ã§åˆ¤æ–­ã€€ï¼ã€€æœªçµŒé¨“ï¼šé¢æ¥ã§åˆ¤æ–­' },
          { id:'exp-det', label:'å®Ÿç¸¾ãƒ»è·æ­´ã®å…·ä½“æ€§ç¢ºèª',       desc:'æœˆå¹³å‡æˆç´„ä»¶æ•°ãƒ»æ‹…å½“ã‚¨ãƒªã‚¢ãƒ»å¾—æ„ç‰©ä»¶ã‚¿ã‚¤ãƒ—ãŒå…·ä½“çš„ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã‹' },
          { id:'area',    label:'å¾—æ„ã‚¨ãƒªã‚¢ãƒ»ç‰©ä»¶ã‚¿ã‚¤ãƒ—ã®ç¢ºèª', desc:'æ´»å‹•å¯èƒ½ãªåœ°åŸŸãƒ»å°‚é–€åˆ†é‡ãŒæ˜è¨˜ã•ã‚Œã¦ã„ã‚‹ã‹ï¼ˆä»»æ„é …ç›®ã ãŒè¨˜è¼‰ãŒã‚ã‚‹ã¨å„ªé‡ï¼‰' },
        ]
      },
      {
        id:'motivation', icon:'ğŸ“', title:'å¿—æœ›å‹•æ©Ÿç¢ºèª', time:'ç´„3åˆ†',
        items:[
          { id:'mot-len',  label:'å¿—æœ›å‹•æ©Ÿ 100æ–‡å­—ä»¥ä¸Š',
            desc:'100æ–‡å­—ä»¥ä¸Šã§è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª',
            autoCheck: app => app.motivation && app.motivation.length >= 100 ? 'ok' : 'ng',
            ngAlert: '100æ–‡å­—æœªæº€ã®ãŸã‚åŸå‰‡ä¸åˆæ ¼ï¼ˆé¢æ¥ã§è£œå®Œå¯èƒ½ã‹åˆ¤æ–­ï¼‰' },
          { id:'mot-qual', label:'å¿—æœ›å‹•æ©Ÿã®å…·ä½“æ€§ãƒ»èª å®Ÿã•',   desc:'å†·ã‚„ã‹ã—ãƒ»ã‚³ãƒ”ãƒšãƒ»éåº¦ã«çŸ­ã„å‹•æ©Ÿã§ãªã„ã‹ã€‚æ¥­ç•ŒçµŒé¨“ã‚„ç‹¬ç«‹å¿—å‘ãŒèª­ã¿å–ã‚Œã‚‹ã‹' },
        ]
      },
      {
        id:'referral', icon:'ğŸ”—', title:'ç´¹ä»‹è€…ç¢ºèª', time:'ç´„1åˆ†',
        items:[
          { id:'ref-chk', label:'ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ç¢ºèªãƒ»ç´¹ä»‹è€…ãƒ©ãƒ³ã‚¯ç¢ºèª', desc:'Goldãƒ©ãƒ³ã‚¯ä»¥ä¸Šã®ç´¹ä»‹è€…ãŒã„ã‚‹å ´åˆã¯å¯©æŸ»ã‚’å„ªé‡ã€‚ç‰¹åˆ¥ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ã®å ´åˆã¯æ¡ä»¶ç¢ºèª' },
        ]
      },
    ]
  },
  hr: {
    estTime: '15ã€œ30åˆ†',
    sections: [
      {
        id:'basic', icon:'ğŸ‘¤', title:'åŸºæœ¬æƒ…å ±ç¢ºèª', time:'ç´„2åˆ†',
        items:[
          { id:'name',   label:'æ°åãƒ»ãƒ•ãƒªã‚¬ãƒŠã®ä¸€è‡´ç¢ºèª',      desc:'ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ ã®æ°åã¨ãƒ•ãƒªã‚¬ãƒŠãŒæ­£ç¢ºã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã‹' },
          { id:'age',    label:'å¹´é½¢ç¢ºèªï¼ˆ18æ­³ä»¥ä¸Šï¼‰',          desc:'ç”Ÿå¹´æœˆæ—¥ã‹ã‚‰è¨ˆç®—ã—18æ­³ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª',
            autoCheck: app => app.age < 18 ? 'ng' : null,
            ngAlert:'18æ­³æœªæº€ã®ãŸã‚å³æ™‚ä¸åˆæ ¼' },
          { id:'addr',   label:'ä½æ‰€ãƒ»é€£çµ¡å…ˆã®æœ‰åŠ¹æ€§ç¢ºèª',      desc:'éƒµä¾¿ç•ªå·ãƒ»ä½æ‰€ãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ»é›»è©±ãŒæœ‰åŠ¹ãªå½¢å¼ã‹' },
          { id:'indiv',  label:'å€‹äººäº‹æ¥­ä¸»ç¢ºèªï¼ˆæ³•äººä¸å¯ï¼‰',    desc:'äººæã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯è·æ¥­å®‰å®šæ³•ã«ã‚ˆã‚Šå€‹äººå¥‘ç´„ã®ã¿',
            ngTag:'å³ä¸åˆæ ¼' },
        ]
      },
      {
        id:'antisocial', icon:'ğŸ”', title:'åç¤¾ãƒã‚§ãƒƒã‚¯', time:'ç´„2åˆ†',
        items:[
          { id:'google',  label:'Googleæ¤œç´¢ãƒã‚§ãƒƒã‚¯',           desc:'æ°åãƒ»ä½æ‰€ã§æ¤œç´¢ã—åç¤¾ãƒ»è©æ¬ºãƒ»çŠ¯ç½ªæ­´ç­‰ã®æƒ…å ±ãŒãªã„ã‹ç¢ºèª' },
          { id:'kintone', label:'Kintoneå†…éƒ¨DBç…§åˆ',            desc:'éå»ã®é™¤åãƒ»ãƒˆãƒ©ãƒ–ãƒ«äº‹ä¾‹ã¨ç…§åˆ',
            ngTag:'å³ä¸åˆæ ¼' },
        ]
      },
      {
        id:'hrexp', icon:'ğŸ¢', title:'äººææ¥­ç•ŒçµŒé¨“ç¢ºèª â˜…æœ€é‡è¦', time:'ç´„7åˆ†',
        items:[
          { id:'exp-yr',  label:'æ¥­ç•ŒçµŒé¨“å¹´æ•°ã®ç¢ºèª',
            desc:'<span class="tag tag-ng">1å¹´æœªæº€ï¼šå³ä¸åˆæ ¼</span>ã€€<span class="tag tag-ng">æœªçµŒé¨“ï¼šå³ä¸åˆæ ¼</span>ã€€1ã€œ3å¹´ï¼šOKã€€3å¹´ä»¥ä¸Šï¼šå„ªé‡',
            autoCheck: app => {
              if (app.experience === '1å¹´æœªæº€' || app.experience === 'æœªçµŒé¨“') return 'ng';
              if (app.experience === '3å¹´ä»¥ä¸Š') return 'ok';
              return null;
            },
            ngAlert:'äººææ¥­ç•ŒçµŒé¨“1å¹´æœªæº€ã¾ãŸã¯æœªçµŒé¨“ã®ãŸã‚å³æ™‚ä¸åˆæ ¼ï¼ˆå¿…é ˆè¦ä»¶ï¼‰',
            instantFail: true,
          },
          { id:'jobtype', label:'æ¥­å‹™å†…å®¹ã®ç¢ºèª',
            desc:'<span class="tag tag-ok">CA / RA / ä¸¡é¢å‹ï¼šåˆæ ¼</span>ã€€<span class="tag tag-warn">äººæå–¶æ¥­ã®ã¿ï¼šé¢æ¥ã§ç¢ºèª</span>ã€€<span class="tag tag-ng">äº‹å‹™ãƒ»å—ä»˜ã®ã¿ï¼šä¸åˆæ ¼</span>',
            autoCheck: app => {
              if (!app.jobTypes) return null;
              if (app.jobTypes.some(t => t.includes('äº‹å‹™'))) return 'ng';
              if (app.jobTypes.some(t => t.includes('CA') || t.includes('RA') || t.includes('ä¸¡é¢'))) return 'ok';
              return null;
            },
          },
          { id:'exp-det', label:'å®Ÿç¸¾ãƒ»è·æ­´ã®å…·ä½“æ€§ç¢ºèª',       desc:'æ‹…å½“æ¥­ç•Œãƒ»å¹´é–“æ”¯æ´ä»¶æ•°ãƒ»å¾—æ„è·ç¨®ãŒå…·ä½“çš„ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã‹' },
        ]
      },
      {
        id:'specialty', icon:'ğŸ¯', title:'å°‚é–€åˆ†é‡ç¢ºèª', time:'ç´„3åˆ†',
        items:[
          { id:'industry', label:'å¾—æ„æ¥­ç•Œãƒ»è·ç¨®ã®ç¢ºèª',        desc:'ç‰¹åŒ–åˆ†é‡ãŒæ˜ç¢ºã‹ã€‚ã‚«ãƒãƒ¬ãƒƒã‚¸ã®åºƒã•ã‚ˆã‚Šæ·±ã•ã‚’é‡è¦–' },
        ]
      },
      {
        id:'motivation', icon:'ğŸ“', title:'å¿—æœ›å‹•æ©Ÿç¢ºèª', time:'ç´„3åˆ†',
        items:[
          { id:'mot-len',  label:'å¿—æœ›å‹•æ©Ÿ 100æ–‡å­—ä»¥ä¸Š',
            autoCheck: app => app.motivation && app.motivation.length >= 100 ? 'ok' : 'ng',
            ngAlert: '100æ–‡å­—æœªæº€' },
          { id:'mot-qual', label:'å¿—æœ›å‹•æ©Ÿã®å…·ä½“æ€§ãƒ»èª å®Ÿã•',   desc:'ç‹¬ç«‹å¿—å‘ãƒ»å®Ÿç¸¾ã¸ã®è¨€åŠãƒ»ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹çµŒé¨“ã®æœ‰ç„¡ãªã©' },
        ]
      },
    ]
  },
  pt: {
    estTime: '5ã€œ10åˆ†',
    sections: [
      {
        id:'basic', icon:'ğŸ‘¤', title:'åŸºæœ¬æƒ…å ±ç¢ºèª', time:'ç´„2åˆ†',
        items:[
          { id:'name',   label:'æ°åï¼ˆã¾ãŸã¯æ³•äººåï¼‰ã®ç¢ºèª',    desc:'å€‹äººã®å ´åˆï¼šæ°åãƒ»ãƒ•ãƒªã‚¬ãƒŠã€€æ³•äººã®å ´åˆï¼šæ³•äººåãƒ»ä»£è¡¨è€…åã®ç¢ºèª' },
          { id:'age',    label:'å¹´é½¢ç¢ºèªï¼ˆ18æ­³ä»¥ä¸Šï¼‰',          desc:'å€‹äººã®å ´åˆã®ã¿ï¼ˆæ³•äººã¯ã‚¹ã‚­ãƒƒãƒ—å¯ï¼‰',
            autoCheck: app => (!app.corpName && app.age < 18) ? 'ng' : null,
            ngAlert:'18æ­³æœªæº€ã®ãŸã‚å³æ™‚ä¸åˆæ ¼' },
          { id:'addr',   label:'ä½æ‰€ãƒ»é€£çµ¡å…ˆã®æœ‰åŠ¹æ€§ç¢ºèª',      desc:'éƒµä¾¿ç•ªå·ãƒ»ä½æ‰€ãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ»é›»è©±ãŒæœ‰åŠ¹ãªå½¢å¼ã‹' },
        ]
      },
      {
        id:'antisocial', icon:'ğŸ”', title:'åç¤¾ãƒã‚§ãƒƒã‚¯', time:'ç´„2åˆ†',
        items:[
          { id:'google',  label:'Googleæ¤œç´¢ãƒã‚§ãƒƒã‚¯',           desc:'æ°åãƒ»æ³•äººåã§æ¤œç´¢ã—åç¤¾ãƒ»è©æ¬ºç­‰ã®æƒ…å ±ãŒãªã„ã‹ç¢ºèª' },
          { id:'kintone', label:'Kintoneå†…éƒ¨DBç…§åˆ',            desc:'éå»ã®é™¤åãƒ»ãƒˆãƒ©ãƒ–ãƒ«äº‹ä¾‹ã¨ç…§åˆ',
            ngTag:'å³ä¸åˆæ ¼' },
        ]
      },
      {
        id:'corp', icon:'ğŸ¢', title:'æ³•äººç¢ºèªï¼ˆæ³•äººã®å ´åˆã®ã¿ï¼‰', time:'ç´„3åˆ†',
        items:[
          { id:'corp-no',  label:'æ³•äººç•ªå·ã®ç¢ºèªï¼ˆå›½ç¨åºDBï¼‰',
            desc:'<a href="https://www.houjin-bangou.nta.go.jp/" target="_blank">ğŸ”— å›½ç¨åº æ³•äººç•ªå·å…¬è¡¨ã‚µã‚¤ãƒˆ</a>ã€€ã§æ³•äººç•ªå·ã‚’ç…§åˆ',
            hint:'æ³•äººãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®ã¿' },
          { id:'corp-rep', label:'ä»£è¡¨è€…ã®ç¢ºèª',               desc:'ç™»è¨˜æƒ…å ±ã¨ç”³è«‹ã®ä»£è¡¨è€…åãŒä¸€è‡´ã™ã‚‹ã‹',
            hint:'æ³•äººãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®ã¿' },
        ]
      },
      {
        id:'job', icon:'ğŸ’¼', title:'è·æ¥­ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¢ºèª', time:'ç´„1åˆ†',
        items:[
          { id:'occupation', label:'è·æ¥­ãƒ»ç«‹å ´ã®ç¢ºèª',          desc:'ã©ã®ã‚ˆã†ãªé¡§å®¢ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æŒã¤ã‹ã€‚å€‹äººãƒ»ä¼æ¥­ã©ã¡ã‚‰ã®ç´¹ä»‹ãŒä¸»ã‹' },
        ]
      },
      {
        id:'motivation', icon:'ğŸ“', title:'å¿—æœ›å‹•æ©Ÿç¢ºèª', time:'ç´„3åˆ†',
        items:[
          { id:'mot-len',  label:'å¿—æœ›å‹•æ©Ÿ 50æ–‡å­—ä»¥ä¸Š',
            autoCheck: app => app.motivation && app.motivation.length >= 50 ? 'ok' : 'ng',
            ngAlert: '50æ–‡å­—æœªæº€ã®ãŸã‚ä¸åˆæ ¼ãƒªã‚¹ã‚¯ã‚ã‚Šï¼ˆå†·ã‚„ã‹ã—åˆ¤å®šï¼‰' },
          { id:'mot-qual', label:'å¿—æœ›å‹•æ©Ÿã®å…·ä½“æ€§ç¢ºèª',        desc:'å†·ã‚„ã‹ã—ãƒ»æ¥µç«¯ã«çŸ­ã„å†…å®¹ã§ãªã„ã‹ã€‚ç´¹ä»‹ãƒ«ãƒ¼ãƒˆã®å…·ä½“æ€§ãŒã‚ã‚‹ã‹' },
        ]
      },
      {
        id:'referral', icon:'ğŸ”—', title:'ç´¹ä»‹è€…ç¢ºèª', time:'ç´„1åˆ†',
        items:[
          { id:'ref-chk', label:'ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ç¢ºèªãƒ»ç´¹ä»‹è€…ãƒ©ãƒ³ã‚¯ç¢ºèª', desc:'Goldãƒ©ãƒ³ã‚¯ä»¥ä¸Šã®ç´¹ä»‹è€…ãŒã„ã‚‹å ´åˆã¯å¯©æŸ»ã‚’å„ªé‡ã€‚ç‰¹åˆ¥ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ã®å ´åˆã¯æ¡ä»¶ç¢ºèª' },
        ]
      },
    ]
  }
};

// ================================================================
//  State
// ================================================================
let currentApp  = null;
let checkState  = {};  // { itemId: 'ok'|'ng'|'skip'|null }
let currentVerdict = null;
let timerStart  = null;
let timerInterval = null;
let currentFilter = 'all';

// ================================================================
//  Init
// ================================================================
window.addEventListener('DOMContentLoaded', () => {
  renderAppList();
});

// ================================================================
//  Applicant list
// ================================================================
function renderAppList() {
  const list  = document.getElementById('app-list');
  const apps  = APPLICANTS.filter(a =>
    currentFilter === 'all' || a.type === currentFilter
  );
  document.getElementById('pending-count').textContent =
    APPLICANTS.filter(a => a.status === 'pending').length + ' ä»¶';

  const TYPE = { re:'ä¸å‹•ç”£AG', hr:'äººæAG', pt:'Partner' };
  const TYPE_CLS = { re:'t-re', hr:'t-hr', pt:'t-pt' };
  const STATUS_CLS = { pending:'s-pending', pass:'s-pass', fail:'s-fail', hold:'s-hold' };

  list.innerHTML = apps.map(a => `
    <div class="app-card ${currentApp&&currentApp.id===a.id?'active':''}"
         onclick="selectApp('${a.id}')">
      <div class="ac-status ${STATUS_CLS[a.status]||'s-pending'}"></div>
      <div class="ac-name">${escHtml(a.name)}</div>
      <div class="ac-meta">
        <span class="ac-type ${TYPE_CLS[a.type]}">${TYPE[a.type]}</span>
        <span class="ac-time">${a.applied.slice(5,10)} ç”³è«‹</span>
        ${a.referralCode ? '<span style="font-size:9px;color:var(--gold)">ğŸ”— ç´¹ä»‹ã‚ã‚Š</span>' : ''}
      </div>
    </div>`).join('');
}

function filterApps(f, btn) {
  currentFilter = f;
  document.querySelectorAll('.sf-btn').forEach(b => b.classList.remove('on'));
  btn.classList.add('on');
  renderAppList();
}

// ================================================================
//  Select applicant
// ================================================================
function selectApp(id) {
  const app = APPLICANTS.find(a => a.id === id);
  if (!app) return;
  currentApp = app;
  checkState = {};
  currentVerdict = null;

  // Timer reset
  clearInterval(timerInterval);
  timerStart = Date.now();
  timerInterval = setInterval(updateTimer, 1000);
  updateTimer();

  renderAppList();
  renderAppHeader(app);
  renderChecklist(app);
  updateProgress();

  // Show main
  document.getElementById('empty-state').style.display = 'none';
  document.getElementById('app-hdr-wrap').style.display = 'block';

  // Reset verdict UI
  document.getElementById('result-banner').className = 'result-banner';
  document.getElementById('result-banner').innerHTML = '';
  document.getElementById('btn-calendly').style.display = 'none';
  document.getElementById('btn-reject').style.display = 'none';
  document.getElementById('verdict-note').value = '';
  document.getElementById('instant-fail-banner').classList.remove('show');

  // Auto-checks
  runAutoChecks(app);
}

// ================================================================
//  Timer
// ================================================================
function updateTimer() {
  const elapsed = Math.floor((Date.now() - timerStart) / 1000);
  const m = Math.floor(elapsed / 60).toString().padStart(2,'0');
  const s = (elapsed % 60).toString().padStart(2,'0');
  document.getElementById('timer-display').textContent = m + ':' + s;
}

// ================================================================
//  Header
// ================================================================
function renderAppHeader(app) {
  const TYPE_LABEL = { re:'ğŸ  ä¸å‹•ç”£ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ', hr:'ğŸ‘¥ äººæã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ', pt:'ğŸ¤ ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼' };
  const TYPE_COLOR = {
    re:'background:rgba(79,156,249,.15);color:#4f9cf9;border:1px solid rgba(79,156,249,.3)',
    hr:'background:rgba(20,184,166,.15);color:#2dd4bf;border:1px solid rgba(20,184,166,.3)',
    pt:'background:rgba(52,211,153,.15);color:#34d399;border:1px solid rgba(52,211,153,.3)',
  };
  const AVATAR = { re:'ğŸ ', hr:'ğŸ‘¥', pt:'ğŸ¤' };

  document.getElementById('app-avatar').textContent = AVATAR[app.type];
  document.getElementById('app-name').textContent   = app.name;
  document.getElementById('app-type-pill').textContent  = TYPE_LABEL[app.type];
  document.getElementById('app-type-pill').setAttribute('style',
    TYPE_COLOR[app.type] + ';padding:3px 10px;border-radius:5px;font-size:10px;font-weight:700');
  document.getElementById('app-sub-id').textContent    = app.id;
  document.getElementById('app-applied').textContent   = 'ç”³è«‹æ—¥æ™‚ï¼š' + app.applied;

  // Info grid
  const cl = CHECKLISTS[app.type];
  const cells = [
    { label:'å¹´é½¢',   val: app.age + 'æ­³' },
    { label:'å±…ä½åœ°', val: app.addr },
    { label:'å¯©æŸ»ç›®å®‰', val: cl.estTime },
    { label:'ç´¹ä»‹è€…',
      val: app.referralCode
        ? `<span class="referral-badge">ğŸ”— ${app.referralName} (${app.referralRank})</span>`
        : '<span style="color:var(--muted)">ãªã—</span>' },
  ];
  document.getElementById('info-grid').innerHTML =
    cells.map(c => `
      <div class="info-cell">
        <div class="ic-label">${c.label}</div>
        <div class="ic-val">${c.val}</div>
      </div>`).join('');
}

// ================================================================
//  Checklist render
// ================================================================
function renderChecklist(app) {
  const cl   = CHECKLISTS[app.type];
  const body = document.getElementById('checklist-body');

  body.innerHTML = cl.sections.map((sec, si) => `
    <div class="section" id="sec-${sec.id}">
      <div class="sec-hdr" onclick="toggleSec('${sec.id}')">
        <div class="sec-title">
          <span class="sec-icon">${sec.icon}</span>
          ${sec.title}
          <span class="sec-time">${sec.time}</span>
        </div>
        <div class="sec-meta">
          <span class="sec-progress" id="sec-prog-${sec.id}">0/${sec.items.length}</span>
          <span class="sec-chevron open" id="chev-${sec.id}">â€º</span>
        </div>
      </div>
      <div class="sec-body" id="sec-body-${sec.id}">
        ${sec.items.map((item, ii) => renderCheckItem(item, ii)).join('')}
      </div>
    </div>`).join('');
}

function renderCheckItem(item, ii) {
  const hasHint = item.hint ? `<span class="tag tag-info" style="margin-left:6px">${item.hint}</span>` : '';
  const hasNgTag = item.ngTag ? `<span class="tag tag-ng" style="margin-left:6px">${item.ngTag}</span>` : '';
  return `
    <div class="chk-item" id="row-${item.id}">
      <div class="chk-num">${String(ii+1).padStart(2,'0')}</div>
      <div class="chk-content">
        <div class="chk-label">
          ${item.label}${hasHint}${hasNgTag}
        </div>
        ${item.desc ? `<div class="chk-desc">${item.desc}</div>` : ''}
        ${item.ngAlert ? `<div class="chk-alert" id="alert-${item.id}">âš ï¸ ${item.ngAlert}</div>` : ''}
        <div class="item-memo" id="memo-${item.id}">
          <input type="text" placeholder="ãƒ¡ãƒ¢ã‚’å…¥åŠ›ï¼ˆä»»æ„ï¼‰" oninput="saveMemo('${item.id}',this.value)">
        </div>
      </div>
      <div class="status-btns">
        <button class="sb" id="sb-ok-${item.id}" title="å•é¡Œãªã—ï¼ˆOKï¼‰"
                onclick="setCheck('${item.id}','ok')">âœ“</button>
        <button class="sb" id="sb-ng-${item.id}" title="å•é¡Œã‚ã‚Šï¼ˆNGï¼‰"
                onclick="setCheck('${item.id}','ng')">âœ—</button>
        <button class="sb" id="sb-skip-${item.id}" title="ã‚¹ã‚­ãƒƒãƒ—ï¼ˆéè©²å½“ï¼‰"
                onclick="setCheck('${item.id}','skip')">â€”</button>
      </div>
    </div>`;
}

// ================================================================
//  Auto-checks
// ================================================================
function runAutoChecks(app) {
  const cl = CHECKLISTS[app.type];
  let hasInstantFail = false;
  let ifReason = '';

  cl.sections.forEach(sec => {
    sec.items.forEach(item => {
      if (item.autoCheck) {
        const result = item.autoCheck(app);
        if (result) {
          setCheck(item.id, result, true);
          if (result === 'ng' && item.instantFail) {
            hasInstantFail = true;
            ifReason = item.ngAlert || item.label;
          }
        }
      }
    });
  });

  if (hasInstantFail) {
    const banner = document.getElementById('instant-fail-banner');
    banner.classList.add('show');
    document.getElementById('ifb-title').textContent = 'å³æ™‚ä¸åˆæ ¼æ¡ä»¶ã«è©²å½“';
    document.getElementById('ifb-reason').textContent = ifReason;
  }
}

// ================================================================
//  Check state
// ================================================================
function setCheck(itemId, state, silent = false) {
  checkState[itemId] = state;

  // Update button styles
  ['ok','ng','skip'].forEach(s => {
    const btn = document.getElementById(`sb-${s}-${itemId}`);
    if (!btn) return;
    btn.className = 'sb' + (state === s ? ` ${s}-active` : '');
  });

  // Update row style
  const row = document.getElementById(`row-${itemId}`);
  if (row) {
    row.classList.toggle('ok-row', state === 'ok');
    row.classList.toggle('ng-row', state === 'ng');
  }

  // Show/hide alert
  const alert = document.getElementById(`alert-${itemId}`);
  if (alert) alert.classList.toggle('show', state === 'ng');

  // Show memo on NG
  const memo = document.getElementById(`memo-${itemId}`);
  if (memo) memo.classList.toggle('show', state === 'ng');

  updateProgress();
  updateSectionProgress();
}

function saveMemo(itemId, val) {
  if (!checkState.memos) checkState.memos = {};
  checkState.memos[itemId] = val;
}

// ================================================================
//  Progress
// ================================================================
function updateProgress() {
  if (!currentApp) return;
  const cl      = CHECKLISTS[currentApp.type];
  const allItems = cl.sections.flatMap(s => s.items);
  const total    = allItems.length;
  const done     = allItems.filter(it => checkState[it.id]).length;
  const pct      = total > 0 ? Math.round((done / total) * 100) : 0;

  // Ring
  const circ = 2 * Math.PI * 31;
  document.getElementById('ring-fill').style.strokeDashoffset = circ * (1 - pct/100);
  document.getElementById('ring-fill').style.stroke =
    pct < 50 ? 'var(--orange)' : pct < 100 ? 'var(--blue)' : 'var(--green)';
  document.getElementById('ring-pct').textContent = pct + '%';
  document.getElementById('progress-text').textContent = done + ' / ' + total + ' é …ç›®';
}

function updateSectionProgress() {
  if (!currentApp) return;
  const cl = CHECKLISTS[currentApp.type];
  cl.sections.forEach(sec => {
    const done  = sec.items.filter(it => checkState[it.id]).length;
    const el    = document.getElementById(`sec-prog-${sec.id}`);
    if (el) el.textContent = `${done}/${sec.items.length}`;
  });
}

function toggleSec(id) {
  const body = document.getElementById(`sec-body-${id}`);
  const chev = document.getElementById(`chev-${id}`);
  body.classList.toggle('collapsed');
  chev.classList.toggle('open');
}

// ================================================================
//  Verdict
// ================================================================
function setVerdict(v) {
  currentVerdict = v;
  const banner = document.getElementById('result-banner');
  const msgs = {
    pass: { cls:'rb-pass', icon:'âœ…', text:'åˆæ ¼ â€” é¢æ¥ãƒªãƒ³ã‚¯ã‚’ç™ºè¡Œã—ã¦ãã ã•ã„' },
    fail: { cls:'rb-fail', icon:'âŒ', text:'ä¸åˆæ ¼ â€” ä¸åˆæ ¼é€šçŸ¥ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¦ãã ã•ã„' },
    hold: { cls:'rb-hold', icon:'â¸', text:'ä¿ç•™ â€” è¿½åŠ ç¢ºèªå¾Œã«å†åˆ¤å®šã—ã¦ãã ã•ã„' },
  };
  const m = msgs[v];
  banner.className = `result-banner show ${m.cls}`;
  banner.innerHTML = `<span style="font-size:20px">${m.icon}</span>${m.text}`;

  document.getElementById('btn-calendly').style.display = v === 'pass' ? 'block' : 'none';
  document.getElementById('btn-reject').style.display   = v === 'fail' ? 'block' : 'none';
}

// ================================================================
//  Actions
// ================================================================
function saveToKintone() {
  if (!currentApp) return;
  if (!currentVerdict) { alert('å¯©æŸ»çµæœï¼ˆåˆæ ¼/ä¸åˆæ ¼/ä¿ç•™ï¼‰ã‚’é¸æŠã—ã¦ãã ã•ã„'); return; }
  const note = document.getElementById('verdict-note').value;

  // Update local state
  currentApp.status = currentVerdict === 'pass' ? 'pass' : currentVerdict === 'fail' ? 'fail' : 'hold';
  renderAppList();

  const verdictJP = { pass:'åˆæ ¼', fail:'ä¸åˆæ ¼', hold:'ä¿ç•™' }[currentVerdict];

  if (currentVerdict === 'pass') {
    // åˆæ ¼æ™‚: ãƒˆãƒ¼ã‚¯ãƒ³URLç™ºè¡Œ â†’ LINE WORKSã§é€ä»˜
    const typePrefix = currentApp.type === 'pt' ? 'PT' : currentApp.type === 'hr' ? 'AG' : 'AG';
    const agNum = String(Math.floor(10000 + Math.random() * 9999));
    const token = typePrefix + agNum + '-' + Math.random().toString(36).substr(2,6).toUpperCase();
    const signupUrl = location.origin + location.pathname.replace('coreto-screening.html','coreto-agent-signup.html') + '?token=' + token;

    // Show token + URL in a copyable modal
    const box = document.createElement('div');
    box.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;z-index:9999;padding:20px';
    box.innerHTML = `
      <div style="background:#11141f;border:1px solid #2a3050;border-radius:16px;padding:28px;width:min(480px,100%);font-family:inherit">
        <div style="font-size:16px;font-weight:700;color:#e8eaf0;margin-bottom:6px">âœ… åˆæ ¼ â€” å…¥ä¼šURLç™ºè¡Œ</div>
        <div style="font-size:12px;color:#a0a8c0;margin-bottom:20px">${currentApp.name} ã•ã‚“ã®å…¥ä¼šæ‰‹ç¶šãURLã§ã™ã€‚LINE WORKSã§é€ä»˜ã—ã¦ãã ã•ã„ã€‚</div>
        <div style="font-size:10px;color:#5a6080;margin-bottom:4px;letter-spacing:1px">ãƒˆãƒ¼ã‚¯ãƒ³</div>
        <div style="background:#090b13;border:1px solid #1e2235;border-radius:8px;padding:10px 14px;font-family:monospace;font-size:13px;color:#c9a840;margin-bottom:12px;word-break:break-all">${token}</div>
        <div style="font-size:10px;color:#5a6080;margin-bottom:4px;letter-spacing:1px">å…¥ä¼šURLï¼ˆã‚³ãƒ”ãƒ¼ã—ã¦é€ä»˜ï¼‰</div>
        <div id="signup-url-box" style="background:#090b13;border:1px solid #1e2235;border-radius:8px;padding:10px 14px;font-size:11px;color:#4f9cf9;margin-bottom:16px;word-break:break-all">${signupUrl}</div>
        <div style="display:flex;gap:8px">
          <button onclick="navigator.clipboard.writeText(document.getElementById('signup-url-box').textContent)" style="flex:1;background:rgba(201,168,76,.12);border:1px solid rgba(201,168,76,.3);color:#c9a840;border-radius:8px;padding:10px;cursor:pointer;font-family:inherit">ğŸ“‹ URLã‚’ã‚³ãƒ”ãƒ¼</button>
          <button onclick="this.closest('div[style*=fixed]').remove()" style="flex:1;background:transparent;border:1px solid #2a3050;color:#a0a8c0;border-radius:8px;padding:10px;cursor:pointer;font-family:inherit">é–‰ã˜ã‚‹</button>
        </div>
        <div style="margin-top:12px;font-size:10px;color:#5a6080;line-height:1.7">â€» Kintoneã«çµæœãƒ»ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜æ¸ˆã¿<br>â€» åˆæ ¼é€šçŸ¥ãƒ»é¢æ¥æ—¥ç¨‹ã¯Calendlyã§ç¢ºèªã—ã¦ãã ã•ã„</div>
      </div>`;
    document.body.appendChild(box);
  } else {
    alert(`âœ… Kintoneã«ä¿å­˜ã—ã¾ã—ãŸ\n\nç”³è«‹è€…ï¼š${currentApp.name}\nå¯©æŸ»çµæœï¼š${verdictJP}\næ‰€è¦‹ï¼š${note || 'ï¼ˆãªã—ï¼‰'}\n\nKintoneã®ç”³è«‹ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚`);
  }
}

function sendCalendly() {
  if (!currentApp) return;
  alert(`ğŸ“… Calendlyãƒªãƒ³ã‚¯ã‚’ç™ºè¡Œã—ã¾ã—ãŸ\n\nå®›å…ˆï¼š${currentApp.email}\nå†…å®¹ï¼šé¢æ¥äºˆç´„ãƒªãƒ³ã‚¯ï¼ˆæœ‰åŠ¹æœŸé™ï¼š7æ—¥é–“ï¼‰\n\nâ€»æœ¬ç•ªã§ã¯Calendly API + ZapierçµŒç”±ã§è‡ªå‹•é€ä¿¡ã•ã‚Œã¾ã™`);
}

function sendRejection() {
  if (!currentApp) return;
  const note = document.getElementById('verdict-note').value;
  alert(`âœ‰ ä¸åˆæ ¼é€šçŸ¥ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸ\n\nå®›å…ˆï¼š${currentApp.email}\nç†ç”±ï¼š${note || 'ï¼ˆå¯©æŸ»åŸºæº–ã‚’æº€ãŸã•ãªã‹ã£ãŸãŸã‚ï¼‰'}\n\nâ€»æœ¬ç•ªã§ã¯ZapierçµŒç”±ã§Gmailè‡ªå‹•é€ä¿¡ã•ã‚Œã¾ã™`);
}

// ================================================================
//  Detail modal
// ================================================================
function showDetailModal() {
  if (!currentApp) return;
  const app = currentApp;
  const TYPE = { re:'ğŸ  ä¸å‹•ç”£ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ', hr:'ğŸ‘¥ äººæã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ', pt:'ğŸ¤ ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼' };
  const motLen = (app.motivation||'').length;

  let specificHTML = '';
  if (app.type === 're') {
    specificHTML = `
      <div class="detail-sec">
        <div class="detail-sec-title">ä¸å‹•ç”£ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ è©³ç´°</div>
        <div class="detail-row"><span class="dr-key">å®…å»ºå£«è³‡æ ¼</span>
          <span class="dr-val">${app.takken
            ? `<span class="tag tag-ok">ä¿æœ‰</span> ${app.takkenNo}ï¼ˆæœ‰åŠ¹æœŸé™ï¼š${app.takkenExp}ï¼‰`
            : '<span class="tag tag-warn">æœªä¿æœ‰</span>'}</span></div>
        <div class="detail-row"><span class="dr-key">æ¥­ç•ŒçµŒé¨“</span><span class="dr-val">${app.experience}</span></div>
        <div class="detail-row"><span class="dr-key">å®Ÿç¸¾</span><span class="dr-val">${app.expDetail||'â€”'}</span></div>
        <div class="detail-row"><span class="dr-key">å¾—æ„ã‚¨ãƒªã‚¢</span><span class="dr-val">${app.area||'â€”'}</span></div>
        <div class="detail-row"><span class="dr-key">å¾—æ„ç‰©ä»¶</span><span class="dr-val">${app.propType||'â€”'}</span></div>
      </div>`;
  } else if (app.type === 'hr') {
    specificHTML = `
      <div class="detail-sec">
        <div class="detail-sec-title">äººæã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ è©³ç´°</div>
        <div class="detail-row"><span class="dr-key">æ¥­ç•ŒçµŒé¨“</span><span class="dr-val">${app.experience}</span></div>
        <div class="detail-row"><span class="dr-key">å®Ÿç¸¾</span><span class="dr-val">${app.expDetail||'â€”'}</span></div>
        <div class="detail-row"><span class="dr-key">æ¥­å‹™å†…å®¹</span>
          <span class="dr-val">${(app.jobTypes||[]).join('ã€')||'â€”'}</span></div>
        <div class="detail-row"><span class="dr-key">å¾—æ„æ¥­ç•Œ</span><span class="dr-val">${app.industry||'â€”'}</span></div>
        <div class="detail-row"><span class="dr-key">å¾—æ„è·ç¨®</span><span class="dr-val">${app.occupation||'â€”'}</span></div>
      </div>`;
  } else if (app.type === 'pt' && app.corpName) {
    specificHTML = `
      <div class="detail-sec">
        <div class="detail-sec-title">æ³•äººæƒ…å ±</div>
        <div class="detail-row"><span class="dr-key">æ³•äººå</span><span class="dr-val">${app.corpName}</span></div>
        <div class="detail-row"><span class="dr-key">æ³•äººç•ªå·</span><span class="dr-val">${app.corpNo}</span></div>
        <div class="detail-row"><span class="dr-key">ä»£è¡¨è€…</span><span class="dr-val">${app.repName}</span></div>
      </div>`;
  }

  document.getElementById('modal-body').innerHTML = `
    <div class="detail-sec">
      <div class="detail-sec-title">åŸºæœ¬æƒ…å ±</div>
      <div class="detail-row"><span class="dr-key">æ°å</span><span class="dr-val">${app.name}ï¼ˆ${app.kana||'â€”'}ï¼‰</span></div>
      <div class="detail-row"><span class="dr-key">ç”³è«‹ã‚¿ã‚¤ãƒ—</span><span class="dr-val">${TYPE[app.type]}</span></div>
      <div class="detail-row"><span class="dr-key">å¹´é½¢</span><span class="dr-val">${app.age}æ­³</span></div>
      <div class="detail-row"><span class="dr-key">ä½æ‰€</span><span class="dr-val">${app.addr}</span></div>
      <div class="detail-row"><span class="dr-key">ãƒ¡ãƒ¼ãƒ«</span><span class="dr-val">${app.email}</span></div>
      <div class="detail-row"><span class="dr-key">é›»è©±</span><span class="dr-val">${app.tel}</span></div>
      <div class="detail-row"><span class="dr-key">ç”³è«‹æ—¥æ™‚</span><span class="dr-val">${app.applied}</span></div>
      <div class="detail-row"><span class="dr-key">ç”³è«‹ID</span><span class="dr-val" style="font-family:'DM Mono',monospace">${app.id}</span></div>
    </div>
    ${specificHTML}
    <div class="detail-sec">
      <div class="detail-sec-title">ç´¹ä»‹ã‚³ãƒ¼ãƒ‰</div>
      ${app.referralCode
        ? `<div class="referral-badge">ğŸ”— ${app.referralCode}ï¼ˆ${app.referralName} / ${app.referralRank}ï¼‰</div>`
        : '<span style="font-size:12px;color:var(--muted)">ãªã—</span>'}
    </div>
    <div class="detail-sec">
      <div class="detail-sec-title">å¿—æœ›å‹•æ©Ÿ</div>
      <div class="motivation-box">${(app.motivation||'').replace(/\n/g,'<br>')}</div>
      <div class="char-count">${motLen}æ–‡å­—</div>
    </div>`;

  document.getElementById('modal-overlay').classList.add('show');
}

function closeModal() {
  document.getElementById('modal-overlay').classList.remove('show');
}
</script>
</body>
</html>
