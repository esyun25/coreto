<!DOCTYPE html>
<html lang="ja">
<head>
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://js.stripe.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob:; connect-src 'self' https://hooks.slack.com https://hooks.zapier.com https://api.stripe.com https://js.stripe.com https://www.houjin-bangou.nta.go.jp https://www.retio.or.jp; frame-src 'none'; object-src 'none'; base-uri 'self';">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#07090f">
<title>CORETO ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=DM+Mono:wght@400;500&family=Syne:wght@700;800&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
input,button,select,textarea{touch-action:manipulation;font-family:inherit}
:root{
  --bg:#07090f;--card:#0f1119;--card2:#13161f;--border:#1e2235;--border2:#252a3d;
  --gold:#c9a84c;--gold-l:#e8c96a;--gold-dim:#7a5f22;--gold-glow:rgba(201,168,76,.12);
  --blue:#4f9cf9;--green:#34d399;--red:#f87171;--orange:#fb923c;--purple:#a78bfa;
  --muted:#4a5270;--sub:#7a849e;--text:#e2e6f3;
  --nav-h:calc(60px + env(safe-area-inset-bottom,0px));
  --safe-top:env(safe-area-inset-top,0px);
  --safe-bot:env(safe-area-inset-bottom,0px);
}
html,body{height:100%;background:var(--bg);color:var(--text);font-family:'Noto Sans JP',sans-serif;overflow:hidden}
::-webkit-scrollbar{display:none}
/* â”€â”€â”€ ã‚¢ãƒ—ãƒªã‚·ã‚§ãƒ« â”€â”€â”€ */
.app{display:flex;flex-direction:column;height:100dvh;overflow:hidden;position:relative}

/* â”€â”€â”€ ãƒ˜ãƒƒãƒ€ãƒ¼ â”€â”€â”€ */
.header{flex-shrink:0;padding:calc(var(--safe-top) + 10px) 14px 10px;background:rgba(7,9,15,.96);border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px;backdrop-filter:blur(14px);-webkit-backdrop-filter:blur(14px);z-index:100;position:relative}
.hdr-logo{font-family:'Syne',sans-serif;font-size:16px;font-weight:800;color:var(--gold);letter-spacing:3px;flex-shrink:0}
.hdr-user{flex:1;min-width:0}
.hdr-name{font-size:13px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.hdr-id{font-family:'DM Mono',monospace;font-size:10px;color:var(--muted)}
.hdr-btns{display:flex;gap:8px;flex-shrink:0}
.hdr-btn{width:36px;height:36px;border-radius:10px;border:1px solid var(--border2);background:var(--card2);display:flex;align-items:center;justify-content:center;font-size:16px;cursor:pointer;position:relative;flex-shrink:0}
.hdr-btn:active{background:var(--border2)}
.notif-dot{position:absolute;top:5px;right:5px;width:8px;height:8px;background:var(--red);border-radius:50%;border:1.5px solid var(--bg)}

/* â”€â”€â”€ ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æœ¬ä½“ â”€â”€â”€ */
.body{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-bottom:calc(var(--nav-h) + 8px)}

/* â”€â”€â”€ ã‚»ã‚¯ã‚·ãƒ§ãƒ³å…±é€š â”€â”€â”€ */
.sec{padding:14px 14px 0}
.sec-hdr{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
.sec-title{font-size:9px;font-weight:700;color:var(--muted);letter-spacing:2px;text-transform:uppercase;display:flex;align-items:center;gap:6px}
.sec-title::before{content:'';display:inline-block;width:3px;height:10px;background:var(--gold);border-radius:2px}
.sec-link{font-size:10px;color:var(--blue);text-decoration:none;font-weight:700;cursor:pointer}
.sec-link:active{opacity:.7}

/* â”€â”€â”€ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚«ãƒ¼ãƒ‰ â”€â”€â”€ */
.profile-card{background:linear-gradient(135deg,rgba(201,168,76,.1),rgba(201,168,76,.03));border:1px solid rgba(201,168,76,.2);border-radius:16px;padding:16px 16px 14px;position:relative;overflow:hidden}
.profile-card::before{content:'';position:absolute;right:-40px;top:-40px;width:160px;height:160px;border-radius:50%;background:radial-gradient(circle,rgba(201,168,76,.06) 0%,transparent 70%)}
.pc-top{display:flex;align-items:center;gap:12px;margin-bottom:12px}
.avatar{width:50px;height:50px;border-radius:50%;background:linear-gradient(135deg,var(--gold-dim),rgba(201,168,76,.3));display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0;border:2px solid rgba(201,168,76,.3)}
.pc-info{flex:1;min-width:0}
.pc-greeting{font-size:10px;color:var(--sub);margin-bottom:2px}
.pc-name{font-family:'Syne',sans-serif;font-size:18px;font-weight:700;line-height:1.1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.pc-meta{display:flex;align-items:center;gap:8px;margin-top:5px;flex-wrap:wrap}
.rank-badge{font-size:10px;font-weight:700;padding:3px 9px;border-radius:5px;letter-spacing:.5px}
.rb-gold{background:rgba(201,168,76,.2);color:var(--gold);border:1px solid rgba(201,168,76,.3)}
.rb-platinum{background:rgba(167,139,250,.2);color:var(--purple);border:1px solid rgba(167,139,250,.3)}
.rb-silver{background:rgba(160,160,160,.15);color:#c0c0c0;border:1px solid rgba(160,160,160,.3)}
.rb-bronze{background:rgba(180,120,60,.15);color:#cd7f32;border:1px solid rgba(180,120,60,.3)}
.rb-pt{background:rgba(52,211,153,.15);color:var(--green);border:1px solid rgba(52,211,153,.3)}
.pc-id{font-family:'DM Mono',monospace;font-size:10px;color:var(--muted)}
/* é€²æ—ãƒãƒ¼ */
.rp-bar-wrap{margin-top:10px}
.rp-labels{display:flex;justify-content:space-between;font-size:9px;color:var(--muted);margin-bottom:4px}
.rp-bar{height:3px;background:var(--border2);border-radius:2px;overflow:hidden}
.rp-fill{height:100%;background:linear-gradient(90deg,var(--gold-dim),var(--gold));border-radius:2px;transition:width .6s ease}
/* çµ±è¨ˆ */
.pc-stats{display:flex;gap:0;margin-top:12px;padding-top:12px;border-top:1px solid rgba(30,34,53,.7)}
.ps-item{flex:1;text-align:center}
.ps-item+.ps-item{border-left:1px solid var(--border)}
.ps-val{font-family:'DM Mono',monospace;font-size:18px;font-weight:500;color:var(--gold)}
.ps-lbl{font-size:9px;color:var(--muted);margin-top:2px}

/* â”€â”€â”€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ â”€â”€â”€ */
.action-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
.ac{background:var(--card);border:1px solid var(--border);border-radius:13px;padding:14px 12px;cursor:pointer;transition:all .15s;position:relative;overflow:hidden;display:flex;flex-direction:column;gap:7px;min-height:88px;text-decoration:none;color:inherit}
.ac:active{transform:scale(.97);opacity:.9}
.ac::before{content:'';position:absolute;top:0;left:0;right:0;height:2px}
.ac.primary{border-color:rgba(201,168,76,.3);background:rgba(201,168,76,.04)}
.ac.primary::before{background:linear-gradient(90deg,var(--gold-dim),var(--gold))}
.ac.blue::before{background:linear-gradient(90deg,rgba(79,156,249,.3),var(--blue))}
.ac.green::before{background:linear-gradient(90deg,rgba(52,211,153,.3),var(--green))}
.ac.orange::before{background:linear-gradient(90deg,rgba(251,146,60,.3),var(--orange))}
.ac.purple::before{background:linear-gradient(90deg,rgba(167,139,250,.3),var(--purple))}
.ac-icon{font-size:22px}
.ac-title{font-size:12px;font-weight:700;line-height:1.2}
.ac-desc{font-size:9px;color:var(--muted);line-height:1.4}
.ac-badge{position:absolute;top:8px;right:8px;background:var(--red);color:#fff;font-size:8px;font-weight:700;padding:2px 6px;border-radius:8px}

/* â”€â”€â”€ æ¡ˆä»¶ãƒªã‚¹ãƒˆ â”€â”€â”€ */
.case-item{background:var(--card);border:1px solid var(--border);border-radius:11px;padding:12px 13px;margin-bottom:8px;display:flex;align-items:center;gap:11px;cursor:pointer;transition:border-color .15s}
.case-item:active{border-color:rgba(201,168,76,.3);background:rgba(201,168,76,.03)}
.ci-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.ci-info{flex:1;min-width:0}
.ci-title{font-size:12px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.ci-meta{font-size:9px;color:var(--muted);margin-top:2px;font-family:'DM Mono',monospace}
.ci-status{font-size:9px;padding:3px 8px;border-radius:4px;font-weight:600;white-space:nowrap;flex-shrink:0}
.s-active{background:rgba(52,211,153,.12);color:var(--green)}
.s-wait{background:rgba(251,146,60,.12);color:var(--orange)}
.s-draft{background:rgba(79,156,249,.12);color:var(--blue)}

/* â”€â”€â”€ å®Ÿç¸¾ãƒ‘ãƒãƒ« â”€â”€â”€ */
.perf-row{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:10px}
.perf-card{background:var(--card2);border:1px solid var(--border);border-radius:10px;padding:12px}
.pv{font-family:'DM Mono',monospace;font-size:18px;font-weight:500}
.pl{font-size:9px;color:var(--muted);margin-top:3px}
.bar-row{display:flex;align-items:center;gap:8px;margin-bottom:5px;font-size:9px}
.bar-lbl{color:var(--muted);width:24px;text-align:right;flex-shrink:0;font-family:'DM Mono',monospace}
.bar-wrap{flex:1;height:5px;background:var(--border2);border-radius:3px;overflow:hidden}
.bar-fill{height:100%;border-radius:3px;background:linear-gradient(90deg,var(--gold-dim),var(--gold))}
.bar-val{color:var(--sub);width:28px;text-align:right;font-family:'DM Mono',monospace}

/* â”€â”€â”€ ãƒœãƒˆãƒ ãƒŠãƒ“ â”€â”€â”€ */
.bottom-nav{position:fixed;bottom:0;left:0;right:0;z-index:200;background:rgba(10,12,18,.97);border-top:1px solid var(--border);display:flex;padding-bottom:var(--safe-bot);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px)}
.nav-item{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:10px 4px 8px;cursor:pointer;position:relative;text-decoration:none;color:var(--muted);transition:color .15s}
.nav-item.on{color:var(--gold)}
.nav-item:active{opacity:.7}
.nav-icon{font-size:20px;line-height:1}
.nav-lbl{font-size:9px;margin-top:3px;font-weight:600;letter-spacing:.3px}
.nav-badge{position:absolute;top:6px;left:50%;margin-left:4px;background:var(--red);color:#fff;font-size:8px;font-weight:700;padding:1px 5px;border-radius:8px;min-width:16px;text-align:center}

/* â”€â”€â”€ ãƒœãƒˆãƒ ã‚·ãƒ¼ãƒˆå…±é€š â”€â”€â”€ */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.72);backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);z-index:300;display:flex;align-items:flex-end;opacity:0;pointer-events:none;transition:opacity .25s}
.overlay.show{opacity:1;pointer-events:all}
.sheet{width:100%;background:var(--card);border-radius:22px 22px 0 0;border:1px solid var(--border);border-bottom:none;padding-bottom:calc(var(--safe-bot) + 12px);transform:translateY(100%);transition:transform .32s cubic-bezier(.32,0,.67,0);overflow:hidden;display:flex;flex-direction:column}
.overlay.show .sheet{transform:translateY(0);transition-timing-function:cubic-bezier(.33,1,.68,1)}
.sheet-handle{width:40px;height:4px;background:var(--border2);border-radius:2px;margin:11px auto 0;flex-shrink:0}
.sheet-hdr{padding:14px 18px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;flex-shrink:0;position:sticky;top:0;background:var(--card);z-index:10}
.sheet-title{font-family:'Syne',sans-serif;font-size:14px;font-weight:800;color:var(--gold)}
.sheet-close{background:none;border:none;color:var(--muted);font-size:22px;cursor:pointer;line-height:1;padding:4px}
.sheet-body{overflow-y:auto;padding:16px 18px;-webkit-overflow-scrolling:touch}
.sheet-max{max-height:88dvh}

/* é€šçŸ¥ */
.notif-item{display:flex;gap:10px;padding:11px 0;border-bottom:1px solid rgba(30,34,53,.5)}
.notif-item:last-child{border-bottom:none}
.ni-icon{font-size:18px;flex-shrink:0;margin-top:1px}
.ni-body{flex:1}
.ni-text{font-size:12px;line-height:1.6}
.ni-time{font-size:10px;color:var(--muted);margin-top:2px;font-family:'DM Mono',monospace}
.ni-new{width:7px;height:7px;border-radius:50%;background:var(--blue);flex-shrink:0;margin-top:5px}

/* ååˆºãƒ‘ãƒãƒ« */
.bc-preview{background:white;border-radius:9px;padding:13px 16px;margin-bottom:14px;position:relative}
.bc-logo{font-size:8px;color:#888;letter-spacing:2px;margin-bottom:7px}
.bc-name-main{font-size:15px;font-weight:700;color:#1a1a1a;margin-bottom:2px}
.bc-kana{font-size:10px;color:#888;font-family:monospace;margin-bottom:9px}
.bc-divider{width:100%;height:1px;background:#eee;margin-bottom:9px}
.bc-contact{font-size:9px;color:#555;line-height:1.9}
.bc-takken-row{display:flex;align-items:center;gap:10px;padding:12px 13px;background:var(--card2);border:1px solid var(--border);border-radius:11px;margin-bottom:10px;cursor:pointer}
.bc-takken-row input[type=checkbox]{width:18px;height:18px;accent-color:var(--gold)}
.bc-check-label{flex:1}
.bc-check-title{font-size:12px;font-weight:700}
.bc-check-sub{font-size:10px;color:var(--muted)}
.bc-note-wrap{margin-bottom:12px}
.bc-note-label{font-size:10px;color:var(--sub);margin-bottom:5px;font-weight:600}
.bc-note{width:100%;background:#090b13;border:1px solid var(--border2);border-radius:9px;padding:10px 12px;color:var(--text);font-size:14px;font-family:'Noto Sans JP',sans-serif;resize:vertical;outline:none;min-height:56px}
.bc-note:focus{border-color:var(--gold)}
.bc-card-info{display:flex;align-items:center;justify-content:space-between;padding:11px 13px;background:var(--card2);border:1px solid var(--border);border-radius:10px;margin-bottom:12px}
.bc-btn{width:100%;padding:14px;border-radius:12px;border:none;cursor:pointer;font-size:13px;font-weight:700;display:flex;align-items:center;justify-content:center;gap:7px}
.bc-btn.order{background:linear-gradient(135deg,var(--gold),#a8742a);color:#0a0c10;margin-top:2px}
.bc-btn.order:active{transform:scale(.98)}
.bc-btn.preview{background:rgba(79,156,249,.1);border:1px solid rgba(79,156,249,.3);color:var(--blue);margin-bottom:8px}
.bc-btn.slack{background:rgba(74,82,112,.1);border:1px solid var(--border2);color:var(--sub)}
.bc-btn-row{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:10px}
.bc-info-box{padding:11px 13px;background:rgba(201,168,76,.05);border:1px solid var(--gold-dim);border-radius:9px;font-size:10px;color:var(--sub);line-height:1.9;margin-bottom:12px}
/* ç™ºæ³¨å±¥æ­´ */
.bc-hist-hdr{font-size:9px;color:var(--muted);letter-spacing:1.5px;text-transform:uppercase;margin-bottom:8px;padding-top:14px;border-top:1px solid var(--border)}
.bc-hist-item{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;background:var(--card2);border-radius:9px;font-size:11px;margin-bottom:6px}

/* ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ‘ãƒãƒ« */
.menu-list{display:grid;gap:8px}
.menu-item{display:flex;align-items:center;gap:12px;padding:14px 14px;background:var(--card2);border:1px solid var(--border);border-radius:12px;cursor:pointer;text-decoration:none;color:inherit;transition:border-color .15s}
.menu-item:active{border-color:var(--gold-dim);background:rgba(201,168,76,.04)}
.menu-icon{font-size:20px;flex-shrink:0}
.menu-info{flex:1}
.menu-title{font-size:13px;font-weight:700}
.menu-sub{font-size:10px;color:var(--muted);margin-top:2px}
.menu-arrow{color:var(--muted);font-size:12px;flex-shrink:0}

/* ç´¹ä»‹ãƒªãƒ³ã‚¯ãƒ¢ãƒ¼ãƒ€ãƒ« */
.ref-url{background:var(--card2);border:1px solid var(--border2);border-radius:8px;padding:10px 12px;font-family:'DM Mono',monospace;font-size:10px;color:var(--sub);word-break:break-all;margin:10px 0;min-height:36px}
.copy-btn{width:100%;padding:12px;border-radius:10px;border:none;cursor:pointer;font-size:13px;font-weight:700;background:var(--gold);color:#0a0c10;margin-top:4px}
.copy-btn:active{opacity:.9}

/* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
.loading-overlay{position:fixed;inset:0;background:rgba(7,9,15,.94);backdrop-filter:blur(10px);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9000;opacity:0;pointer-events:none;transition:opacity .3s}
.loading-overlay.show{opacity:1;pointer-events:all}
.spinner{width:44px;height:44px;border:2.5px solid rgba(201,168,76,.2);border-top-color:var(--gold);border-radius:50%;animation:spin .7s linear infinite;margin-bottom:18px}
@keyframes spin{to{transform:rotate(360deg)}}

/* ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ */
.gold-badge{font-size:9px;padding:3px 9px;border-radius:6px;font-weight:700;background:rgba(201,168,76,.13);color:var(--gold);border:1px solid var(--gold-dim)}
.green-badge{font-size:9px;padding:3px 9px;border-radius:6px;font-weight:700;background:rgba(52,211,153,.13);color:var(--green);border:1px solid rgba(52,211,153,.3)}
.page-bottom-pad{height:16px}
</style>
</head>
<body>

<!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° -->
<div class="loading-overlay" id="loading-overlay">
  <div class="spinner"></div>
</div>

<!-- â”€â”€ ã‚¢ãƒ—ãƒªã‚·ã‚§ãƒ« â”€â”€ -->
<div class="app">

  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <div class="header">
    <div class="hdr-logo">CORETO</div>
    <div class="hdr-user">
      <div class="hdr-name" id="hdr-name">â€”</div>
      <div class="hdr-id" id="hdr-id">â€”</div>
    </div>
    <div class="hdr-btns">
      <!-- é€šçŸ¥ãƒ™ãƒ« -->
      <div class="hdr-btn" onclick="openNotif()" id="notif-btn">
        ğŸ””
        <div class="notif-dot" id="notif-dot" style="display:none"></div>
      </div>
      <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
      <div class="hdr-btn" onclick="openMenu()">â˜°</div>
    </div>
  </div>

  <!-- ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æœ¬ä½“ -->
  <div class="body" id="body">

    <!-- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« -->
    <div class="sec">
      <div class="profile-card" id="profile-card">
        <div class="pc-top">
          <div class="avatar" id="avatar">ğŸ‘¤</div>
          <div class="pc-info">
            <div class="pc-greeting">ã“ã‚“ã«ã¡ã¯</div>
            <div class="pc-name" id="profile-name">â€”</div>
            <div class="pc-meta">
              <span class="rank-badge" id="rank-badge">â€”</span>
              <span class="pc-id" id="profile-id">â€”</span>
            </div>
          </div>
        </div>
        <div class="rp-bar-wrap" id="rp-wrap">
          <div class="rp-labels"><span id="rp-lbl">â€”</span></div>
          <div class="rp-bar"><div class="rp-fill" id="rp-fill" style="width:0%"></div></div>
        </div>
        <div class="pc-stats">
          <div class="ps-item">
            <div class="ps-val" id="ps-cases">0</div>
            <div class="ps-lbl">ä»Šæœˆæˆç´„</div>
          </div>
          <div class="ps-item">
            <div class="ps-val" id="ps-reward" style="font-size:14px">Â¥â€”</div>
            <div class="ps-lbl">ä»Šæœˆå ±é…¬è¦‹è¾¼ã¿</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="sec" style="margin-top:16px">
      <div class="sec-hdr">
        <div class="sec-title">ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</div>
      </div>
      <div class="action-grid" id="action-grid"><!-- JSç”Ÿæˆ --></div>
    </div>

    <!-- é€²è¡Œä¸­æ¡ˆä»¶ -->
    <div class="sec" style="margin-top:16px">
      <div class="sec-hdr">
        <div class="sec-title">é€²è¡Œä¸­ã®æ¡ˆä»¶</div>
        <a class="sec-link" onclick="goto('coreto-matching.html')">ã™ã¹ã¦è¦‹ã‚‹ â†’</a>
      </div>
      <div id="cases-list"><!-- JSç”Ÿæˆ --></div>
    </div>

    <!-- å®Ÿç¸¾ -->
    <div class="sec" style="margin-top:16px">
      <div class="sec-hdr">
        <div class="sec-title">ä»Šæœˆã®å®Ÿç¸¾</div>
      </div>
      <div class="perf-row">
        <div class="perf-card">
          <div class="pv" id="perf-cases" style="color:var(--gold)">0</div>
          <div class="pl">æˆç´„ä»¶æ•°</div>
        </div>
        <div class="perf-card">
          <div class="pv" id="perf-reward" style="color:var(--green);font-size:14px">Â¥0</div>
          <div class="pl">å ±é…¬é¡ï¼ˆæ‰‹å–ã‚Šï¼‰</div>
        </div>
      </div>
      <div id="bar-chart" style="background:var(--card);border:1px solid var(--border);border-radius:11px;padding:12px"><!-- JSç”Ÿæˆ --></div>
    </div>

    <!-- ååˆºç™ºæ³¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="sec" style="margin-top:16px" id="bc-section">
      <div class="sec-hdr">
        <div class="sec-title">ååˆºç™ºæ³¨</div>
        <span class="gold-badge">Â¥2,000 / ã‚»ãƒƒãƒˆ</span>
      </div>
      <div style="background:var(--card);border:1px solid var(--border);border-radius:13px;padding:14px;display:flex;align-items:center;justify-content:space-between;cursor:pointer" onclick="openBc()">
        <div style="display:flex;align-items:center;gap:10px">
          <span style="font-size:22px">ğŸªª</span>
          <div>
            <div style="font-size:13px;font-weight:700">ååˆºã‚’ç™ºæ³¨ã™ã‚‹</div>
            <div style="font-size:10px;color:var(--muted)">100æšã‚»ãƒƒãƒˆãƒ»ç‰‡é¢ã‚«ãƒ©ãƒ¼ãƒ»1é€±é–“ç´æœŸ</div>
          </div>
        </div>
        <span style="color:var(--muted);font-size:14px">â€º</span>
      </div>
    </div>

    <!-- ç´¹ä»‹ãƒªãƒ³ã‚¯ -->
    <div class="sec" style="margin-top:14px">
      <div style="background:var(--card);border:1px solid rgba(201,168,76,.25);border-radius:13px;padding:14px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;background:rgba(201,168,76,.04)" onclick="openRef()">
        <div style="display:flex;align-items:center;gap:10px">
          <span style="font-size:22px">ğŸ”—</span>
          <div>
            <div style="font-size:13px;font-weight:700;color:var(--gold)">ç´¹ä»‹ãƒªãƒ³ã‚¯ç™ºè¡Œ</div>
            <div style="font-size:10px;color:var(--muted)">ãƒªãƒ³ã‚¯ã‹ã‚‰å…¥ä¼šã§è‡ªå‹•ã‚³ãƒ¼ãƒ‰ä»˜ä¸</div>
          </div>
        </div>
        <span style="color:var(--muted);font-size:14px">â€º</span>
      </div>
    </div>

    <div class="page-bottom-pad"></div>
  </div>

  <!-- ãƒœãƒˆãƒ ãƒŠãƒ“ -->
  <div class="bottom-nav" id="bottom-nav"><!-- JSç”Ÿæˆ --></div>
</div>

<!-- â•â• é€šçŸ¥ãƒ‘ãƒãƒ« â•â• -->
<div class="overlay" id="notif-overlay" onclick="if(event.target===this)closeNotif()">
  <div class="sheet sheet-max">
    <div class="sheet-handle"></div>
    <div class="sheet-hdr">
      <div class="sheet-title">ğŸ”” é€šçŸ¥</div>
      <button class="sheet-close" onclick="closeNotif()">âœ•</button>
    </div>
    <div class="sheet-body" id="notif-body"><!-- JSç”Ÿæˆ --></div>
  </div>
</div>

<!-- â•â• ååˆºãƒ‘ãƒãƒ« â•â• -->
<div class="overlay" id="bc-overlay" onclick="if(event.target===this)closeBc()">
  <div class="sheet sheet-max">
    <div class="sheet-handle"></div>
    <div class="sheet-hdr">
      <div class="sheet-title">ğŸªª ååˆºç™ºæ³¨</div>
      <button class="sheet-close" onclick="closeBc()">âœ•</button>
    </div>
    <div class="sheet-body">
      <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
      <div class="bc-preview">
        <div class="bc-logo">CORETO</div>
        <div id="bc-takken-title" style="font-size:10px;color:#c9a84c;font-weight:700;margin-bottom:4px;display:none">å®…åœ°å»ºç‰©å–å¼•å£«</div>
        <div class="bc-name-main" id="bc-name">â€”</div>
        <div class="bc-kana" id="bc-kana">â€”</div>
        <div class="bc-divider"></div>
        <div class="bc-contact" id="bc-contact">â€”</div>
      </div>
      <!-- å®…å»ºãƒã‚§ãƒƒã‚¯ -->
      <div class="bc-takken-row" onclick="document.getElementById('bc-takken').click()">
        <input type="checkbox" id="bc-takken" onchange="updateBcPreview()" onclick="event.stopPropagation()">
        <span style="font-size:18px">ğŸ›</span>
        <div class="bc-check-label">
          <div class="bc-check-title">å®…åœ°å»ºç‰©å–å¼•å£«</div>
          <div class="bc-check-sub">ãƒã‚§ãƒƒã‚¯ã§ååˆºã«è‚©æ›¸ãã‚’è¿½åŠ </div>
        </div>
        <div id="bc-takken-badge" style="display:none" class="gold-badge">å®…å»ºå£«</div>
      </div>
      <!-- ç‰¹è¨˜äº‹é … -->
      <div class="bc-note-wrap">
        <div class="bc-note-label">ç‰¹è¨˜äº‹é …ï¼ˆä»»æ„ï¼‰</div>
        <textarea class="bc-note" id="bc-note" rows="2" placeholder="ä¾‹ï¼šæ—§å§“ã‚’è¡¨è¨˜å¸Œæœ›ãƒ»å½¹è·è¿½åŠ ãªã©"></textarea>
      </div>
      <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
      <div class="bc-btn-row">
        <button class="bc-btn preview" onclick="previewBcPdf()">ğŸ‘ PDFãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
        <button class="bc-btn slack" onclick="sendToSlack()">ğŸ’¬ Slacké€ä¿¡</button>
      </div>
      <!-- ã‚«ãƒ¼ãƒ‰æƒ…å ± -->
      <div class="bc-info-box">
        ğŸ’³ ç™ºæ³¨ã™ã‚‹ã¨ç™»éŒ²ã‚«ãƒ¼ãƒ‰ï¼ˆVisa Â·Â·Â·4242ï¼‰ã‚ˆã‚Š <strong style="color:var(--gold)">Â¥2,000</strong> ãŒå³æ™‚æ±ºæ¸ˆã•ã‚Œã¾ã™ã€‚<br>
        ãƒ»<strong style="color:var(--text)">PDFãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</strong>ï¼š91Ã—55mmã®ååˆºPDFã‚’ç”Ÿæˆ<br>
        ãƒ»<strong style="color:var(--text)">Slacké€ä¿¡</strong>ï¼šæœ¬éƒ¨ã¸ç™ºæ³¨æƒ…å ±ã‚’é€ä¿¡ï¼ˆæœ¬éƒ¨ãŒAIã§ä½œæˆï¼‰
      </div>
      <div class="bc-card-info">
        <div style="display:flex;align-items:center;gap:10px">
          <span style="font-size:20px">ğŸ’³</span>
          <div>
            <div style="font-size:11px;font-weight:700">Visa Â·Â·Â·4242</div>
            <div style="font-size:10px;color:var(--muted)">ç™»éŒ²æ¸ˆã¿ã‚«ãƒ¼ãƒ‰</div>
          </div>
        </div>
        <span class="green-badge">âœ“ æœ‰åŠ¹</span>
      </div>
      <button class="bc-btn order" id="bc-order-btn" onclick="orderBusinessCard()">ğŸªª ç™ºæ³¨ã™ã‚‹ï¼ˆÂ¥2,000 å³æ™‚æ±ºæ¸ˆï¼‰</button>
      <!-- ç™ºæ³¨å±¥æ­´ -->
      <div class="bc-hist-hdr">ç™ºæ³¨å±¥æ­´</div>
      <div id="bc-history">
        <div class="bc-hist-item">
          <div><div style="font-weight:700">2026/01/10 ç™ºæ³¨</div><div style="color:var(--muted);font-size:10px">100æš / é€šå¸¸ãƒ‡ã‚¶ã‚¤ãƒ³</div></div>
          <div style="text-align:right"><div style="font-family:'DM Mono',monospace;color:var(--red)">-Â¥2,000</div><span class="green-badge" style="font-size:8px">ç´å“æ¸ˆã¿</span></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â• ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ‘ãƒãƒ« â•â• -->
<div class="overlay" id="menu-overlay" onclick="if(event.target===this)closeMenu()">
  <div class="sheet sheet-max">
    <div class="sheet-handle"></div>
    <div class="sheet-hdr">
      <div class="sheet-title">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</div>
      <button class="sheet-close" onclick="closeMenu()">âœ•</button>
    </div>
    <div class="sheet-body">
      <div class="menu-list" id="menu-list"><!-- JSç”Ÿæˆ --></div>
      <div style="margin-top:16px;padding-top:16px;border-top:1px solid var(--border)">
        <div class="menu-item" onclick="doLogout()" style="border-color:rgba(248,113,113,.2)">
          <span class="menu-icon">ğŸšª</span>
          <div class="menu-info"><div class="menu-title" style="color:var(--red)">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</div></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â• ç´¹ä»‹ãƒªãƒ³ã‚¯ãƒ¢ãƒ¼ãƒ€ãƒ« â•â• -->
<div class="overlay" id="ref-overlay" onclick="if(event.target===this)closeRef()">
  <div class="sheet">
    <div class="sheet-handle"></div>
    <div class="sheet-hdr">
      <div class="sheet-title">ğŸ”— ç´¹ä»‹ãƒªãƒ³ã‚¯ç™ºè¡Œ</div>
      <button class="sheet-close" onclick="closeRef()">âœ•</button>
    </div>
    <div class="sheet-body">
      <div style="font-size:11px;color:var(--sub);margin-bottom:14px;line-height:1.8">ã“ã®ãƒªãƒ³ã‚¯ã‹ã‚‰å…¥ä¼šã™ã‚‹ã¨ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ãŒè‡ªå‹•å…¥åŠ›ã•ã‚Œã¾ã™ã€‚</div>
      <div id="ref-code-selector"></div>
      <div style="font-size:10px;color:var(--muted);margin-bottom:4px;font-weight:600">ç™ºè¡Œãƒªãƒ³ã‚¯</div>
      <div class="ref-url" id="ref-url-display">â€”</div>
      <button class="copy-btn" onclick="copyRefLink()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
    </div>
  </div>
</div>

<script>
// â”€â”€ XSSã‚¨ã‚¹ã‚±ãƒ¼ãƒ— â”€â”€
function esc(s){if(s==null)return'';return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#x27;')}

// â•â• AUTH GUARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  var s=null;
  try{s=JSON.parse(sessionStorage.getItem('coreto_session')||'null');}catch(e){}
  if(!s||!s.userId||!s.type){sessionStorage.setItem('coreto_redirect',window.location.href);location.replace('coreto-sp-login.html');return;}
  if(!s.sessionToken||s.sessionToken.length!==64){sessionStorage.removeItem('coreto_session');location.replace('coreto-sp-login.html');return;}
  var _la=new Date(s.loginAt).getTime();
  if(isNaN(_la)||(Date.now()-_la)>28800000){sessionStorage.removeItem('coreto_session');alert('ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã¾ã—ãŸã€‚å†åº¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚');location.replace('coreto-sp-login.html');return;}
  window._SESSION=s;
})();

// â”€â”€ ã‚»ãƒƒã‚·ãƒ§ãƒ³ â”€â”€
const session=JSON.parse(sessionStorage.getItem('coreto_session')||'null')||{agId:'10012',name:'å±±ç”° èª ',rank:'Gold',rankKey:'gold',type:'re'};

// â”€â”€ ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ â”€â”€
const AGENT_DATA={
  '10012':{cases:3,rewardEstimate:847000,progress:72,progressLabel:'Gold â†’ Platinum ã¾ã§ 28%',
    cases_list:[{id:'CASE-0234',title:'æ± è¢‹ã‚¨ãƒªã‚¢ è³ƒè²¸ 1K',status:'active',statusLabel:'å…¥é‡‘å¾…ã¡',color:'#fb923c'},{id:'CASE-0228',title:'æ–°å®¿ã‚¨ãƒªã‚¢ è³ƒè²¸ 1LDK',status:'active',statusLabel:'å¥‘ç´„æ›¸é€ä»˜æ¸ˆã¿',color:'#34d399'},{id:'CASE-0220',title:'æ¸‹è°· å£²è²·ä»²ä»‹',status:'wait',statusLabel:'ITé‡èª¬èª¿æ•´ä¸­',color:'#4f9cf9'}],
    notifs:[{icon:'ğŸ’°',text:'CASE-0228 å…¨é¡å…¥é‡‘ãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€‚æˆç´„å ±å‘Šï¼ˆ/closeï¼‰ã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚',time:'10åˆ†å‰',isNew:true},{icon:'ğŸ“¦',text:'CASE-0234 ã®å¥‘ç´„æ›¸ãŒé…é”ã•ã‚Œã¾ã—ãŸã€‚',time:'2æ™‚é–“å‰',isNew:true},{icon:'ğŸ†',text:'ä»Šæœˆã®æˆç´„æ•°ãŒ3ä»¶ã«é”ã—ã¾ã—ãŸï¼',time:'æ˜¨æ—¥',isNew:false}],
    monthly:[{label:'10æœˆ',val:1},{label:'11æœˆ',val:2},{label:'12æœˆ',val:1},{label:'1æœˆ',val:2},{label:'2æœˆ',val:3}]},
  '10008':{cases:2,rewardEstimate:1250000,progress:90,progressLabel:'Platinum ç¶­æŒä¸­',
    cases_list:[{id:'CASE-0230',title:'ä¸­é‡ è³ƒè²¸ 1K',status:'active',statusLabel:'ç”³è¾¼å¯©æŸ»ä¸­',color:'#4f9cf9'},{id:'CASE-0218',title:'ä»£ã€…æœ¨ å£²è²·',status:'wait',statusLabel:'å¥‘ç´„æ›¸åˆ°ç€å¾…ã¡',color:'#fb923c'}],
    notifs:[{icon:'ğŸ“©',text:'ç®¡ç†ä¼šç¤¾ã‹ã‚‰æ›¸é¡ãŒå±Šã„ã¦ã„ã¾ã™ã€‚ç¢ºèªã—ã¦ãã ã•ã„ã€‚',time:'1æ™‚é–“å‰',isNew:true},{icon:'ğŸ’°',text:'2æœˆåˆ† æŒ¯è¾¼å®Œäº† Â¥980,500',time:'2æ—¥å‰',isNew:false}],
    monthly:[{label:'10æœˆ',val:2},{label:'11æœˆ',val:3},{label:'12æœˆ',val:2},{label:'1æœˆ',val:3},{label:'2æœˆ',val:2}]},
  '20005':{cases:1,rewardEstimate:382000,progress:45,progressLabel:'Gold â†’ Platinum ã¾ã§ 55%',
    cases_list:[{id:'CASE-0231',title:'ITã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ è»¢è·æ”¯æ´',status:'draft',statusLabel:'é¢æ¥èª¿æ•´ä¸­',color:'#4f9cf9'}],
    notifs:[{icon:'ğŸ‘¥',text:'CASE-0231 å€™è£œè€…ã‹ã‚‰é€£çµ¡ãŒæ¥ã¦ã„ã¾ã™ã€‚',time:'30åˆ†å‰',isNew:true},{icon:'ğŸ’°',text:'1æœˆåˆ† ç¬¬2å›æ‰•ã„ Â¥187,500 æŒ¯è¾¼å®Œäº†',time:'1é€±é–“å‰',isNew:false}],
    monthly:[{label:'10æœˆ',val:1},{label:'11æœˆ',val:0},{label:'12æœˆ',val:1},{label:'1æœˆ',val:1},{label:'2æœˆ',val:1}]},
  '10023':{cases:1,rewardEstimate:226000,progress:30,progressLabel:'Silver â†’ Gold ã¾ã§ 70%',
    cases_list:[{id:'CASE-0236',title:'è±Šå³¶åŒº è³ƒè²¸ 1LDK',status:'draft',statusLabel:'ç‰©ä»¶æ¢ã—ä¸­',color:'#4f9cf9'}],
    notifs:[{icon:'ğŸ“‹',text:'æ–°ã—ã„æ¡ˆä»¶ãŒãƒœãƒ¼ãƒ‰ã«æ²è¼‰ã•ã‚Œã¾ã—ãŸï¼ˆæ± è¢‹ã‚¨ãƒªã‚¢ï¼‰ã€‚',time:'1æ™‚é–“å‰',isNew:true}],
    monthly:[{label:'10æœˆ',val:0},{label:'11æœˆ',val:1},{label:'12æœˆ',val:0},{label:'1æœˆ',val:1},{label:'2æœˆ',val:1}]},
  '30007':{cases:2,rewardEstimate:156000,progress:0,progressLabel:'ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼',
    cases_list:[{id:'CASE-0234',title:'ç´¹ä»‹æ¡ˆä»¶ï¼šæ± è¢‹ã‚¨ãƒªã‚¢è³ƒè²¸',status:'active',statusLabel:'ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå¯¾å¿œä¸­',color:'#34d399'},{id:'CASE-0235',title:'ç´¹ä»‹æ¡ˆä»¶ï¼šæ–°å®¿ã‚¨ãƒªã‚¢è³ƒè²¸',status:'wait',statusLabel:'ãƒãƒƒãƒãƒ³ã‚°å¾…ã¡',color:'#fb923c'}],
    notifs:[{icon:'ğŸ‰',text:'CASE-0228 ãŒæˆç´„ã—ã¾ã—ãŸï¼ç´¹ä»‹å ±é…¬ Â¥78,000 ãŒç¢ºå®šã—ã¾ã—ãŸã€‚',time:'1æ—¥å‰',isNew:true}],
    monthly:[{label:'10æœˆ',val:1},{label:'11æœˆ',val:2},{label:'12æœˆ',val:1},{label:'1æœˆ',val:3},{label:'2æœˆ',val:2}]},
};

// â”€â”€ ãƒ„ãƒ¼ãƒ«å®šç¾© â”€â”€
const TOOLS={
  re:[
    {id:'matching',icon:'ğŸ“‹',title:'æ¡ˆä»¶ãƒœãƒ¼ãƒ‰',     desc:'æ–°è¦æ¡ˆä»¶ãƒ»ãƒãƒƒãƒãƒ³ã‚°ç¢ºèª',     color:'blue',   url:'coreto-matching.html'},
    {id:'close',   icon:'ğŸ¯',title:'æˆç´„å ±å‘Š',        desc:'å¯©æŸ»é€šéâ†’å…¥é‡‘ç¢ºèªå¾Œã«é€ä¿¡',     color:'primary',url:'coreto-batch-close.html'},
    {id:'naiken',  icon:'ğŸ ',title:'å†…è¦‹ä¾é ¼æ›¸',      desc:'FAXé€ä»˜ãƒ»æ—¥ç¨‹ç™»éŒ²',            color:'green',  url:'coreto-naiken.html'},
    {id:'it-setsu',icon:'ğŸ“',title:'ITé‡èª¬ãƒ»å¥‘ç´„æ›¸',  desc:'ITé‡èª¬ãƒã‚§ãƒƒã‚¯ãƒ»ã‚¹ã‚­ãƒ£ãƒ³ç®¡ç†', color:'blue',   url:'coreto-it-setsu.html'},
    {id:'client',  icon:'ğŸ‘¤',title:'é¡§å®¢DB',          desc:'é¡§å®¢ç™»éŒ²ãƒ»ç›¸è«‡å±¥æ­´ç¢ºèª',       color:'orange', url:'coreto-client-id.html'},
    {id:'rank',    icon:'â­',title:'ãƒ©ãƒ³ã‚¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',desc:'ãƒã‚¤ãƒ³ãƒˆãƒ»å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',color:'',      url:'coreto-rank.html'},
    {id:'payment', icon:'ğŸ’´',title:'æ”¯æ‰•æ˜ç´°æ›¸',      desc:'æœˆæ¬¡å ±é…¬æ˜ç´°ã®ç¢ºèª',           color:'',       url:'coreto-payment.html'},
    {id:'sim',     icon:'ğŸ’°',title:'å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',desc:'æ‰‹å–ã‚Šé¡ã‚’äº‹å‰ç¢ºèª',          color:'',       url:'coreto-commission-simulator.html'},
  ],
  hr:[
    {id:'matching',   icon:'ğŸ“‹',title:'æ¡ˆä»¶ãƒœãƒ¼ãƒ‰',        desc:'æ–°è¦æ¡ˆä»¶ãƒ»ãƒãƒƒãƒãƒ³ã‚°ç¢ºèª',  color:'blue',   url:'coreto-matching.html'},
    {id:'close',      icon:'ğŸ¯',title:'æˆç´„å ±å‘Š',          desc:'å…¥ç¤¾ç¢ºå®šå¾Œã«é€ä¿¡',          color:'primary',url:'coreto-batch-close.html'},
    {id:'early-quit', icon:'âš ï¸',title:'æ—©æœŸé€€è·ç®¡ç†',      desc:'è¿”é‡‘æ¡ä»¶ç™»éŒ²ãƒ»é€€è·å ±å‘Š',   color:'',       url:'coreto-early-quit.html'},
    {id:'client',     icon:'ğŸ‘¤',title:'é¡§å®¢DB',            desc:'æ±‚è·è€…æƒ…å ±ãƒ»é¢æ¥å±¥æ­´',     color:'orange', url:'coreto-client-id.html'},
    {id:'rank',       icon:'â­',title:'ãƒ©ãƒ³ã‚¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',desc:'ãƒã‚¤ãƒ³ãƒˆãƒ»å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',color:'',   url:'coreto-rank.html'},
    {id:'payment',    icon:'ğŸ’´',title:'æ”¯æ‰•æ˜ç´°æ›¸',        desc:'æœˆæ¬¡å ±é…¬æ˜ç´°ã®ç¢ºèª',       color:'',       url:'coreto-payment.html'},
    {id:'sim',        icon:'ğŸ’°',title:'å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',desc:'2å›æ‰•ã„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª',  color:'',       url:'coreto-commission-simulator.html'},
  ],
  pt:[
    {id:'portal',  icon:'ğŸ ',title:'ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ãƒãƒ¼ã‚¿ãƒ«',desc:'ç´¹ä»‹æ¡ˆä»¶ãƒ»å ±é…¬ãƒ»ã‚³ãƒ¼ãƒ‰ã®ç¢ºèª',color:'primary',url:'coreto-partner.html'},
    {id:'matching',icon:'ğŸ“‹',title:'æ¡ˆä»¶ãƒœãƒ¼ãƒ‰',        desc:'ç´¹ä»‹æ¡ˆä»¶ã®é€²æ—ç¢ºèª',         color:'blue',   url:'coreto-matching.html'},
    {id:'rank',    icon:'â­',title:'ãƒ©ãƒ³ã‚¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',desc:'ãƒã‚¤ãƒ³ãƒˆãƒ»å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',color:'',    url:'coreto-rank.html'},
    {id:'payment', icon:'ğŸ’´',title:'æ”¯æ‰•æ˜ç´°æ›¸',        desc:'æœˆæ¬¡å ±é…¬æ˜ç´°ã®ç¢ºèª',         color:'',       url:'coreto-payment.html'},
    {id:'sim',     icon:'ğŸ’°',title:'å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',desc:'ç´¹ä»‹å ±é…¬é¡ã‚’ç¢ºèª',           color:'',       url:'coreto-commission-simulator.html'},
  ],
};

// â”€â”€ ãƒŠãƒ“å®šç¾© â”€â”€
const NAVS={
  re:[
    {icon:'ğŸ ',label:'ãƒ›ãƒ¼ãƒ ',   id:'home',  url:null},
    {icon:'ğŸ“‹',label:'æ¡ˆä»¶',     id:'cases', url:'coreto-matching.html'},
    {icon:'ğŸ“',label:'ITé‡èª¬',   id:'itsetsu',url:'coreto-it-setsu.html'},
    {icon:'ğŸ’¸',label:'å³æ™‚æ‰•ã„', id:'pay',   url:'coreto-instant-pay.html'},
    {icon:'âš™ï¸',label:'è¨­å®š',     id:'acct',  url:'coreto-account-settings.html'},
  ],
  hr:[
    {icon:'ğŸ ',label:'ãƒ›ãƒ¼ãƒ ',   id:'home',  url:null},
    {icon:'ğŸ“‹',label:'æ¡ˆä»¶',     id:'cases', url:'coreto-matching.html'},
    {icon:'âš ï¸',label:'æ—©æœŸé€€è·', id:'eq',    url:'coreto-early-quit.html'},
    {icon:'ğŸ’¸',label:'å³æ™‚æ‰•ã„', id:'pay',   url:'coreto-instant-pay.html'},
    {icon:'âš™ï¸',label:'è¨­å®š',     id:'acct',  url:'coreto-account-settings.html'},
  ],
  pt:[
    {icon:'ğŸ ',label:'ãƒ›ãƒ¼ãƒ ',   id:'home',  url:null},
    {icon:'ğŸ“‹',label:'æ¡ˆä»¶',     id:'cases', url:'coreto-matching.html'},
    {icon:'ğŸ”—',label:'ç´¹ä»‹',     id:'ref',   url:null,action:'openRef'},
    {icon:'ğŸ’°',label:'å ±é…¬',     id:'reward',url:'coreto-partner.html'},
    {icon:'âš™ï¸',label:'è¨­å®š',     id:'acct',  url:'coreto-account-settings.html'},
  ],
};

const RANK_BADGE_CLASS={gold:'rb-gold',platinum:'rb-platinum',silver:'rb-silver',bronze:'rb-bronze',pt:'rb-pt'};
const TYPE_LABEL={re:'ä¸å‹•ç”£ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ',hr:'äººæã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ',pt:'ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼'};
const AVATAR_ICON={re:'ğŸ ',hr:'ğŸ‘¥',pt:'ğŸ¤'};
const MENU_ITEMS={
  re:[
    {icon:'ğŸ“‹',title:'æ¡ˆä»¶ãƒœãƒ¼ãƒ‰',sub:'ãƒãƒƒãƒãƒ³ã‚°ãƒ»æ¡ˆä»¶ç¢ºèª',url:'coreto-matching.html'},
    {icon:'ğŸ¯',title:'æˆç´„å ±å‘Š',sub:'å¯©æŸ»é€šéâ†’å…¥é‡‘ç¢ºèªå¾Œ',url:'coreto-batch-close.html'},
    {icon:'ğŸ ',title:'å†…è¦‹ä¾é ¼æ›¸',sub:'FAXé€ä»˜ãƒ»æ—¥ç¨‹ç™»éŒ²',url:'coreto-naiken.html'},
    {icon:'ğŸ“',title:'ITé‡èª¬ãƒ»å¥‘ç´„æ›¸',sub:'é‡èª¬ãƒã‚§ãƒƒã‚¯ãƒ»ã‚¹ã‚­ãƒ£ãƒ³ç®¡ç†',url:'coreto-it-setsu.html'},
    {icon:'â­',title:'ãƒ©ãƒ³ã‚¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',sub:'ãƒã‚¤ãƒ³ãƒˆãƒ»å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',url:'coreto-rank.html'},
    {icon:'ğŸ’´',title:'æ”¯æ‰•æ˜ç´°æ›¸',sub:'æœˆæ¬¡å ±é…¬æ˜ç´°',url:'coreto-payment.html'},
    {icon:'ğŸ’°',title:'å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',sub:'æ‰‹å–ã‚Šé¡ã‚’äº‹å‰ç¢ºèª',url:'coreto-commission-simulator.html'},
    {icon:'ğŸ“…',title:'ITé‡èª¬ æ—¥ç¨‹äºˆç´„',sub:'äºˆç´„ã‚¹ãƒ­ãƒƒãƒˆç®¡ç†',url:'coreto-itsetsu-booking.html'},
    {icon:'ğŸ§¾',title:'é ˜åæ›¸ãƒ»è«‹æ±‚æ›¸',sub:'ç™ºè¡Œãƒ»ç®¡ç†',url:'coreto-receipt.html'},
    {icon:'ğŸ‘¤',title:'é¡§å®¢DB',sub:'é¡§å®¢ç™»éŒ²ãƒ»ç›¸è«‡å±¥æ­´',url:'coreto-client-id.html'},
    {icon:'âš™ï¸',title:'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š',sub:'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ»å£åº§',url:'coreto-account-settings.html'},
    {icon:'â“',title:'FAQ',sub:'ã‚ˆãã‚ã‚‹è³ªå•',url:'coreto-faq.html'},
    {icon:'ğŸ“š',title:'ç ”ä¿®ãƒ»ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°',sub:'ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãƒ»ãƒ«ãƒ¼ãƒ«',url:'coreto-onboarding.html'},
    {icon:'ğŸ”',title:'æœ¬äººç¢ºèªãƒ»å£åº§',sub:'KYCãƒ»æŒ¯è¾¼å…ˆç®¡ç†',url:'coreto-kyc.html'},
  ],
  hr:[
    {icon:'ğŸ“‹',title:'æ¡ˆä»¶ãƒœãƒ¼ãƒ‰',sub:'ãƒãƒƒãƒãƒ³ã‚°ãƒ»æ¡ˆä»¶ç¢ºèª',url:'coreto-matching.html'},
    {icon:'ğŸ¯',title:'æˆç´„å ±å‘Š',sub:'å…¥ç¤¾ç¢ºå®šå¾Œã«é€ä¿¡',url:'coreto-batch-close.html'},
    {icon:'âš ï¸',title:'æ—©æœŸé€€è·ç®¡ç†',sub:'è¿”é‡‘æ¡ä»¶ãƒ»é€€è·å ±å‘Š',url:'coreto-early-quit.html'},
    {icon:'â­',title:'ãƒ©ãƒ³ã‚¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',sub:'ãƒã‚¤ãƒ³ãƒˆãƒ»å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',url:'coreto-rank.html'},
    {icon:'ğŸ’´',title:'æ”¯æ‰•æ˜ç´°æ›¸',sub:'æœˆæ¬¡å ±é…¬æ˜ç´°',url:'coreto-payment.html'},
    {icon:'ğŸ’°',title:'å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',sub:'2å›æ‰•ã„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª',url:'coreto-commission-simulator.html'},
    {icon:'âš™ï¸',title:'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š',sub:'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ»å£åº§',url:'coreto-account-settings.html'},
    {icon:'â“',title:'FAQ',sub:'ã‚ˆãã‚ã‚‹è³ªå•',url:'coreto-faq.html'},
  ],
  pt:[
    {icon:'ğŸ ',title:'ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ãƒãƒ¼ã‚¿ãƒ«',sub:'ç´¹ä»‹æ¡ˆä»¶ãƒ»å ±é…¬ãƒ»ã‚³ãƒ¼ãƒ‰',url:'coreto-partner.html'},
    {icon:'ğŸ“‹',title:'æ¡ˆä»¶ãƒœãƒ¼ãƒ‰',sub:'ç´¹ä»‹æ¡ˆä»¶ã®é€²æ—ç¢ºèª',url:'coreto-matching.html'},
    {icon:'â­',title:'ãƒ©ãƒ³ã‚¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',sub:'ãƒã‚¤ãƒ³ãƒˆãƒ»å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',url:'coreto-rank.html'},
    {icon:'ğŸ’´',title:'æ”¯æ‰•æ˜ç´°æ›¸',sub:'æœˆæ¬¡å ±é…¬æ˜ç´°',url:'coreto-payment.html'},
    {icon:'ğŸ’°',title:'å ±é…¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼',sub:'ç´¹ä»‹å ±é…¬é¡ã‚’ç¢ºèª',url:'coreto-commission-simulator.html'},
    {icon:'âš™ï¸',title:'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š',sub:'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ»å£åº§',url:'coreto-account-settings.html'},
  ],
};

// â”€â”€ åˆæœŸåŒ– â”€â”€
let _bcAgent=null;
function init(){
  const ag=session;
  const data=AGENT_DATA[ag.agId]||AGENT_DATA['10012'];

  document.getElementById('hdr-name').textContent=ag.name;
  document.getElementById('hdr-id').textContent='ID: '+(ag.agId||'â€”');

  // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
  document.getElementById('avatar').textContent=AVATAR_ICON[ag.type]||'ğŸ‘¤';
  document.getElementById('profile-name').textContent=ag.name+' æ§˜';
  document.getElementById('profile-id').textContent=ag.agId;
  const rb=document.getElementById('rank-badge');
  rb.textContent=ag.rank;
  rb.className='rank-badge '+(RANK_BADGE_CLASS[ag.rankKey]||'rb-gold');
  document.getElementById('ps-cases').textContent=data.cases+'ä»¶';
  document.getElementById('ps-reward').textContent='Â¥'+data.rewardEstimate.toLocaleString();
  document.getElementById('perf-cases').textContent=data.cases;
  document.getElementById('perf-reward').textContent='Â¥'+Math.floor(data.rewardEstimate*.85).toLocaleString();

  if(ag.type==='pt'){
    document.getElementById('rp-wrap').style.display='none';
  }else{
    document.getElementById('rp-lbl').textContent=data.progressLabel;
    document.getElementById('rp-fill').style.width=data.progress+'%';
  }

  renderActions(ag.type);
  renderCases(data.cases_list);
  renderNotifs(data.notifs);
  renderChart(data.monthly);
  renderNav(ag.type);
  renderMenu(ag.type);
  initBc(ag);
  _bcAgent=ag;

  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°éè¡¨ç¤º
  document.getElementById('loading-overlay').classList.remove('show');
}

function renderActions(type){
  const tools=TOOLS[type]||TOOLS['re'];
  document.getElementById('action-grid').innerHTML=tools.map(t=>`
    <div class="ac ${t.color}" onclick="goto('${t.url}')">
      ${t.id==='close'?'<span class="ac-badge">è¦å¯¾å¿œ</span>':''}
      <div class="ac-icon">${t.icon}</div>
      <div><div class="ac-title">${t.title}</div><div class="ac-desc">${t.desc}</div></div>
    </div>`).join('');
}

function renderCases(list){
  if(!list.length){
    document.getElementById('cases-list').innerHTML='<div style="text-align:center;padding:20px;color:var(--muted);font-size:12px">é€²è¡Œä¸­ã®æ¡ˆä»¶ã¯ã‚ã‚Šã¾ã›ã‚“</div>';
    return;
  }
  document.getElementById('cases-list').innerHTML=list.map(c=>`
    <div class="case-item" onclick="goto('coreto-matching.html')">
      <div class="ci-dot" style="background:${c.color}"></div>
      <div class="ci-info"><div class="ci-title">${esc(c.title)}</div><div class="ci-meta">${c.id}</div></div>
      <div class="ci-status s-${c.status}">${esc(c.statusLabel)}</div>
    </div>`).join('');
}

function renderNotifs(list){
  const newCount=list.filter(n=>n.isNew).length;
  const dot=document.getElementById('notif-dot');
  if(newCount>0){dot.style.display='block';}
  const navBadge=document.getElementById('nav-notif-badge');
  if(navBadge&&newCount>0)navBadge.textContent=newCount;
  document.getElementById('notif-body').innerHTML=list.map(n=>`
    <div class="notif-item">
      <div class="ni-icon">${n.icon}</div>
      <div class="ni-body"><div class="ni-text">${esc(n.text)}</div><div class="ni-time">${n.time}</div></div>
      ${n.isNew?'<div class="ni-new"></div>':''}
    </div>`).join('');
}

function renderChart(monthly){
  const max=Math.max(...monthly.map(m=>m.val),1);
  document.getElementById('bar-chart').innerHTML=monthly.map(m=>`
    <div class="bar-row">
      <div class="bar-lbl">${m.label}</div>
      <div class="bar-wrap"><div class="bar-fill" style="width:${Math.round(m.val/max*100)}%"></div></div>
      <div class="bar-val">${m.val}ä»¶</div>
    </div>`).join('');
}

function renderNav(type){
  const items=NAVS[type]||NAVS['re'];
  document.getElementById('bottom-nav').innerHTML=items.map(n=>`
    <div class="nav-item ${n.id==='home'?'on':''}"
         onclick="${n.action?n.action+'()':n.url?'goto(\''+n.url+'\')':''}"
         id="nav-${n.id}">
      <span class="nav-icon">${n.icon}</span>
      <span class="nav-lbl">${n.label}</span>
    </div>`).join('');
}

function renderMenu(type){
  const items=MENU_ITEMS[type]||MENU_ITEMS['re'];
  document.getElementById('menu-list').innerHTML=items.map(m=>`
    <div class="menu-item" onclick="goto('${m.url}')">
      <span class="menu-icon">${m.icon}</span>
      <div class="menu-info"><div class="menu-title">${m.title}</div><div class="menu-sub">${m.sub}</div></div>
      <span class="menu-arrow">â€º</span>
    </div>`).join('');
}

function goto(url){if(url)window.location.href=url;}

// â”€â”€ ãƒ‘ãƒãƒ«é–‹é–‰ â”€â”€
function openNotif(){document.getElementById('notif-overlay').classList.add('show');document.getElementById('notif-dot').style.display='none';}
function closeNotif(){document.getElementById('notif-overlay').classList.remove('show');}
function openBc(){document.getElementById('bc-overlay').classList.add('show');}
function closeBc(){document.getElementById('bc-overlay').classList.remove('show');}
function openMenu(){document.getElementById('menu-overlay').classList.add('show');}
function closeMenu(){document.getElementById('menu-overlay').classList.remove('show');}
function openRef(){
  closeMenu();
  const ov=document.getElementById('ref-overlay');
  const ag=session;
  const isExec=ag&&ag.hqRole==='exec';
  const agId=ag&&ag.agId?ag.agId:'10012';
  if(isExec){
    const SPECIAL=['FOUNDER2026','WELCOME2026','GOLD_START','HR_PRO75'];
    document.getElementById('ref-code-selector').innerHTML=
      '<div style="margin-bottom:12px"><div style="font-size:10px;color:var(--sub);font-weight:600;margin-bottom:5px">ã‚³ãƒ¼ãƒ‰ç¨®åˆ¥</div>'
      +'<select id="ref-code-select" onchange="updateRefLink()" style="width:100%;padding:10px 12px;background:var(--card2);border:1px solid var(--border2);border-radius:10px;color:var(--text);font-size:14px">'
      +'<option value="'+agId+'">è‡ªåˆ†ã®IDï¼ˆ'+agId+'ï¼‰</option>'
      +'<optgroup label="â”€â”€ ç‰¹åˆ¥ã‚³ãƒ¼ãƒ‰ â”€â”€">'+SPECIAL.map(c=>'<option value="'+c+'">â­ '+c+'</option>').join('')+'</optgroup>'
      +'</select></div>';
  }else{
    document.getElementById('ref-code-selector').innerHTML=
      '<div style="display:flex;align-items:center;gap:8px;margin-bottom:12px;padding:9px 12px;background:rgba(201,168,76,.06);border:1px solid rgba(201,168,76,.2);border-radius:9px">'
      +'<span style="font-size:11px;color:var(--muted)">ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ï¼š</span>'
      +'<span style="font-family:\'DM Mono\',monospace;font-size:14px;font-weight:700;color:var(--gold)">'+agId+'</span>'
      +'</div>';
  }
  updateRefLink();
  ov.classList.add('show');
}
function closeRef(){document.getElementById('ref-overlay').classList.remove('show');}
var _refCode='';
function updateRefLink(){
  const sel=document.getElementById('ref-code-select');
  if(sel)_refCode=sel.value;else _refCode=(session&&session.agId)||'10012';
  const base=location.origin+location.pathname.replace(/[^\/]*$/,'')+'/coreto-agent-signup.html';
  document.getElementById('ref-url-display').textContent=base+'?ref='+encodeURIComponent(_refCode);
}
function copyRefLink(){
  const url=document.getElementById('ref-url-display').textContent;
  navigator.clipboard.writeText(url).then(function(){
    const btn=document.querySelector('.copy-btn');
    btn.textContent='âœ… ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ';
    setTimeout(function(){btn.textContent='ğŸ“‹ ã‚³ãƒ”ãƒ¼';},2000);
  }).catch(function(){
    const ta=document.createElement('textarea');ta.value=url;document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);
  });
}

// â”€â”€ ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ â”€â”€
function doLogout(){
  closeMenu();
  if(confirm('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã™ã‹ï¼Ÿ')){
    sessionStorage.removeItem('coreto_session');
    location.href='coreto-sp-login.html';
  }
}

// â”€â”€ ååˆº â”€â”€
function initBc(ag){
  const nameEl=document.getElementById('bc-name');
  const kanaEl=document.getElementById('bc-kana');
  const contactEl=document.getElementById('bc-contact');
  const nameDisplay=ag.nameOld&&ag.showOldOnCard?ag.name.split(' ')[0]+'ï¼ˆæ—§å§“ï¼š'+ag.nameOld+'ï¼‰'+(ag.name.split(' ')[1]||''):(ag.name||'â€”');
  if(nameEl)nameEl.textContent=nameDisplay;
  if(kanaEl)kanaEl.textContent=ag.nameKana||'â€”';
  if(contactEl)contactEl.innerHTML=(ag.phone||'â€”')+'<br>'+(ag.email||'â€”');
}
function updateBcPreview(){
  const hasTakken=document.getElementById('bc-takken').checked;
  const badge=document.getElementById('bc-takken-badge');
  const title=document.getElementById('bc-takken-title');
  if(badge)badge.style.display=hasTakken?'inline-flex':'none';
  if(title)title.style.display=hasTakken?'block':'none';
}
function getBcData(){
  const ag=_bcAgent||{};
  const hasTakken=(document.getElementById('bc-takken')||{}).checked||false;
  const note=(document.getElementById('bc-note')||{}).value||'';
  const nameMain=ag.nameOld&&ag.showOldOnCard?ag.name.split(' ')[0]+'ï¼ˆæ—§å§“ï¼š'+ag.nameOld+'ï¼‰'+(ag.name.split(' ')[1]||''):(ag.name||'â€”');
  return{nameMain,nameKana:ag.nameKana||'â€”',phone:ag.phone||'â€”',email:ag.email||'â€”',agentId:ag.agId||'â€”',hasTakken,note,company:'æ ªå¼ä¼šç¤¾CORETO',address:'æ±äº¬éƒ½æ¸‹è°·åŒºæµæ¯”å¯¿1-1-1 COREBLDGãƒ“ãƒ«8F',url:'https://coreto.jp'};
}
function previewBcPdf(){
  const d=getBcData();
  const html=`<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ååˆº â€” ${d.nameMain}</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
<style>*{margin:0;padding:0;box-sizing:border-box}html,body{background:#f0f0f0;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;font-family:'Noto Sans JP',sans-serif}.card-wrap{background:white;width:91mm;height:55mm;border-radius:1.5mm;box-shadow:0 4px 24px rgba(0,0,0,.2);position:relative;display:flex;overflow:hidden}.card-accent{width:3mm;height:100%;background:linear-gradient(180deg,#c9a84c,#7a5f22);flex-shrink:0}.card-body{flex:1;padding:5mm 5mm 5mm 4mm;display:flex;flex-direction:column;justify-content:space-between}.card-top{display:flex;align-items:center;justify-content:space-between}.card-logo{font-size:10pt;font-weight:800;letter-spacing:3px;color:#c9a84c}.card-id{font-size:6pt;color:#aaa;font-family:monospace;border:0.3mm solid #ddd;padding:1mm 2mm;border-radius:.5mm}.card-center{flex:1;display:flex;flex-direction:column;justify-content:center;padding:2mm 0}.card-takken{font-size:6.5pt;color:#c9a84c;font-weight:700;margin-bottom:2mm}.card-name{font-size:16pt;font-weight:700;color:#1a1a1a;margin-bottom:1mm}.card-kana{font-size:7pt;color:#888;letter-spacing:1.5px;font-family:monospace}.card-bottom{font-size:7pt;color:#555;line-height:1.8}.card-co{font-size:6.5pt;color:#999;margin-bottom:.5mm}.divider{width:100%;height:.2mm;background:#eee;margin:1mm 0}.controls{text-align:center;margin:16px}.cb-btn{padding:10px 24px;background:#c9a84c;color:#0a0c10;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer;margin-right:8px}@media print{@page{size:91mm 55mm;margin:0}html,body{width:91mm;height:55mm;display:block;background:white}.controls{display:none}.card-wrap{box-shadow:none;border-radius:0}}</style></head><body>
<div class="controls"><button class="cb-btn" onclick="window.print()">ğŸ“„ PDFã¨ã—ã¦ä¿å­˜</button><button onclick="window.close()" style="padding:10px 16px;border:1px solid #ccc;border-radius:8px;font-size:12px;cursor:pointer">é–‰ã˜ã‚‹</button></div>
<div class="card-wrap"><div class="card-accent"></div><div class="card-body">
<div class="card-top"><div class="card-logo">CORETO</div><div class="card-id">ID: ${d.agentId}</div></div>
<div class="card-center">${d.hasTakken?'<div class="card-takken">å®…åœ°å»ºç‰©å–å¼•å£«</div>':''}<div class="card-name">${d.nameMain}</div><div class="card-kana">${d.nameKana}</div></div>
<div><div class="divider"></div><div class="card-co">${d.company}</div><div class="card-bottom">ğŸ“± ${d.phone}<br>âœ‰ ${d.email}</div>${d.note?'<div style="font-size:6pt;color:#999;margin-top:2mm">'+d.note+'</div>':''}</div>
</div></div></body></html>`;
  const w=window.open('','_blank','width=700,height=580');w.document.write(html);w.document.close();
}
function sendToSlack(){
  const d=getBcData();
  const msg=['â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”','ğŸªª *ååˆºç™ºæ³¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆ*','â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”','ğŸ‘¤ *æ°å*ï¼š'+d.nameMain,'ã€€ã€€ã‚«ãƒŠï¼š'+d.nameKana,'ğŸªª *ID*ï¼š'+d.agentId,'ğŸ“± *é›»è©±ç•ªå·*ï¼š'+d.phone,'âœ‰ï¸ *ãƒ¡ãƒ¼ãƒ«*ï¼š'+d.email,'ğŸ› *å®…åœ°å»ºç‰©å–å¼•å£«*ï¼š'+(d.hasTakken?'âœ… ã‚ã‚Š':'âŒ ãªã—'),d.note?'ğŸ“ *ç‰¹è¨˜äº‹é …*ï¼š'+d.note:null,'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”','ğŸ’³ Â¥2,000 ã‚«ãƒ¼ãƒ‰æ±ºæ¸ˆå®Œäº†','ğŸ• '+new Date().toLocaleString('ja-JP')].filter(Boolean).join('\n');
  alert('âœ… Slackã«ååˆºç™ºæ³¨æƒ…å ±ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚\n\n'+msg.replace(/\*/g,'')+'\n\nï¼ˆæœ¬éƒ¨Slackã® #ååˆºç™ºæ³¨ ãƒãƒ£ãƒ³ãƒãƒ«ã«æŠ•ç¨¿ã•ã‚Œã¾ã—ãŸï¼‰');
}
function orderBusinessCard(){
  const btn=document.getElementById('bc-order-btn');
  if(!confirm('ååˆºã‚’ç™ºæ³¨ã—ã¾ã™ã‹ï¼Ÿ\n\nç™»éŒ²ã‚«ãƒ¼ãƒ‰ï¼ˆVisa Â·Â·Â·4242ï¼‰ã‚ˆã‚Š Â¥2,000 ãŒå³æ™‚æ±ºæ¸ˆã•ã‚Œã¾ã™ã€‚\nç™ºæ³¨å¾Œã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã¯ã§ãã¾ã›ã‚“ã€‚'))return;
  btn.disabled=true;btn.textContent='â³ æ±ºæ¸ˆä¸­...';
  setTimeout(()=>{
    btn.textContent='âœ… ç™ºæ³¨å®Œäº†';
    btn.style.background='rgba(52,211,153,.15)';
    btn.style.border='1px solid rgba(52,211,153,.3)';
    btn.style.color='var(--green)';
    const hist=document.getElementById('bc-history');
    if(hist){
      const now=new Date().toLocaleDateString('ja-JP',{year:'numeric',month:'2-digit',day:'2-digit'});
      const note=(document.getElementById('bc-note')||{}).value||'';
      const hasTakken=(document.getElementById('bc-takken')||{}).checked||false;
      const row=document.createElement('div');
      row.className='bc-hist-item';
      row.innerHTML='<div><div style="font-weight:700">'+now+' ç™ºæ³¨</div><div style="color:var(--muted);font-size:10px">100æš / '+(note||'é€šå¸¸')+(hasTakken?'ãƒ»å®…å»ºå£«è¡¨è¨˜':'')+'</div></div><div style="text-align:right"><div style="font-family:\'DM Mono\',monospace;color:var(--red)">-Â¥2,000</div><span style="font-size:8px;padding:2px 6px;border-radius:4px;background:rgba(251,146,60,.12);color:var(--orange);font-weight:700">åˆ¶ä½œä¸­</span></div>';
      hist.insertBefore(row,hist.firstChild);
    }
    sendToSlack();
  },1400);
}

// â”€â”€ Slackè¨­å®š â”€â”€
var SLACK_WEBHOOK=window.SLACK_CONFIG?window.SLACK_CONFIG.GENERAL:'YOUR_SLACK_WEBHOOK_URL';
function notifySlack(msg){if(!SLACK_WEBHOOK||SLACK_WEBHOOK==='YOUR_SLACK_WEBHOOK_URL'){console.log('[Slackæœªè¨­å®š]',msg);return;}fetch(SLACK_WEBHOOK,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text:msg}),mode:'no-cors'}).catch(e=>console.error('[Slacké€ä¿¡ã‚¨ãƒ©ãƒ¼]',e));}

// ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã—ã¦èµ·å‹•
document.getElementById('loading-overlay').classList.add('show');
window.addEventListener('DOMContentLoaded',function(){setTimeout(init,50);});
</script>
</body>
</html>
