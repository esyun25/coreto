<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CORETO â€” ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=DM+Mono:wght@400;500&family=Syne:wght@700;800&display=swap');
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#07090f;--card:#0f1119;--card2:#141720;--border:#1e2235;--border2:#252a3d;
  --gold:#c9a84c;--gold-dim:#7a5f22;--gold-bg:rgba(201,168,76,.07);
  --blue:#4f9cf9;--green:#34d399;--red:#f87171;--orange:#fb923c;--purple:#a78bfa;
  --muted:#4a5270;--sub:#7a849e;--text:#e2e6f3;
}
html,body{height:100%;font-family:'Noto Sans JP',sans-serif;background:var(--bg);color:var(--text)}
/* â”€â”€ Header â”€â”€ */
.hdr{height:54px;display:flex;align-items:center;justify-content:space-between;
  padding:0 26px;border-bottom:1px solid var(--border);background:rgba(7,9,15,.95);
  position:sticky;top:0;z-index:100}
.logo{font-family:'Syne',sans-serif;font-size:17px;font-weight:800;color:var(--gold);letter-spacing:3px}
/* â”€â”€ Layout â”€â”€ */
.layout{display:flex;height:calc(100vh - 54px)}
/* â”€â”€ Sidebar â”€â”€ */
.sidebar{width:220px;flex-shrink:0;border-right:1px solid var(--border);
  background:var(--card);overflow-y:auto;padding:16px 0}
.sb-section{font-size:8px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;
  padding:14px 18px 6px}
.sb-item{display:flex;align-items:center;gap:10px;padding:9px 18px;font-size:12px;
  cursor:pointer;color:var(--sub);transition:.15s;border-left:2px solid transparent}
.sb-item:hover{color:var(--text);background:rgba(255,255,255,.025)}
.sb-item.on{color:var(--blue);background:rgba(79,156,249,.07);border-left-color:var(--blue)}
.sb-icon{font-size:16px;width:20px;text-align:center}
/* â”€â”€ Main â”€â”€ */
.main{flex:1;overflow-y:auto;padding:28px 32px 80px}
.page-title{font-family:'Syne',sans-serif;font-size:17px;font-weight:800;margin-bottom:4px}
.page-sub{font-size:11px;color:var(--sub);margin-bottom:24px}
/* â”€â”€ Cards â”€â”€ */
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;margin-bottom:16px}
.ch{padding:13px 20px;border-bottom:1px solid var(--border);
  display:flex;align-items:center;justify-content:space-between}
.ch-t{font-size:9px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;
  display:flex;align-items:center;gap:8px}
.ch-t::before{content:'';width:3px;height:11px;border-radius:2px;background:var(--gold)}
.cb{padding:20px}
/* â”€â”€ Fields â”€â”€ */
.field{margin-bottom:14px}
.field label{display:block;font-size:10px;color:var(--sub);margin-bottom:5px;font-weight:600;
  display:flex;align-items:center;gap:6px}
.field input,.field select,.field textarea{
  width:100%;background:#090b13;border:1px solid var(--border2);border-radius:9px;
  padding:10px 14px;color:var(--text);font-size:12px;
  font-family:'Noto Sans JP',sans-serif;outline:none;transition:.15s}
.field input:focus,.field select:focus{border-color:var(--blue)}
.field input:read-only{color:var(--muted);cursor:not-allowed;background:rgba(255,255,255,.02)}
.fhint{font-size:10px;color:var(--muted);margin-top:5px;line-height:1.7}
.req{color:var(--red)}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
/* â”€â”€ Buttons â”€â”€ */
.btn{padding:9px 18px;border-radius:9px;font-size:11px;font-weight:700;cursor:pointer;
  font-family:'Noto Sans JP',sans-serif;transition:.15s;border:none;
  display:inline-flex;align-items:center;gap:6px;white-space:nowrap}
.btn-blue{background:linear-gradient(135deg,var(--blue),#3070c0);color:#fff}
.btn-blue:hover{filter:brightness(1.1)}
.btn-gold{background:linear-gradient(135deg,var(--gold),#a8742a);color:#0a0c10}
.btn-ghost{background:transparent;border:1px solid var(--border2);color:var(--sub)}
.btn-ghost:hover{color:var(--text);border-color:var(--sub)}
.btn-danger{background:rgba(248,113,113,.12);border:1px solid rgba(248,113,113,.3);color:var(--red)}
.btn-ok{background:rgba(52,211,153,.12);border:1px solid rgba(52,211,153,.3);color:var(--green)}
.btn-sm{padding:5px 12px;font-size:10px;border-radius:7px}
.btn:disabled{opacity:.4;cursor:not-allowed}
/* â”€â”€ Pills â”€â”€ */
.pill{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;
  border-radius:6px;font-size:9px;font-weight:700;white-space:nowrap}
.pg{background:rgba(52,211,153,.13);color:var(--green);border:1px solid rgba(52,211,153,.3)}
.pb{background:rgba(79,156,249,.12);color:var(--blue);border:1px solid rgba(79,156,249,.25)}
.po{background:rgba(251,146,60,.12);color:var(--orange);border:1px solid rgba(251,146,60,.3)}
.pr{background:rgba(248,113,113,.12);color:var(--red);border:1px solid rgba(248,113,113,.3)}
.pm{background:rgba(74,82,112,.15);color:var(--sub);border:1px solid var(--border2)}
.pgd{background:rgba(201,168,76,.13);color:var(--gold);border:1px solid var(--gold-dim)}
/* â”€â”€ Alert â”€â”€ */
.al{display:flex;align-items:flex-start;gap:10px;padding:12px 16px;border-radius:10px;
  margin-bottom:14px;font-size:12px;line-height:1.7}
.al-info{background:rgba(79,156,249,.07);border:1px solid rgba(79,156,249,.2)}
.al-warn{background:rgba(251,146,60,.07);border:1px solid rgba(251,146,60,.22)}
.al-ok{background:rgba(52,211,153,.07);border:1px solid rgba(52,211,153,.2)}
.al-lock{background:rgba(74,82,112,.1);border:1px solid var(--border2)}
/* â”€â”€ èªè¨¼ã‚³ãƒ¼ãƒ‰å…¥åŠ› â”€â”€ */
.otp-wrap{display:flex;gap:8px;justify-content:center;margin:20px 0}
.otp-cell{width:50px;height:58px;background:#090b13;border:2px solid var(--border2);
  border-radius:10px;font-size:24px;font-weight:700;text-align:center;color:var(--text);
  font-family:'DM Mono',monospace;outline:none;transition:.15s}
.otp-cell:focus{border-color:var(--blue);box-shadow:0 0 0 3px rgba(79,156,249,.15)}
.otp-cell.ok{border-color:var(--green);background:rgba(52,211,153,.05)}
.otp-cell.err{border-color:var(--red);animation:shake .3s ease}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}
/* â”€â”€ Password strength â”€â”€ */
.pw-strength{height:3px;border-radius:2px;margin-top:6px;transition:.3s;background:var(--border2)}
.pws-1{background:var(--red);width:25%}
.pws-2{background:var(--orange);width:50%}
.pws-3{background:var(--gold);width:75%}
.pws-4{background:var(--green);width:100%}
.pw-rules{display:grid;grid-template-columns:1fr 1fr;gap:4px;margin-top:8px}
.pw-rule{font-size:10px;color:var(--muted);display:flex;align-items:center;gap:5px}
.pw-rule.ok{color:var(--green)}
.pw-rule.ok::before{content:'âœ“'}
.pw-rule:not(.ok)::before{content:'â—‹'}
/* â”€â”€ Name badge â”€â”€ */
.name-row{display:flex;align-items:center;gap:12px;padding:14px 16px;
  background:var(--card2);border:1px solid var(--border);border-radius:11px;margin-bottom:12px}
.name-main{font-size:16px;font-weight:700}
.name-kana{font-family:'DM Mono',monospace;font-size:11px;color:var(--sub);margin-top:2px}
.name-badge-alt{font-size:11px;color:var(--muted);display:flex;align-items:center;gap:6px}
/* â”€â”€ Modal overlay â”€â”€ */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.78);backdrop-filter:blur(5px);
  z-index:400;display:none;align-items:center;justify-content:center}
.overlay.show{display:flex}
.modal{background:var(--card);border:1px solid var(--border2);border-radius:16px;
  width:480px;max-height:90vh;overflow-y:auto}
.mhdr{display:flex;align-items:center;justify-content:space-between;
  padding:16px 22px;border-bottom:1px solid var(--border);
  position:sticky;top:0;background:var(--card);z-index:1}
.mtitle{font-family:'Syne',sans-serif;font-size:14px;font-weight:800;color:var(--gold)}
.mclose{background:none;border:none;color:var(--muted);font-size:20px;cursor:pointer;line-height:1}
.mbody{padding:20px 22px}
.mfoot{padding:14px 22px;border-top:1px solid var(--border);
  display:flex;gap:8px;justify-content:flex-end;
  position:sticky;bottom:0;background:var(--card)}
/* â”€â”€ 2FA screen (full modal) â”€â”€ */
.tfa-wrap{text-align:center;padding:10px 0}
.tfa-icon{width:64px;height:64px;border-radius:50%;margin:0 auto 16px;
  background:rgba(79,156,249,.1);border:2px solid rgba(79,156,249,.3);
  display:flex;align-items:center;justify-content:center;font-size:28px;position:relative}
.tfa-pulse{position:absolute;inset:-6px;border-radius:50%;
  border:1px solid rgba(79,156,249,.25);animation:pulse 2s ease-in-out infinite}
@keyframes pulse{0%,100%{transform:scale(1);opacity:.6}50%{transform:scale(1.12);opacity:.2}}
.tfa-timer{font-size:11px;color:var(--muted);margin:8px 0 16px}
.tfa-timer span{font-family:'DM Mono',monospace;color:var(--orange);font-weight:700}
/* â”€â”€ History table â”€â”€ */
.tbl{width:100%;border-collapse:collapse}
.tbl th{padding:8px 14px;font-size:9px;color:var(--muted);font-weight:700;letter-spacing:.5px;
  text-transform:uppercase;border-bottom:1px solid var(--border);background:var(--card2);text-align:left}
.tbl td{padding:10px 14px;border-bottom:1px solid rgba(30,34,53,.5);font-size:12px;vertical-align:middle}
.tbl tr:last-child td{border:none}
.mono{font-family:'DM Mono',monospace}
/* â”€â”€ Step flow â”€â”€ */
.step-flow{display:flex;align-items:center;gap:0;margin-bottom:20px}
.sf-step{flex:1;text-align:center;position:relative}
.sf-step:not(:last-child)::after{content:'â†’';position:absolute;right:-10px;top:50%;
  transform:translateY(-50%);color:var(--muted);font-size:14px;z-index:1}
.sf-dot{width:32px;height:32px;border-radius:50%;margin:0 auto 6px;
  display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;
  border:2px solid var(--border2);background:var(--bg);font-family:'DM Mono',monospace}
.sf-step.on .sf-dot{background:var(--blue);border-color:var(--blue);color:#fff}
.sf-step.done .sf-dot{background:var(--green);border-color:var(--green);color:#0a0c10}
.sf-label{font-size:9px;color:var(--muted);line-height:1.4}
.sf-step.on .sf-label{color:var(--blue);font-weight:700}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px}
</style>
</head>
<body>
<div class="hdr">
  <div style="display:flex;align-items:center;gap:12px">
    <div class="logo">CORETO</div>
    <div style="width:1px;height:18px;background:var(--border2)"></div>
    <span style="font-size:10px;color:var(--muted);letter-spacing:1px">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š</span>
  </div>
  <div style="display:flex;gap:10px;align-items:center">
    <span class="pill pm" id="user-pill">å±±ç”° èª  / 10012</span>
    <button class="btn btn-ghost btn-sm" onclick="window.location.href='coreto-hub.html'">ğŸ  ãƒ›ãƒ¼ãƒ </button>
  </div>
</div>

<div class="layout">
  <!-- â”€â”€â”€ Sidebar â”€â”€â”€ -->
  <div class="sidebar">
    <div class="sb-section">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</div>
    <div class="sb-item on" id="sb-pw"   onclick="showPage('pw')"><span class="sb-icon">ğŸ”‘</span>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</div>
    <div class="sb-item" id="sb-2fa"  onclick="showPage('2fa')"><span class="sb-icon">ğŸ›¡</span>2FA / èªè¨¼è¨­å®š</div>

    <div class="sb-section" style="margin-top:8px">é€£çµ¡å…ˆæƒ…å ±</div>
    <div class="sb-item" id="sb-contact" onclick="showPage('contact')"><span class="sb-icon">ğŸ“±</span>é›»è©±ãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ»ä½æ‰€</div>
    <div class="sb-item" id="sb-line"    onclick="showPage('line')"><span class="sb-icon">ğŸ’¬</span>LINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</div>

    <div class="sb-section" style="margin-top:8px">æ°åãƒ»è¡¨ç¤º</div>
    <div class="sb-item" id="sb-name"    onclick="showPage('name')"><span class="sb-icon">ğŸ‘¤</span>æ°åãƒ»æ—§å§“è¨­å®š</div>
    <div class="sb-section" style="margin-top:8px">ç´¹ä»‹</div>
    <div class="sb-item" onclick="openRefModal()" style="color:var(--gold)"><span class="sb-icon">ğŸ”—</span>ç´¹ä»‹ãƒªãƒ³ã‚¯ç™ºè¡Œ</div>
  </div>

  <!-- â”€â”€â”€ Main â”€â”€â”€ -->
  <div class="main" id="main">
    <!-- ãƒšãƒ¼ã‚¸ã”ã¨ã«è¡¨ç¤º -->
  </div>
</div>

<!-- â•â•â•â•â•â•â•â• æœ¬äººç¢ºèªã‚³ãƒ¼ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ« â•â•â•â•â•â•â•â• -->
<div class="overlay" id="otp-modal">
<div class="modal" style="width:420px">
  <div class="mhdr">
    <div class="mtitle" id="otp-modal-title">2æ®µéšèªè¨¼</div>
    <button class="mclose" onclick="closeOtpModal()">âœ•</button>
  </div>
  <div class="mbody">
    <div class="tfa-wrap">
      <div class="tfa-icon">
        <div class="tfa-pulse"></div>
        <span id="otp-icon">ğŸ’¬</span>
      </div>
      <div style="font-size:13px;font-weight:700;margin-bottom:6px" id="otp-title2">æœ¬äººç¢ºèª</div>
      <div style="font-size:11px;color:var(--sub);line-height:1.8;margin-bottom:0" id="otp-desc">
        LINEã«6æ¡ã®ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã¾ã—ãŸ
      </div>
      <div class="otp-wrap">
        <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
               oninput="otpInput(this,0)" onkeydown="otpKey(event,0)" id="o0">
        <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
               oninput="otpInput(this,1)" onkeydown="otpKey(event,1)" id="o1">
        <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
               oninput="otpInput(this,2)" onkeydown="otpKey(event,2)" id="o2">
        <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
               oninput="otpInput(this,3)" onkeydown="otpKey(event,3)" id="o3">
        <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
               oninput="otpInput(this,4)" onkeydown="otpKey(event,4)" id="o4">
        <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
               oninput="otpInput(this,5)" onkeydown="otpKey(event,5)" id="o5">
      </div>
      <div class="tfa-timer">æœ‰åŠ¹æœŸé™ï¼š<span id="otp-countdown">5:00</span></div>
      <div style="font-size:10px;color:var(--muted);margin-bottom:12px" id="otp-demo-hint"></div>
      <div style="display:flex;gap:8px;justify-content:center">
        <button class="btn btn-ghost btn-sm" id="otp-resend" onclick="resendOtp()" disabled>ğŸ“¨ å†é€ä¿¡</button>
        <button class="btn btn-ghost btn-sm" onclick="closeOtpModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      </div>
    </div>
  </div>
</div>
</div>

<!-- â•â•â•â•â•â•â•â• å¤–éƒ¨ãƒªãƒ³ã‚¯é€ä¿¡ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆï¼‰ â•â•â•â•â•â•â•â• -->
<div class="overlay" id="reset-send-modal">
<div class="modal" style="width:440px">
  <div class="mhdr">
    <div class="mtitle">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®šãƒªãƒ³ã‚¯ã‚’é€ä¿¡</div>
    <button class="mclose" onclick="document.getElementById('reset-send-modal').classList.remove('show')">âœ•</button>
  </div>
  <div class="mbody">
    <div class="al al-info" style="margin-bottom:16px">
      â„¹ï¸ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®šãƒªãƒ³ã‚¯ã‚’é€ä¿¡ã—ã¾ã™ã€‚ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨èªè¨¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ç¢ºèªå¾Œã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†è¨­å®šã§ãã¾ã™ã€‚
    </div>
    <div style="font-size:10px;color:var(--sub);margin-bottom:10px;font-weight:600">é€ä¿¡å…ˆã‚’é¸æŠ</div>
    <div style="display:flex;flex-direction:column;gap:8px;margin-bottom:16px">
      <label style="display:flex;align-items:center;gap:10px;padding:12px;
                    background:var(--card2);border:1px solid var(--border);
                    border-radius:10px;cursor:pointer;transition:.15s"
             id="send-line-label" onclick="selectResetMethod('line')">
        <input type="radio" name="reset-method" value="line" checked>
        <span style="font-size:18px">ğŸ’¬</span>
        <div>
          <div style="font-size:12px;font-weight:700">LINE</div>
          <div style="font-size:10px;color:var(--muted)">ç™»éŒ²æ¸ˆã¿LINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆ@yamada_makotoï¼‰</div>
        </div>
      </label>
      <label style="display:flex;align-items:center;gap:10px;padding:12px;
                    background:var(--card2);border:1px solid var(--border);
                    border-radius:10px;cursor:pointer;transition:.15s"
             id="send-mail-label" onclick="selectResetMethod('email')">
        <input type="radio" name="reset-method" value="email">
        <span style="font-size:18px">ğŸ“§</span>
        <div>
          <div style="font-size:12px;font-weight:700">ãƒ¡ãƒ¼ãƒ«</div>
          <div style="font-size:10px;color:var(--muted)">yamada***@gmail.com</div>
        </div>
      </label>
    </div>
    <div style="font-size:10px;color:var(--muted);line-height:1.8;padding:10px;
                background:rgba(255,255,255,.02);border-radius:8px;border:1px solid var(--border)">
      ğŸ“Œ ãƒªãƒ³ã‚¯ã®æœ‰åŠ¹æœŸé™ã¯<strong style="color:var(--orange)">30åˆ†</strong>ã§ã™ã€‚<br>
      ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯å¾Œã«èªè¨¼ã‚³ãƒ¼ãƒ‰ç¢ºèªï¼ˆ6æ¡ï¼‰ãŒå¿…è¦ã§ã™ã€‚
    </div>
  </div>
  <div class="mfoot">
    <button class="btn btn-ghost" onclick="document.getElementById('reset-send-modal').classList.remove('show')">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
    <button class="btn btn-blue" onclick="sendResetLink()">ğŸ“¨ ãƒªãƒ³ã‚¯ã‚’é€ä¿¡ã™ã‚‹</button>
  </div>
</div>
</div>

<script>
// â”€â”€â”€ Demo user â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ME = {
  id: '10012', name: 'å±±ç”° èª ', nameKana: 'ãƒ¤ãƒãƒ€ ãƒã‚³ãƒˆ',
  nameOld: '', nameOldKana: '', showOldOnCard: false,
  type: 're', rank: 'gold',
  phone: '090-1234-5678', email: 'yamada@example.com',
  line: '@yamada_makoto', lineLinked: true,
  address: 'æ±äº¬éƒ½æ¸‹è°·åŒºæµæ¯”å¯¿1-2-3 ã‚³ãƒ¬ãƒ¼ãƒˆãƒãƒ³ã‚·ãƒ§ãƒ³101',
  postalCode: '150-0013',
};

document.getElementById('user-pill').textContent = `${ME.name} / ${ME.id}`;

// â”€â”€â”€ Page routing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showPage(page) {
  document.querySelectorAll('.sb-item').forEach(el => el.classList.remove('on'));
  document.getElementById('sb-'+page).classList.add('on');
  const m = document.getElementById('main');
  const pages = { pw: pagePw, '2fa': page2fa, contact: pageContact, line: pageLine, name: pageName };
  m.innerHTML = '';
  (pages[page] || pagePw)();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function pagePw() {
  document.getElementById('main').innerHTML = `
    <div class="page-title">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</div>
    <div class="page-sub">ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¢ºèªå¾Œã€æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¾ã™ã€‚å¤‰æ›´å¾Œã«LINEã§é€šçŸ¥ã•ã‚Œã¾ã™ã€‚</div>

    <!-- é€šå¸¸å¤‰æ›´ -->
    <div class="card" style="max-width:560px;margin-bottom:16px">
      <div class="ch"><div class="ch-t">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹</div></div>
      <div class="cb">
        <div class="field">
          <label>ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ <span class="req">*</span></label>
          <input type="password" id="pw-current" placeholder="ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
        </div>
        <div class="field">
          <label>æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ <span class="req">*</span></label>
          <input type="password" id="pw-new" placeholder="8æ–‡å­—ä»¥ä¸Šãƒ»è‹±æ•°å­—è¨˜å·" oninput="checkPwStrength()">
          <div class="pw-strength" id="pw-bar"></div>
          <div class="pw-rules">
            <div class="pw-rule" id="pwr-len">8æ–‡å­—ä»¥ä¸Š</div>
            <div class="pw-rule" id="pwr-upper">å¤§æ–‡å­—ã‚’å«ã‚€</div>
            <div class="pw-rule" id="pwr-num">æ•°å­—ã‚’å«ã‚€</div>
            <div class="pw-rule" id="pwr-sym">è¨˜å·ã‚’å«ã‚€</div>
          </div>
        </div>
        <div class="field">
          <label>æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆç¢ºèªï¼‰<span class="req">*</span></label>
          <input type="password" id="pw-confirm" placeholder="ã‚‚ã†ä¸€åº¦å…¥åŠ›">
          <div class="fhint" id="pw-match-hint"></div>
        </div>
        <div style="padding:10px 14px;background:var(--card2);border-radius:9px;
                    font-size:11px;color:var(--sub);margin-bottom:14px;line-height:1.8">
          ğŸ” å¤‰æ›´å®Œäº†å¾Œã€<strong style="color:var(--text)">LINEãƒ»ãƒ¡ãƒ¼ãƒ«ã«å¤‰æ›´é€šçŸ¥</strong>ãŒå±Šãã¾ã™ã€‚
          èº«ã«è¦šãˆã®ãªã„å¤‰æ›´ã®å ´åˆã¯ã™ãã«HQã«ã”é€£çµ¡ãã ã•ã„ã€‚
        </div>
        <button class="btn btn-blue" onclick="changePassword()" id="pw-submit-btn">
          ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹
        </button>
      </div>
    </div>

    <!-- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¿˜ã‚ŒãŸå ´åˆ -->
    <div class="card" style="max-width:560px">
      <div class="ch"><div class="ch-t">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãŠå¿˜ã‚Œã®å ´åˆ</div></div>
      <div class="cb">
        <div class="al al-info" style="margin-bottom:14px">
          â„¹ï¸ <div>ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„å ´åˆã¯ã€ç™»éŒ²æ¸ˆã¿ã®<strong>LINE</strong>ã¾ãŸã¯ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«
          å†è¨­å®šãƒªãƒ³ã‚¯ã‚’é€ä¿¡ã§ãã¾ã™ã€‚ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯å¾Œã«<strong>èªè¨¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ç¢ºèª</strong>ï¼ˆ6æ¡ï¼‰ãŒå¿…è¦ã§ã™ã€‚
          ãƒªãƒ³ã‚¯ã®æœ‰åŠ¹æœŸé™ã¯<strong>30åˆ†</strong>ã§ã™ã€‚</div>
        </div>

        <!-- é€ä¿¡ãƒ•ãƒ­ãƒ¼ -->
        <div class="step-flow">
          <div class="sf-step on" id="rsf-0">
            <div class="sf-dot">1</div>
            <div class="sf-label">é€ä¿¡å…ˆ<br>é¸æŠ</div>
          </div>
          <div class="sf-step" id="rsf-1">
            <div class="sf-dot">2</div>
            <div class="sf-label">LINE/ãƒ¡ãƒ¼ãƒ«<br>ã§ãƒªãƒ³ã‚¯å—ä¿¡</div>
          </div>
          <div class="sf-step" id="rsf-2">
            <div class="sf-dot">3</div>
            <div class="sf-label">èªè¨¼<br>ã‚³ãƒ¼ãƒ‰</div>
          </div>
          <div class="sf-step" id="rsf-3">
            <div class="sf-dot">4</div>
            <div class="sf-label">æ–°ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰<br>è¨­å®š</div>
          </div>
        </div>

        <button class="btn btn-ghost" onclick="openResetModal()" style="width:100%;justify-content:center">
          ğŸ“¨ å†è¨­å®šãƒªãƒ³ã‚¯ã‚’é€ã‚‹ï¼ˆLINE / ãƒ¡ãƒ¼ãƒ«ï¼‰
        </button>
      </div>
    </div>
  `;
}

function checkPwStrength() {
  const pw = document.getElementById('pw-new').value;
  const rules = [
    {id:'pwr-len',   ok: pw.length >= 8},
    {id:'pwr-upper', ok: /[A-Z]/.test(pw)},
    {id:'pwr-num',   ok: /[0-9]/.test(pw)},
    {id:'pwr-sym',   ok: /[^A-Za-z0-9]/.test(pw)},
  ];
  let score = rules.filter(r=>r.ok).length;
  rules.forEach(r => {
    const el = document.getElementById(r.id);
    if (el) el.className = 'pw-rule' + (r.ok ? ' ok' : '');
  });
  const bar = document.getElementById('pw-bar');
  if (bar) bar.className = 'pw-strength' + (score>0 ? ` pws-${score}` : '');

  const c = document.getElementById('pw-confirm');
  const hint = document.getElementById('pw-match-hint');
  if (c && hint && c.value) {
    const match = pw === c.value;
    hint.textContent = match ? 'âœ“ ä¸€è‡´ã—ã¦ã„ã¾ã™' : 'âœ— ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“';
    hint.style.color = match ? 'var(--green)' : 'var(--red)';
  }
}

function changePassword() {
  const cur  = document.getElementById('pw-current').value;
  const nw   = document.getElementById('pw-new').value;
  const conf = document.getElementById('pw-confirm').value;
  if (!cur || !nw || !conf) { alert('å…¨é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }
  if (nw !== conf) { alert('æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“'); return; }
  if (nw.length < 8) { alert('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯8æ–‡å­—ä»¥ä¸Šã§è¨­å®šã—ã¦ãã ã•ã„'); return; }
  openOtpModal('pw-change', 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ æœ¬äººç¢ºèª', onPwOtpSuccess);
}

function onPwOtpSuccess() {
  closeOtpModal();
  alert('âœ… ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¾ã—ãŸã€‚\nLINEãŠã‚ˆã³ãƒ¡ãƒ¼ãƒ«ã«å¤‰æ›´é€šçŸ¥ãŒå±Šãã¾ã™ã€‚');
  pagePw();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE: 2FAè¨­å®š
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function page2fa() {
  document.getElementById('main').innerHTML = `
    <div class="page-title">2FAãƒ»èªè¨¼è¨­å®š</div>
    <div class="page-sub">å³æ™‚æ‰•ã„ãªã©ã®é‡è¦æ“ä½œã§ä½¿ç”¨ã™ã‚‹2æ®µéšèªè¨¼ã®è¨­å®šã§ã™</div>

    <div class="card" style="max-width:560px;margin-bottom:16px">
      <div class="ch"><div class="ch-t">èªè¨¼æ–¹æ³•</div></div>
      <div class="cb">
        <div style="display:flex;flex-direction:column;gap:10px">
          <div style="display:flex;align-items:center;justify-content:space-between;
                      padding:14px;background:var(--card2);border-radius:10px;border:1px solid rgba(52,211,153,.2)">
            <div style="display:flex;align-items:center;gap:12px">
              <span style="font-size:22px">ğŸ’¬</span>
              <div>
                <div style="font-size:12px;font-weight:700">LINE èªè¨¼ã‚³ãƒ¼ãƒ‰</div>
                <div style="font-size:10px;color:var(--sub)">@yamada_makoto ã«6æ¡ã®ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡</div>
              </div>
            </div>
            <span class="pill pg">âœ“ æœ‰åŠ¹</span>
          </div>
          <div style="display:flex;align-items:center;justify-content:space-between;
                      padding:14px;background:var(--card2);border-radius:10px">
            <div style="display:flex;align-items:center;gap:12px">
              <span style="font-size:22px">ğŸ“±</span>
              <div>
                <div style="font-size:12px;font-weight:700">SMS èªè¨¼ã‚³ãƒ¼ãƒ‰</div>
                <div style="font-size:10px;color:var(--sub)">090-****-5678 ã«SMSã§é€ä¿¡</div>
              </div>
            </div>
            <span class="pill pg">âœ“ æœ‰åŠ¹</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card" style="max-width:560px">
      <div class="ch"><div class="ch-t">2FAãƒ­ã‚°</div></div>
      <table class="tbl">
        <thead><tr><th>æ—¥æ™‚</th><th>æ“ä½œ</th><th>æ–¹æ³•</th><th>çµæœ</th></tr></thead>
        <tbody>
          <tr>
            <td class="mono" style="font-size:10px">2026/02/20 10:32</td>
            <td style="font-size:11px">å³æ™‚æ‰•ã„ç”³è«‹</td>
            <td>ğŸ’¬ LINE</td>
            <td><span class="pill pg">æˆåŠŸ</span></td>
          </tr>
          <tr>
            <td class="mono" style="font-size:10px">2026/01/15 14:05</td>
            <td style="font-size:11px">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</td>
            <td>ğŸ’¬ LINE</td>
            <td><span class="pill pg">æˆåŠŸ</span></td>
          </tr>
          <tr>
            <td class="mono" style="font-size:10px">2025/12/10 09:18</td>
            <td style="font-size:11px">å³æ™‚æ‰•ã„ç”³è«‹</td>
            <td>ğŸ“± SMS</td>
            <td><span class="pill pr">å¤±æ•—ï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼‰</span></td>
          </tr>
        </tbody>
      </table>
    </div>
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE: é€£çµ¡å…ˆå¤‰æ›´ï¼ˆ2FAä¸è¦ï¼‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function pageContact() {
  document.getElementById('main').innerHTML = `
    <div class="page-title">é›»è©±ãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ»ä½æ‰€</div>
    <div class="page-sub">é€£çµ¡å…ˆæƒ…å ±ã®å¤‰æ›´ã¯2FAä¸è¦ã§ã™ã€‚å¤‰æ›´å¾Œã™ãã«åæ˜ ã•ã‚Œã¾ã™ã€‚</div>

    <div class="al al-info" style="max-width:660px">
      â„¹ï¸ é€£çµ¡å…ˆæƒ…å ±ã®å¤‰æ›´ã¯æœ¬äººç¢ºèªä¸è¦ã§è¡Œãˆã¾ã™ã€‚ãŸã ã—å¤‰æ›´å±¥æ­´ã¯è¨˜éŒ²ã•ã‚Œã¾ã™ã€‚
    </div>

    <div class="card" style="max-width:660px">
      <div class="ch"><div class="ch-t">é€£çµ¡å…ˆæƒ…å ±</div><span class="pill pm">2FAä¸è¦</span></div>
      <div class="cb">
        <div class="g2">
          <div class="field">
            <label>é›»è©±ç•ªå·</label>
            <input type="tel" id="ct-phone" value="${ME.phone}" placeholder="090-XXXX-XXXX">
          </div>
          <div class="field">
            <label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
            <input type="email" id="ct-email" value="${ME.email}" placeholder="example@email.com">
          </div>
        </div>
        <div class="g2">
          <div class="field">
            <label>éƒµä¾¿ç•ªå·</label>
            <input type="text" id="ct-postal" value="${ME.postalCode}" placeholder="000-0000"
                   oninput="lookupPostal(this.value)">
          </div>
          <div class="field">
            <label>ä½æ‰€ï¼ˆéƒ½é“åºœçœŒã€œç•ªåœ°ï¼‰</label>
            <input type="text" id="ct-address" value="${ME.address}" placeholder="æ±äº¬éƒ½æ¸‹è°·åŒº...">
          </div>
        </div>
        <div class="field" style="margin-bottom:0">
          <label>ãƒãƒ³ã‚·ãƒ§ãƒ³åãƒ»éƒ¨å±‹ç•ªå·ï¼ˆä»»æ„ï¼‰</label>
          <input type="text" id="ct-address2" placeholder="â—‹â—‹ãƒãƒ³ã‚·ãƒ§ãƒ³ 101">
        </div>
      </div>
      <div style="padding:14px 20px;border-top:1px solid var(--border);
                  display:flex;justify-content:flex-end;gap:8px">
        <button class="btn btn-ghost" onclick="pageContact()">ãƒªã‚»ãƒƒãƒˆ</button>
        <button class="btn btn-blue" onclick="saveContact()">ğŸ’¾ å¤‰æ›´ã‚’ä¿å­˜</button>
      </div>
    </div>

    <div class="card" style="max-width:660px">
      <div class="ch"><div class="ch-t">å¤‰æ›´å±¥æ­´</div></div>
      <table class="tbl">
        <thead><tr><th>å¤‰æ›´æ—¥æ™‚</th><th>å¤‰æ›´é …ç›®</th><th>å¤‰æ›´å‰</th><th>å¤‰æ›´å¾Œ</th></tr></thead>
        <tbody>
          <tr>
            <td class="mono" style="font-size:10px">2026/01/20 11:30</td>
            <td style="font-size:11px">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</td>
            <td style="font-size:11px;color:var(--sub)">yamada.old@gmail.com</td>
            <td style="font-size:11px">yamada@example.com</td>
          </tr>
        </tbody>
      </table>
    </div>
  `;
}

function lookupPostal(val) {
  const clean = val.replace(/[^0-9]/g,'');
  if (clean.length === 7) {
    // ãƒ‡ãƒ¢: éƒµä¾¿ç•ªå·è‡ªå‹•è£œå®Œ
    setTimeout(() => {
      const el = document.getElementById('ct-address');
      if (el && !el.value) el.value = 'æ±äº¬éƒ½æ¸‹è°·åŒºï¼ˆè‡ªå‹•è£œå®Œãƒ‡ãƒ¢ï¼‰';
    }, 400);
  }
}

function saveContact() {
  ME.phone   = document.getElementById('ct-phone').value;
  ME.email   = document.getElementById('ct-email').value;
  ME.postalCode = document.getElementById('ct-postal').value;
  ME.address = document.getElementById('ct-address').value;
  alert('âœ… é€£çµ¡å…ˆæƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚');
  pageContact();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE: LINEå¤‰æ›´ï¼ˆ2FAä¸è¦ï¼‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function pageLine() {
  document.getElementById('main').innerHTML = `
    <div class="page-title">LINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆå¤‰æ›´</div>
    <div class="page-sub">LINE IDã‚’å¤‰æ›´ã™ã‚‹ã¨ã€æ¬¡å›ã®èªè¨¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ç¢ºèªã‹ã‚‰æ–°ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«é€ä¿¡ã•ã‚Œã¾ã™ã€‚2FAä¸è¦ã§ã™ã€‚</div>

    <div class="al al-warn" style="max-width:560px">
      âš ï¸ <div>LINE IDã‚’å¤‰æ›´ã™ã‚‹å‰ã«ã€<strong>æ–°ã—ã„LINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒCORETOå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å‹é”è¿½åŠ æ¸ˆã¿</strong>ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
      æœªè¿½åŠ ã®å ´åˆã€èªè¨¼ã‚³ãƒ¼ãƒ‰ãŒå±Šã‹ãšå³æ™‚æ‰•ã„ãªã©ã®æ“ä½œãŒã§ããªããªã‚Šã¾ã™ã€‚</div>
    </div>

    <div class="card" style="max-width:560px;margin-bottom:14px">
      <div class="ch"><div class="ch-t">ç¾åœ¨ã®LINEè¨­å®š</div><span class="pill pg">âœ“ é€£æºæ¸ˆã¿</span></div>
      <div class="cb">
        <div style="display:flex;align-items:center;gap:14px;padding:14px;
                    background:var(--card2);border-radius:11px;margin-bottom:14px">
          <div style="width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,#06C755,#039B45);
                      display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0">ğŸ’¬</div>
          <div>
            <div style="font-size:13px;font-weight:700">${ME.line}</div>
            <div style="font-size:10px;color:var(--sub)">ç™»éŒ²æ¸ˆã¿LINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆ ID</div>
          </div>
          <span class="pill pg" style="margin-left:auto">âœ“ é€£æºä¸­</span>
        </div>

        <div class="field">
          <label>æ–°ã—ã„LINE ID <span class="req">*</span></label>
          <input type="text" id="new-line-id" placeholder="@æ–°ã—ã„LINEã®ID"
                 style="font-family:'DM Mono',monospace">
          <div class="fhint">
            ğŸ“Œ LINE ID ã¯ã€Œ@xxxxxxxxã€ã®å½¢å¼ã§ã™ï¼ˆLINEã‚¢ãƒ—ãƒªã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»é¢ã§ç¢ºèªã§ãã¾ã™ï¼‰<br>
            ğŸ“Œ CORETOå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆ@coreto_officialï¼‰ã‚’å‹é”è¿½åŠ ã—ãŸå¾Œã«å¤‰æ›´ã—ã¦ãã ã•ã„
          </div>
        </div>

        <div class="field" style="margin-bottom:0">
          <label>å¤‰æ›´ç†ç”±</label>
          <select id="line-reason">
            <option value="">â€” ä»»æ„ â€”</option>
            <option>LINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å¤‰æ›´ã—ãŸ</option>
            <option>æºå¸¯é›»è©±ç•ªå·ã‚’å¤‰æ›´ã—ãŸ</option>
            <option>ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã‚’æ©Ÿç¨®å¤‰æ›´ã—ãŸ</option>
            <option>ãã®ä»–</option>
          </select>
        </div>
      </div>
      <div style="padding:14px 20px;border-top:1px solid var(--border);
                  display:flex;justify-content:flex-end;gap:8px">
        <button class="btn btn-ghost" onclick="pageLine()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button class="btn btn-blue" onclick="saveLineId()">ğŸ’¾ LINE IDã‚’å¤‰æ›´ã™ã‚‹</button>
      </div>
    </div>

    <div class="card" style="max-width:560px">
      <div class="ch"><div class="ch-t">LINEå¤‰æ›´å±¥æ­´</div></div>
      <table class="tbl">
        <thead><tr><th>å¤‰æ›´æ—¥æ™‚</th><th>å¤‰æ›´å‰LINE ID</th><th>å¤‰æ›´å¾ŒLINE ID</th><th>ç†ç”±</th></tr></thead>
        <tbody>
          <tr>
            <td class="mono" style="font-size:10px">2025/08/14 16:22</td>
            <td class="mono" style="font-size:11px;color:var(--sub)">@yamada_old</td>
            <td class="mono" style="font-size:11px">@yamada_makoto</td>
            <td style="font-size:11px">ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³æ©Ÿç¨®å¤‰æ›´</td>
          </tr>
        </tbody>
      </table>
    </div>
  `;
}

function saveLineId() {
  const newId = document.getElementById('new-line-id').value.trim();
  if (!newId) { alert('æ–°ã—ã„LINE IDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }
  if (!newId.startsWith('@')) { alert('LINE IDã¯ã€Œ@ã€ã‹ã‚‰å§‹ã¾ã‚‹å½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }
  if (!confirm(`LINE IDã‚’ã€Œ${newId}ã€ã«å¤‰æ›´ã—ã¾ã™ã‹ï¼Ÿ\næ¬¡å›ã®èªè¨¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ç¢ºèªã‹ã‚‰æ–°ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«é€ä¿¡ã•ã‚Œã¾ã™ã€‚`)) return;
  ME.line = newId;
  alert(`âœ… LINE IDã‚’ã€Œ${newId}ã€ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚`);
  pageLine();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE: æ°åãƒ»æ—§å§“è¨­å®š
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function pageName() {
  const isHQ = false; // demo: agent view
  document.getElementById('main').innerHTML = `
    <div class="page-title">æ°åãƒ»æ—§å§“è¨­å®š</div>
    <div class="page-sub">æ³•çš„æ°åã®å¤‰æ›´ã¯æœ¬éƒ¨ã®ã¿å¯èƒ½ã§ã™ã€‚æ—§å§“ã®ååˆºè¡¨è¨˜ã¯è‡ªåˆ†ã§è¨­å®šã§ãã¾ã™ã€‚</div>

    <!-- ç¾åœ¨ã®æ°å -->
    <div class="card" style="max-width:660px;margin-bottom:16px">
      <div class="ch"><div class="ch-t">ç™»éŒ²æ°å</div></div>
      <div class="cb">
        <div class="name-row">
          <div style="width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--gold-dim),rgba(201,168,76,.3));
                      display:flex;align-items:center;justify-content:center;font-size:20px">ğŸ‘¤</div>
          <div style="flex:1">
            <div class="name-main">${ME.name}</div>
            <div class="name-kana">${ME.nameKana}</div>
          </div>
          <span class="pill pm">å¤‰æ›´ã¯æœ¬éƒ¨ã®ã¿</span>
        </div>
        <div class="al al-lock" style="margin-bottom:0">
          ğŸ”’ <div style="font-size:11px">æ³•çš„æ°åã®å¤‰æ›´ï¼ˆçµå©šãƒ»æ”¹åãªã©ï¼‰ã¯<strong>æœ¬éƒ¨ã‚¹ã‚¿ãƒƒãƒ•ã®ã¿</strong>ãŒè¡Œãˆã¾ã™ã€‚
          æ°åå¤‰æ›´ãŒå¿…è¦ãªå ´åˆã¯HQã«Slackã§ã”é€£çµ¡ãã ã•ã„ã€‚<br>
          å¤‰æ›´æ™‚ã«ã¯æˆ¸ç±è¬„æœ¬ãƒ»å©šå§»å±Šå—ç†è¨¼æ˜æ›¸ãªã©ã®æ›¸é¡ãŒå¿…è¦ã§ã™ã€‚</div>
        </div>
      </div>
    </div>

    <!-- æ—§å§“ãƒ»ååˆºè¡¨è¨˜ -->
    <div class="card" style="max-width:660px;margin-bottom:16px">
      <div class="ch">
        <div class="ch-t">æ—§å§“ãƒ»ååˆºè¡¨è¨˜è¨­å®š</div>
        <span class="pill pb">è‡ªåˆ†ã§è¨­å®šå¯èƒ½</span>
      </div>
      <div class="cb">
        <div class="al al-info" style="margin-bottom:16px">
          â„¹ï¸ çµå©šç­‰ã§æ—§å§“ã‚’ååˆºã«è¡¨è¨˜ã—ãŸã„å ´åˆã€æ—§å§“ã‚’ç™»éŒ²ã—ã¦ãŠãã¨ååˆºç™ºæ³¨æ™‚ã«è‡ªå‹•ã§ä½µè¨˜ã•ã‚Œã¾ã™ã€‚
        </div>
        <div class="g2">
          <div class="field">
            <label>æ—§å§“ï¼ˆæ¼¢å­—ï¼‰</label>
            <input type="text" id="old-name" value="${ME.nameOld || ''}" placeholder="ä¾‹ï¼šéˆ´æœ¨">
          </div>
          <div class="field">
            <label>æ—§å§“ï¼ˆã‚«ãƒŠï¼‰</label>
            <input type="text" id="old-kana" value="${ME.nameOldKana || ''}" placeholder="ä¾‹ï¼šã‚¹ã‚ºã‚­"
                   style="font-family:'DM Mono',monospace;letter-spacing:1px">
          </div>
        </div>

        <div style="padding:14px;background:var(--card2);border-radius:10px;margin-bottom:14px">
          <div style="font-size:10px;color:var(--muted);margin-bottom:8px">ååˆºãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>
          <div id="card-preview" style="background:white;border-radius:8px;padding:14px 18px;
               font-size:13px;color:#1a1a1a;display:inline-block;min-width:220px;
               box-shadow:0 2px 12px rgba(0,0,0,.2)">
            <div style="font-size:9px;color:#888;letter-spacing:2px;margin-bottom:6px">CORETO</div>
            <div style="font-size:17px;font-weight:700" id="card-name-preview">${ME.name}</div>
            <div style="font-size:11px;color:#666;font-family:monospace" id="card-kana-preview">${ME.nameKana}</div>
          </div>
          <button class="btn btn-ghost btn-sm" style="margin-left:12px;vertical-align:top;margin-top:4px"
                  onclick="updateCardPreview()">ğŸ‘ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°</button>
        </div>

        <label style="display:flex;align-items:center;gap:8px;font-size:12px;cursor:pointer;margin-bottom:14px">
          <input type="checkbox" id="show-old-on-card" ${ME.showOldOnCard?'checked':''}
                 onchange="updateCardPreview()">
          ååˆºã«æ—§å§“ã‚’è¡¨è¨˜ã™ã‚‹ï¼ˆã€Œå±±ç”°ï¼ˆæ—§å§“ï¼šéˆ´æœ¨ï¼‰èª ã€ã®å½¢å¼ï¼‰
        </label>
        <button class="btn btn-blue" onclick="saveOldName()">ğŸ’¾ æ—§å§“è¨­å®šã‚’ä¿å­˜</button>
      </div>
    </div>

    <!-- HQå°‚ç”¨: æ°åå¤‰æ›´ -->
    ${isHQ ? `
    <div class="card" style="max-width:660px;border-color:rgba(251,146,60,.3)">
      <div class="ch" style="background:rgba(251,146,60,.05)">
        <div class="ch-t" style="--c:var(--orange)">HQå°‚ç”¨ â€” æ³•çš„æ°åå¤‰æ›´</div>
        <span class="pill po">ğŸ¢ HQã®ã¿</span>
      </div>
      <div class="cb">
        <div class="al al-warn" style="margin-bottom:14px">
          âš ï¸ æ³•çš„æ°åã®å¤‰æ›´ã¯æˆ¸ç±æ›¸é¡ã®ç¢ºèªå¾Œã®ã¿å®Ÿæ–½ã§ãã¾ã™ã€‚
        </div>
        <div class="g2">
          <div class="field"><label>å¤‰æ›´å¾Œ æ°åï¼ˆæ¼¢å­—ï¼‰<span class="req">*</span></label>
            <input type="text" id="hq-name-new" placeholder="å±±ç”° èª "></div>
          <div class="field"><label>å¤‰æ›´å¾Œ ã‚«ãƒŠ<span class="req">*</span></label>
            <input type="text" id="hq-name-kana" placeholder="ãƒ¤ãƒãƒ€ ãƒã‚³ãƒˆ"
                   style="font-family:'DM Mono',monospace;letter-spacing:1px"></div>
        </div>
        <div class="field"><label>å¤‰æ›´ç†ç”±<span class="req">*</span></label>
          <select id="hq-name-reason">
            <option value="">â€” é¸æŠ â€”</option>
            <option>å©šå§»</option><option>é›¢å©š</option><option>é¤Šå­ç¸çµ„</option><option>ãã®ä»–æ”¹å</option>
          </select>
        </div>
        <button class="btn btn-danger" onclick="hqChangeName()">âš ï¸ æ°åã‚’å¤‰æ›´ã™ã‚‹</button>
      </div>
    </div>` : ''}
  `;
}

function updateCardPreview() {
  const oldN  = (document.getElementById('old-name') || {}).value || '';
  const showOld = (document.getElementById('show-old-on-card') || {}).checked;
  const nameDisplay = showOld && oldN
    ? `${ME.name.split(' ')[0]}ï¼ˆæ—§å§“ï¼š${oldN}ï¼‰${ME.name.split(' ')[1]||''}`
    : ME.name;
  const kanaDisplay = showOld && document.getElementById('old-kana').value
    ? `${ME.nameKana}ï¼ˆæ—§å§“ï¼š${document.getElementById('old-kana').value}ï¼‰`
    : ME.nameKana;
  document.getElementById('card-name-preview').textContent = nameDisplay;
  document.getElementById('card-kana-preview').textContent = kanaDisplay;
}

function saveOldName() {
  ME.nameOld     = document.getElementById('old-name').value;
  ME.nameOldKana = document.getElementById('old-kana').value;
  ME.showOldOnCard = document.getElementById('show-old-on-card').checked;
  alert('âœ… æ—§å§“è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚ååˆºç™ºæ³¨æ™‚ã«åæ˜ ã•ã‚Œã¾ã™ã€‚');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆï¼ˆå¤–éƒ¨ãƒªãƒ³ã‚¯é€ä¿¡ï¼‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let resetMethod = 'line';
function openResetModal() {
  document.getElementById('reset-send-modal').classList.add('show');
}
function selectResetMethod(m) {
  resetMethod = m;
}
function sendResetLink() {
  document.getElementById('reset-send-modal').classList.remove('show');
  const dest = resetMethod === 'line' ? 'LINEï¼ˆ@yamada_makotoï¼‰' : 'ãƒ¡ãƒ¼ãƒ«ï¼ˆyamada***@gmail.comï¼‰';
  // After sending, show code verification step (simulated as clicking link)
  setTimeout(() => {
    if (confirm(`âœ… å†è¨­å®šãƒªãƒ³ã‚¯ã‚’${dest}ã«é€ä¿¡ã—ã¾ã—ãŸã€‚\n\nã€ãƒ‡ãƒ¢ã€‘ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦èªè¨¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ç¢ºèªç”»é¢ã‚’è¡¨ç¤ºã—ã¾ã™ã‹ï¼Ÿ`)) {
      // Advance step indicators
      ['rsf-0','rsf-1'].forEach(id => {
        const el = document.getElementById(id);
        if (el) { el.className='sf-step done'; el.querySelector('.sf-dot').textContent='âœ“'; }
      });
      const s2 = document.getElementById('rsf-2');
      if (s2) { s2.className='sf-step on'; }
      openOtpModal('pw-reset', 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®š èªè¨¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ç¢ºèª', onResetOtpSuccess);
    }
  }, 400);
}
function onResetOtpSuccess() {
  closeOtpModal();
  ['rsf-2','rsf-3'].forEach(id => {
    const el = document.getElementById(id);
    if (el) { el.className='sf-step done'; el.querySelector('.sf-dot').textContent='âœ“'; }
  });
  // Show new password form inline
  setTimeout(() => showNewPasswordForm(), 200);
}
function showNewPasswordForm() {
  const area = document.createElement('div');
  area.className = 'card';
  area.style.cssText = 'max-width:560px;border-color:rgba(52,211,153,.3)';
  area.innerHTML = `
    <div class="ch" style="background:rgba(52,211,153,.05)">
      <div class="ch-t">æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®š</div>
      <span class="pill pg">âœ“ èªè¨¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ç¢ºèªæ¸ˆã¿</span>
    </div>
    <div class="cb">
      <div class="al al-ok" style="margin-bottom:14px">âœ… æœ¬äººç¢ºèªãŒå®Œäº†ã—ã¾ã—ãŸã€‚æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚</div>
      <div class="field">
        <label>æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ <span class="req">*</span></label>
        <input type="password" id="reset-pw-new" placeholder="8æ–‡å­—ä»¥ä¸Š">
      </div>
      <div class="field" style="margin-bottom:14px">
        <label>æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆç¢ºèªï¼‰<span class="req">*</span></label>
        <input type="password" id="reset-pw-conf" placeholder="ã‚‚ã†ä¸€åº¦å…¥åŠ›">
      </div>
      <button class="btn btn-blue" onclick="submitNewPassword()" style="width:100%;justify-content:center">
        ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹
      </button>
    </div>`;
  document.getElementById('main').appendChild(area);
  area.scrollIntoView({ behavior:'smooth' });
}
function submitNewPassword() {
  const nw   = document.getElementById('reset-pw-new').value;
  const conf = document.getElementById('reset-pw-conf').value;
  if (!nw || nw.length < 8) { alert('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯8æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }
  if (nw !== conf) { alert('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“'); return; }
  alert('âœ… ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†è¨­å®šã—ã¾ã—ãŸã€‚\næ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚');
  pagePw();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// èªè¨¼ã‚³ãƒ¼ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«æ±ç”¨
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let _otpCode = '', _otpCallback = null, _otpTimer = null, _otpCountdown = 300;
function openOtpModal(context, title, callback) {
  _otpCode     = String(Math.floor(100000 + Math.random() * 900000));
  _otpCallback = callback;
  clearInterval(_otpTimer);
  _otpCountdown = 300;
  for (let i=0;i<6;i++) {
    const c = document.getElementById('o'+i);
    if (c) { c.value=''; c.className='otp-cell'; c.disabled=false; }
  }
  document.getElementById('otp-modal-title').textContent = title;
  document.getElementById('otp-desc').textContent =
    'LINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆ'+ME.line+'ï¼‰ã«6æ¡ã®ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã¾ã—ãŸ';
  document.getElementById('otp-demo-hint').textContent = 'ã€ãƒ‡ãƒ¢ç”¨ã‚³ãƒ¼ãƒ‰: '+_otpCode+'ã€‘';
  document.getElementById('otp-resend').disabled = true;
  document.getElementById('otp-modal').classList.add('show');
  _otpTimer = setInterval(() => {
    _otpCountdown--;
    const m = Math.floor(_otpCountdown/60), s = _otpCountdown%60;
    const el = document.getElementById('otp-countdown');
    if (el) el.textContent = m+':'+String(s).padStart(2,'0');
    if (_otpCountdown <= 0) {
      clearInterval(_otpTimer);
      document.getElementById('otp-resend').disabled = false;
      for (let i=0;i<6;i++) { const c=document.getElementById('o'+i); if(c) c.disabled=true; }
    }
  }, 1000);
  setTimeout(()=>{ const c=document.getElementById('o0'); if(c)c.focus(); },100);
}
function closeOtpModal() {
  clearInterval(_otpTimer);
  document.getElementById('otp-modal').classList.remove('show');
}
function resendOtp() {
  _otpCode = String(Math.floor(100000+Math.random()*900000));
  document.getElementById('otp-demo-hint').textContent = 'ã€ãƒ‡ãƒ¢ç”¨ã‚³ãƒ¼ãƒ‰: '+_otpCode+'ã€‘';
  _otpCountdown = 300;
  clearInterval(_otpTimer);
  document.getElementById('otp-resend').disabled = true;
  for (let i=0;i<6;i++) {
    const c=document.getElementById('o'+i);
    if(c){ c.value=''; c.className='otp-cell'; c.disabled=false; }
  }
  document.getElementById('o0').focus();
  _otpTimer = setInterval(()=>{
    _otpCountdown--;
    const m=Math.floor(_otpCountdown/60),s=_otpCountdown%60;
    const el=document.getElementById('otp-countdown');
    if(el) el.textContent=m+':'+String(s).padStart(2,'0');
    if(_otpCountdown<=0){ clearInterval(_otpTimer); document.getElementById('otp-resend').disabled=false; }
  },1000);
}
function otpInput(el,idx) {
  const v = el.value.replace(/\D/g,'');
  el.value = v;
  el.className = 'otp-cell';
  if (v && idx<5) document.getElementById('o'+(idx+1)).focus();
  if (idx===5 && v) checkOtp();
}
function otpKey(e,idx) {
  if (e.key==='Backspace' && !e.target.value && idx>0)
    document.getElementById('o'+(idx-1)).focus();
}
function checkOtp() {
  const entered = Array.from({length:6},(_,i)=>document.getElementById('o'+i).value).join('');
  if (entered === _otpCode) {
    for(let i=0;i<6;i++) document.getElementById('o'+i).className='otp-cell ok';
    clearInterval(_otpTimer);
    setTimeout(()=>{ if(_otpCallback) _otpCallback(); }, 500);
  } else {
    for(let i=0;i<6;i++) document.getElementById('o'+i).className='otp-cell err';
    setTimeout(()=>{
      for(let i=0;i<6;i++){
        const c=document.getElementById('o'+i);
        c.value=''; c.className='otp-cell';
      }
      document.getElementById('o0').focus();
    }, 800);
  }
}


function hqChangeName() {
  const newName  = document.getElementById('hq-name-new').value.trim();
  const newKana  = document.getElementById('hq-name-kana').value.trim();
  const reason   = document.getElementById('hq-name-reason').value;
  if (!newName || !newKana || !reason) { alert('å…¨é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }
  if (!confirm(`æ°åã‚’ã€Œ${newName}ï¼ˆ${newKana}ï¼‰ã€ã«å¤‰æ›´ã—ã¾ã™ã‹ï¼Ÿ\nç†ç”±ï¼š${reason}\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚`)) return;
  ME.name     = newName;
  ME.nameKana = newKana;
  alert(`âœ… æ°åã‚’ã€Œ${newName}ã€ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚\nã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«Slackã§é€šçŸ¥ã•ã‚Œã¾ã™ã€‚`);
  pageName();
}

// â”€â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
showPage('pw');
</script>
</body>
</html>
