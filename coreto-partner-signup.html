<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CORETO ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼å…¥ä¼šç”³è¾¼</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=DM+Mono:wght@400;500&family=Syne:wght@700;800&display=swap');
*{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#07090f;--card:#0f1119;--card2:#141720;--border:#1e2235;--border2:#252a3d;
  --gold:#c9a84c;--gold-dim:#7a5f22;--blue:#4f9cf9;--green:#34d399;--red:#f87171;
  --orange:#fb923c;--muted:#4a5270;--sub:#7a849e;--text:#e2e6f3;}
html,body{min-height:100%;font-family:'Noto Sans JP',sans-serif;background:var(--bg);color:var(--text)}
.hdr{padding:18px 28px;display:flex;align-items:center;gap:16px;border-bottom:1px solid var(--border)}
.logo{font-family:'Syne',sans-serif;font-size:20px;font-weight:800;color:var(--gold);letter-spacing:3px}
.steps{display:flex;align-items:center;max-width:680px;margin:24px auto 32px;padding:0 20px}
.step{flex:1;text-align:center;position:relative}
.step:not(:last-child)::after{content:'';position:absolute;top:16px;left:60%;width:80%;height:2px;background:var(--border);z-index:0}
.step.done:not(:last-child)::after{background:var(--green)}
.step-dot{width:32px;height:32px;border-radius:50%;margin:0 auto 6px;display:flex;align-items:center;
  justify-content:center;font-size:13px;border:2px solid var(--border2);background:var(--bg);
  position:relative;z-index:1;font-family:'DM Mono',monospace;font-weight:700}
.step.on .step-dot{background:var(--blue);border-color:var(--blue);color:#fff}
.step.done .step-dot{background:var(--green);border-color:var(--green);color:#0a0c10}
.step-lbl{font-size:9px;color:var(--muted);line-height:1.4}
.step.on .step-lbl{color:var(--blue);font-weight:700}
.wrap{max-width:680px;margin:0 auto;padding:0 20px 80px}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;margin-bottom:16px}
.ch{padding:13px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.ch-t{font-size:9px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;display:flex;align-items:center;gap:8px}
.ch-t::before{content:'';width:3px;height:11px;border-radius:2px;background:var(--green)}
.cb{padding:20px}
.field{margin-bottom:14px}
.field label{display:block;font-size:10px;color:var(--sub);margin-bottom:5px;font-weight:600}
.req{color:var(--red)}
.field input,.field select{width:100%;background:#090b13;border:1px solid var(--border2);border-radius:9px;
  padding:10px 14px;color:var(--text);font-size:13px;font-family:'Noto Sans JP',sans-serif;outline:none;transition:.15s}
.field input:focus,.field select:focus{border-color:var(--blue)}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
.fhint{font-size:10px;color:var(--muted);margin-top:5px;line-height:1.7}
.pill{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:6px;font-size:9px;font-weight:700}
.pg{background:rgba(52,211,153,.13);color:var(--green);border:1px solid rgba(52,211,153,.3)}
.pb{background:rgba(79,156,249,.12);color:var(--blue);border:1px solid rgba(79,156,249,.25)}
.pgd{background:rgba(201,168,76,.13);color:var(--gold);border:1px solid var(--gold-dim)}
.pm{background:rgba(74,82,112,.15);color:var(--sub);border:1px solid var(--border2)}
.al{display:flex;align-items:flex-start;gap:10px;padding:12px 16px;border-radius:10px;margin-bottom:14px;font-size:12px;line-height:1.7}
.al-info{background:rgba(79,156,249,.07);border:1px solid rgba(79,156,249,.2)}
.al-ok{background:rgba(52,211,153,.07);border:1px solid rgba(52,211,153,.2)}
.al-warn{background:rgba(251,146,60,.07);border:1px solid rgba(251,146,60,.22)}
.btn-primary{width:100%;padding:13px;border-radius:11px;font-size:13px;font-weight:700;cursor:pointer;
  font-family:'Noto Sans JP',sans-serif;border:none;display:flex;align-items:center;justify-content:center;gap:8px;
  background:linear-gradient(135deg,var(--blue),#3070c0);color:#fff;transition:.15s}
.btn-primary:hover{filter:brightness(1.1)}
.btn-primary:disabled{opacity:.4;cursor:not-allowed}
.btn-gold{background:linear-gradient(135deg,var(--gold),#a8742a);color:#0a0c10}
.btn-back{background:none;border:none;color:var(--muted);font-size:11px;cursor:pointer;
  font-family:'Noto Sans JP',sans-serif;padding:8px 0;display:block;margin:10px auto 0;text-align:center}
.bc-opt{display:flex;align-items:center;gap:14px;padding:16px;
  background:var(--card2);border:2px solid var(--border);border-radius:12px;cursor:pointer;
  transition:all .15s;margin-bottom:10px}
.bc-opt:hover{border-color:var(--sub)}
.bc-opt.sel-yes{border-color:var(--green);background:rgba(52,211,153,.05)}
.bc-opt.sel-no{border-color:var(--muted)}
.bc-opt input[type=radio]{width:18px;height:18px;accent-color:var(--green);cursor:pointer;flex-shrink:0}
.bc-mini{background:white;border-radius:7px;padding:10px 14px;min-width:160px;
  box-shadow:0 2px 12px rgba(0,0,0,.25);flex-shrink:0;font-family:'Noto Sans JP',sans-serif}
.sum-row{display:flex;justify-content:space-between;align-items:center;padding:10px 0;
  border-bottom:1px solid rgba(30,34,53,.5);font-size:12px}
.sum-row:last-child{border:none}
.otp-wrap{display:flex;gap:8px;justify-content:center;margin:16px 0}
.otp-c{width:48px;height:56px;background:#090b13;border:2px solid var(--border2);border-radius:10px;
  font-size:22px;font-weight:700;text-align:center;color:var(--text);font-family:'DM Mono',monospace;outline:none;transition:.15s}
.otp-c:focus{border-color:var(--blue)}
.otp-c.ok{border-color:var(--green);background:rgba(52,211,153,.05)}
.otp-c.err{border-color:var(--red);animation:shake .3s ease}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}
.mono{font-family:'DM Mono',monospace}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px}
</style>
</head>
<body>
<div class="hdr">
  <div class="logo">CORETO</div>
  <div style="font-size:12px;color:var(--sub)">ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ å…¥ä¼šç”³è¾¼</div>
</div>

<div class="steps" id="stepbar">
  <div class="step on" id="s0"><div class="step-dot">1</div><div class="step-lbl">åŸºæœ¬æƒ…å ±</div></div>
  <div class="step"    id="s1"><div class="step-dot">2</div><div class="step-lbl">LINE<br>é€£æº</div></div>
  <div class="step"    id="s2"><div class="step-dot">3</div><div class="step-lbl">ååˆº<br>ã‚ªãƒ—ã‚·ãƒ§ãƒ³</div></div>
  <div class="step"    id="s3"><div class="step-dot">4</div><div class="step-lbl">æ±ºæ¸ˆ<br>æƒ…å ±</div></div>
  <div class="step"    id="s4"><div class="step-dot">5</div><div class="step-lbl">ç¢ºèª<br>é€ä¿¡</div></div>
</div>

<div class="wrap" id="wrap"></div>

<script>
var step = 0;
var form = { name:'', nameKana:'', phone:'', email:'', lineId:'',
             postal:'', address:'', company:'', referralCode:'',
             wantCard:null, cardLast4:'' };
var _otp = '', _otpTimer = null, _otpSec = 300;

function goStep(n) {
  step = n;
  for (var i=0; i<5; i++) {
    var el = document.getElementById('s'+i);
    el.className = 'step'+(i<n?' done':i===n?' on':'');
    el.querySelector('.step-dot').textContent = i<n ? 'âœ“' : String(i+1);
  }
  [step0,step1,step2,step3,step4][n]();
  window.scrollTo({top:0,behavior:'smooth'});
}

// STEP 0
function step0() {
  document.getElementById('wrap').innerHTML = '<div class="card"><div class="ch"><div class="ch-t">åŸºæœ¬æƒ…å ±</div><span class="pill pb">1 / 5</span></div><div class="cb">' +
    '<div class="g2">' +
    '<div class="field"><label>æ°åï¼ˆæ¼¢å­—ï¼‰<span class="req">*</span></label><input id="f-name" value="'+form.name+'" placeholder="å±±ç”° å¤ªéƒ"></div>' +
    '<div class="field"><label>æ°åï¼ˆã‚«ãƒŠï¼‰<span class="req">*</span></label><input id="f-kana" value="'+form.nameKana+'" placeholder="ãƒ¤ãƒãƒ€ ã‚¿ãƒ­ã‚¦" style="font-family:\'DM Mono\',monospace;letter-spacing:1px"></div>' +
    '</div><div class="g2">' +
    '<div class="field"><label>é›»è©±ç•ªå·<span class="req">*</span></label><input id="f-phone" type="tel" value="'+form.phone+'" placeholder="090-0000-0000"></div>' +
    '<div class="field"><label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹<span class="req">*</span></label><input id="f-email" type="email" value="'+form.email+'" placeholder="email@example.com"></div>' +
    '</div><div class="g2">' +
    '<div class="field"><label>éƒµä¾¿ç•ªå·<span class="req">*</span></label><input id="f-postal" value="'+form.postal+'" placeholder="000-0000"></div>' +
    '<div class="field"><label>ä½æ‰€<span class="req">*</span></label><input id="f-address" value="'+form.address+'" placeholder="æ±äº¬éƒ½æ¸‹è°·åŒº..."></div>' +
    '</div><div class="g2">' +
    '<div class="field"><label>ä¼šç¤¾åï¼ˆä»»æ„ï¼‰</label><input id="f-company" value="'+form.company+'" placeholder="æ ªå¼ä¼šç¤¾â—‹â—‹"></div>' +
    '<div class="field"><label>ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ï¼ˆä»»æ„ï¼‰</label><input id="f-ref" value="'+form.referralCode+'" placeholder="PT-XXXXXX" style="font-family:\'DM Mono\',monospace"></div>' +
    '</div>' +
    '<button class="btn-primary" onclick="validateStep0()">æ¬¡ã¸ â†’</button>' +
    '</div></div>';
}

function validateStep0() {
  form.name     = document.getElementById('f-name').value.trim();
  form.nameKana = document.getElementById('f-kana').value.trim();
  form.phone    = document.getElementById('f-phone').value.trim();
  form.email    = document.getElementById('f-email').value.trim();
  form.postal   = document.getElementById('f-postal').value.trim();
  form.address  = document.getElementById('f-address').value.trim();
  form.company  = document.getElementById('f-company').value.trim();
  form.referralCode = document.getElementById('f-ref').value.trim();
  if (!form.name||!form.nameKana||!form.phone||!form.email||!form.postal||!form.address) {
    alert('å¿…é ˆé …ç›®ï¼ˆ*ï¼‰ã‚’å…¨ã¦å…¥åŠ›ã—ã¦ãã ã•ã„'); return;
  }
  goStep(1);
}

// STEP 1 - LINE èªè¨¼ã‚³ãƒ¼ãƒ‰
function step1() {
  document.getElementById('wrap').innerHTML = '<div class="card"><div class="ch"><div class="ch-t">LINEé€£æºãƒ»æœ¬äººç¢ºèª</div><span class="pill pb">2 / 5</span></div><div class="cb">' +
    '<div class="al al-info">â„¹ï¸ <div>èªè¨¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ç¢ºèªãƒ»é€šçŸ¥ã«ä½¿ç”¨ã—ã¾ã™ã€‚å…ˆã«<strong>CORETOå…¬å¼LINEï¼ˆ@coreto_officialï¼‰ã‚’å‹é”è¿½åŠ </strong>ã—ã¦ãã ã•ã„ã€‚</div></div>' +
    '<div class="field"><label>æºå¸¯é›»è©±ç•ªå· <span class="req">*</span></label>' +
    '<input id="f-line" value="'+form.lineId+'" placeholder="@ã‚ãªãŸã®LINE ID" style="font-family:\'DM Mono\',monospace">' +
    '<div class="fhint">å…¥åŠ›å¾Œã€Œèªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„</div></div>' +
    '<div style="text-align:center;margin:14px 0">' +
    '<button onclick="sendLineOtp()" style="padding:10px 20px;background:rgba(79,156,249,.1);border:1px solid rgba(79,156,249,.3);color:var(--blue);border-radius:9px;font-size:11px;font-weight:700;cursor:pointer;font-family:\'Noto Sans JP\',sans-serif">ğŸ“± SMSã«èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã™ã‚‹</button>' +
    '</div>' +
    '<div id="otp-area" style="display:none;text-align:center">' +
    '<div style="font-size:12px;color:var(--sub);margin-bottom:4px">SMSã§å±Šã„ãŸ6æ¡ã®èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›</div>' +
    '<div style="font-size:10px;color:var(--muted);margin-bottom:12px" id="otp-hint"></div>' +
    '<div class="otp-wrap">' +
    [0,1,2,3,4,5].map(function(i){return '<input class="otp-c" id="oc'+i+'" maxlength="1" type="text" inputmode="numeric" oninput="otpIn(this,'+i+')" onkeydown="otpKey(event,'+i+')">';}).join('') +
    '</div><div style="font-size:11px;color:var(--muted)" id="otp-timer">æœ‰åŠ¹æœŸé™ï¼š5:00</div>' +
    '</div>' +
    '<div id="otp-ok" style="display:none"><div class="al al-ok">âœ… é›»è©±ç•ªå·ã®ç¢ºèªãŒå®Œäº†ã—ã¾ã—ãŸ</div></div>' +
    '<button class="btn-back" onclick="goStep(0)">â† æˆ»ã‚‹</button>' +
    '</div></div>';
}

function sendLineOtp() {
  form.lineId = document.getElementById('f-line').value.trim();
  if (!form.lineId||!form.lineId.startsWith('@')) { alert('LINE IDã‚’ã€Œ@ã€ã‹ã‚‰å§‹ã¾ã‚‹å½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }
  _otp = String(Math.floor(100000+Math.random()*900000));
  document.getElementById('otp-area').style.display='block';
  document.getElementById('otp-hint').textContent='ã€ãƒ‡ãƒ¢ç”¨ã‚³ãƒ¼ãƒ‰: '+_otp+'ã€‘';
  startOtpTimer();
  setTimeout(function(){document.getElementById('oc0').focus();},100);
}

function startOtpTimer() {
  clearInterval(_otpTimer); _otpSec=300;
  _otpTimer=setInterval(function(){
    _otpSec--;
    var el=document.getElementById('otp-timer');
    if(el) el.textContent='æœ‰åŠ¹æœŸé™ï¼š'+Math.floor(_otpSec/60)+':'+String(_otpSec%60).padStart(2,'0');
    if(_otpSec<=0) clearInterval(_otpTimer);
  },1000);
}

function otpIn(el,idx) {
  var v=el.value.replace(/\D/g,'');el.value=v;el.className='otp-c';
  if(v&&idx<5) document.getElementById('oc'+(idx+1)).focus();
  if(idx===5&&v) checkOtp();
}
function otpKey(e,idx){if(e.key==='Backspace'&&!e.target.value&&idx>0)document.getElementById('oc'+(idx-1)).focus();}
function checkOtp() {
  var entered=Array.from({length:6},function(_,i){return document.getElementById('oc'+i).value;}).join('');
  if(entered===_otp){
    for(var i=0;i<6;i++) document.getElementById('oc'+i).className='otp-c ok';
    clearInterval(_otpTimer);
    setTimeout(function(){
      document.getElementById('otp-area').style.display='none';
      document.getElementById('otp-ok').style.display='block';
      setTimeout(function(){goStep(2);},700);
    },600);
  } else {
    for(var i=0;i<6;i++) document.getElementById('oc'+i).className='otp-c err';
    setTimeout(function(){
      for(var i=0;i<6;i++){var c=document.getElementById('oc'+i);c.value='';c.className='otp-c';}
      document.getElementById('oc0').focus();
    },800);
  }
}

// STEP 2 - ååˆºã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆä»»æ„ï¼‰
function step2() {
  var nm = form.name||'å±±ç”° å¤ªéƒ', nk=form.nameKana||'ãƒ¤ãƒãƒ€ ã‚¿ãƒ­ã‚¦', ph=form.phone||'090-0000-0000';
  document.getElementById('wrap').innerHTML = '<div class="card"><div class="ch"><div class="ch-t">ååˆºã‚ªãƒ—ã‚·ãƒ§ãƒ³</div><span class="pill pb">3 / 5</span></div><div class="cb">' +
    '<div class="al al-info" style="margin-bottom:20px">â„¹ï¸ <div><strong>ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼æ§˜ã®ååˆºã¯ä»»æ„</strong>ã§ã™ã€‚ã”å¸Œæœ›ã®å ´åˆã¯Â¥2,000ãŒæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§åˆç®—æ±ºæ¸ˆã•ã‚Œã¾ã™ã€‚å¾Œã‹ã‚‰ãƒã‚¤ãƒšãƒ¼ã‚¸ã§ç™ºæ³¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</div></div>' +
    '<div id="bc-yes" class="bc-opt'+(form.wantCard===true?' sel-yes':'')+'" onclick="selCard(true)">' +
    '<input type="radio" name="bc"'+(form.wantCard===true?' checked':'')+' onclick="selCard(true)">' +
    '<div class="bc-mini">' +
    '<div style="font-size:7px;color:#888;letter-spacing:2px;margin-bottom:5px">CORETO</div>' +
    '<div style="font-size:13px;font-weight:700;color:#1a1a1a;margin-bottom:2px">'+nm+'</div>' +
    '<div style="font-size:9px;color:#888;font-family:monospace;margin-bottom:7px">'+nk+'</div>' +
    '<div style="font-size:8px;color:#555;line-height:1.8">'+ph+'<br>'+form.email+'</div>' +
    '</div>' +
    '<div style="flex:1"><div style="font-size:14px;font-weight:700;margin-bottom:4px">âœ… ååˆºã‚’ä½œæˆã™ã‚‹</div>' +
    '<div style="font-size:11px;color:var(--sub);line-height:1.8">100æš / COREBLDGãƒ‡ã‚¶ã‚¤ãƒ³<br><strong style="color:var(--gold)">Â¥2,000</strong> â€” å…¥ä¼šæ™‚ã«ä¸€æ‹¬æ±ºæ¸ˆ<br>ç´æœŸï¼šæ‰¿èªå¾Œ ç´„1é€±é–“</div></div>' +
    '<span class="pill pgd" style="align-self:flex-start">ãŠã™ã™ã‚</span></div>' +
    '<div id="bc-no" class="bc-opt'+(form.wantCard===false?' sel-no':'')+'" onclick="selCard(false)">' +
    '<input type="radio" name="bc"'+(form.wantCard===false?' checked':'')+' onclick="selCard(false)">' +
    '<div style="width:70px;height:44px;background:var(--border);border-radius:6px;display:flex;align-items:center;justify-content:center;flex-shrink:0"><span style="font-size:20px;opacity:.3">ğŸš«</span></div>' +
    '<div><div style="font-size:14px;font-weight:700;margin-bottom:4px">ä»Šå›ã¯ä¸è¦</div>' +
    '<div style="font-size:11px;color:var(--sub);line-height:1.8">å¾Œã‹ã‚‰ãƒã‚¤ãƒšãƒ¼ã‚¸ã§Â¥2,000ã§ç™ºæ³¨å¯èƒ½</div></div></div>' +
    '<div style="margin-top:20px"><button class="btn-primary" id="bc-next" onclick="validateStep2()"'+(form.wantCard===null?' disabled':'')+'>æ¬¡ã¸ â†’</button>' +
    '<button class="btn-back" onclick="goStep(1)">â† æˆ»ã‚‹</button></div>' +
    '</div></div>';
}

function selCard(want) {
  form.wantCard = want;
  document.getElementById('bc-yes').className='bc-opt'+(want?' sel-yes':'');
  document.getElementById('bc-no').className='bc-opt'+(!want?' sel-no':'');
  document.getElementById('bc-next').disabled=false;
}
function validateStep2() {
  if(form.wantCard===null){alert('ååˆºã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’é¸æŠã—ã¦ãã ã•ã„');return;}
  goStep(3);
}

// STEP 3 - æ±ºæ¸ˆ
function step3() {
  var monthly=0, cardFee=form.wantCard?2000:0, total=monthly+cardFee;
  document.getElementById('wrap').innerHTML = '<div class="card"><div class="ch"><div class="ch-t">æ±ºæ¸ˆæƒ…å ±</div><span class="pill pb">4 / 5</span></div><div class="cb">' +
    '<div style="background:var(--card2);border:1px solid var(--border);border-radius:11px;padding:16px;margin-bottom:20px">' +
    '<div style="font-size:10px;color:var(--muted);margin-bottom:10px;font-weight:600">ä»Šå›ã®æ±ºæ¸ˆå†…å®¹</div>' +
    '<div class="sum-row"><span>æœˆé¡ä¼šè²»ï¼ˆåˆæœˆï¼‰</span><span class="mono">Â¥'+monthly.toLocaleString()+'</span></div>' +
    (form.wantCard
      ? '<div class="sum-row"><span>ååˆºä½œæˆè²»ï¼ˆ100æšï¼‰<span class="pill pgd" style="margin-left:6px">ä»»æ„</span></span><span class="mono">Â¥'+cardFee.toLocaleString()+'</span></div>'
      : '<div class="sum-row" style="color:var(--muted)"><span>ååˆºä½œæˆè²»</span><span class="mono">ä¸è¦</span></div>') +
    '<div class="sum-row" style="font-weight:700;font-size:14px;border:none;padding-top:10px;margin-top:4px;border-top:1px solid var(--border2)"><span>åˆè¨ˆï¼ˆåˆå›ï¼‰</span><span class="mono" style="color:var(--gold)">Â¥'+total.toLocaleString()+'</span></div>' +
    '<div style="font-size:10px;color:var(--muted);margin-top:8px">â€» æœˆä¼šè²»ã¯ç„¡æ–™ã§ã™</div></div>' +
    '<div class="field"><label>ã‚«ãƒ¼ãƒ‰ç•ªå· <span class="req">*</span></label>' +
    '<input id="f-cn" type="text" placeholder="0000 0000 0000 0000" maxlength="19" oninput="fmtCard(this)" style="font-family:\'DM Mono\',monospace;letter-spacing:2px"></div>' +
    '<div class="g3"><div class="field" style="grid-column:span 2"><label>æœ‰åŠ¹æœŸé™ <span class="req">*</span></label>' +
    '<input id="f-exp" type="text" placeholder="MM / YY" maxlength="7" oninput="fmtExp(this)" style="font-family:\'DM Mono\',monospace"></div>' +
    '<div class="field"><label>CVC <span class="req">*</span></label>' +
    '<input id="f-cvc" type="text" placeholder="000" maxlength="4" style="font-family:\'DM Mono\',monospace"></div></div>' +
    '<div style="font-size:10px;color:var(--muted);margin-bottom:16px;line-height:1.8">ğŸ” ã‚«ãƒ¼ãƒ‰æƒ…å ±ã¯SSLæš—å·åŒ–é€šä¿¡ã§ä¿è­·ã•ã‚Œã¾ã™ã€‚ã‚«ãƒ¼ãƒ‰ç•ªå·ã¯COREBLDGã®ã‚µãƒ¼ãƒãƒ¼ã«ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚</div>' +
    '<button class="btn-primary btn-gold" onclick="validateStep3()">ğŸ’³ Â¥'+total.toLocaleString()+'ã‚’æ±ºæ¸ˆã—ã¦æ¬¡ã¸</button>' +
    '<button class="btn-back" onclick="goStep(2)">â† æˆ»ã‚‹</button>' +
    '</div></div>';
}

function fmtCard(el){var v=el.value.replace(/\D/g,'').slice(0,16);el.value=v.replace(/(\d{4})(?=\d)/g,'$1 ');}
function fmtExp(el){var v=el.value.replace(/\D/g,'').slice(0,4);if(v.length>=3)v=v.slice(0,2)+' / '+v.slice(2);el.value=v;}

function validateStep3() {
  var num=document.getElementById('f-cn').value.replace(/\s/g,'');
  var exp=document.getElementById('f-exp').value;
  var cvc=document.getElementById('f-cvc').value;
  if(num.length<16||!exp||cvc.length<3){alert('ã‚«ãƒ¼ãƒ‰æƒ…å ±ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„');return;}
  form.cardLast4='Â·Â·Â·Â·'+num.slice(-4);
  var btn=event.target; btn.disabled=true; btn.textContent='â³ æ±ºæ¸ˆå‡¦ç†ä¸­...';
  setTimeout(function(){goStep(4);},1600);
}

// STEP 4 - ç¢ºèªé€ä¿¡
function step4() {
  var monthly=0, cardFee=form.wantCard?2000:0, total=monthly+cardFee;
  var rows=[
    ['æ°å',form.name+' ('+form.nameKana+')'],
    ['é›»è©±ç•ªå·',form.phone],['ãƒ¡ãƒ¼ãƒ«',form.email],['LINE ID',form.lineId],
    ['ä½æ‰€',form.postal+' '+form.address],
    form.company?['ä¼šç¤¾å',form.company]:null,
    form.referralCode?['ç´¹ä»‹ã‚³ãƒ¼ãƒ‰',form.referralCode]:null,
    ['ååˆºä½œæˆ',form.wantCard?'âœ… å¸Œæœ›ï¼ˆÂ¥2,000 æ±ºæ¸ˆæ¸ˆã¿ï¼‰':'âŒ ä»Šå›ã¯ä¸è¦'],
    ['æœˆä¼šè²»','Â¥0ï¼ˆç„¡æ–™ï¼‰'],['ç™»éŒ²ã‚«ãƒ¼ãƒ‰',form.cardLast4],
  ].filter(Boolean);
  document.getElementById('wrap').innerHTML = '<div class="card"><div class="ch"><div class="ch-t">ç”³è¾¼å†…å®¹ã®ç¢ºèª</div><span class="pill pb">5 / 5</span></div><div class="cb">' +
    '<div class="al al-ok" style="margin-bottom:20px">âœ… <div>æ±ºæ¸ˆãŒå®Œäº†ã—ã¾ã—ãŸï¼ˆÂ¥'+total.toLocaleString()+'ï¼‰ã€‚å†…å®¹ã‚’ç¢ºèªã—ã¦ç”³è¾¼ã¿ã‚’ç¢ºå®šã—ã¦ãã ã•ã„ã€‚</div></div>' +
    '<div>' + rows.map(function(r){return '<div class="sum-row"><span style="color:var(--sub);min-width:100px">'+r[0]+'</span><span>'+r[1]+'</span></div>';}).join('') + '</div>' +
    '<div style="background:var(--card2);border:1px solid var(--border);border-radius:10px;padding:14px;margin:16px 0;font-size:11px;color:var(--sub);line-height:2">' +
    'ğŸ“Œ ç”³è¾¼ç¢ºå®šå¾Œã€HQãŒå¯©æŸ»ï¼ˆ1ã€œ3å–¶æ¥­æ—¥ï¼‰<br>ğŸ“Œ æ‰¿èªå¾ŒLINEã«é€šçŸ¥ â†’ ãƒ­ã‚°ã‚¤ãƒ³IDç™ºè¡Œ<br>ğŸ“Œ æ¥­å‹™å§”è¨—å¥‘ç´„æ›¸ã¸ã®é›»å­ç½²åãŒå¿…è¦ã§ã™ï¼ˆæ‰¿èªé€šçŸ¥ã®ãƒªãƒ³ã‚¯ã‹ã‚‰ç½²åï¼‰<br>' +
    (form.wantCard?'ğŸ“Œ ååˆºã¯HQãŒãƒ‡ã‚¶ã‚¤ãƒ³ç¢ºèªå¾Œã€å°åˆ·æ¥­è€…ã¸ç™ºæ³¨ï¼ˆç´„1é€±é–“ã§åˆ°ç€ï¼‰<br>':'')+
    '</div>' +
    '<button class="btn-primary" onclick="submitSignup()">âœ… ç”³è¾¼ã¿ã‚’ç¢ºå®šã™ã‚‹</button>' +
    '</div></div>';
}

function submitSignup() {
  console.log('Slack #å…¥ä¼šç”³è¾¼:\nğŸ†• ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼å…¥ä¼šç”³è¾¼\n'+form.name+' / '+form.phone+' / LINE:'+form.lineId+' / ååˆº:'+form.wantCard);
  document.getElementById('wrap').innerHTML =
    '<div style="text-align:center;padding:60px 20px">' +
    '<div style="font-size:56px;margin-bottom:20px">ğŸ‰</div>' +
    '<div style="font-family:\'Syne\',sans-serif;font-size:22px;font-weight:800;color:var(--gold);margin-bottom:12px">ç”³è¾¼ã¿ãŒå®Œäº†ã—ã¾ã—ãŸï¼</div>' +
    '<div style="font-size:13px;color:var(--sub);line-height:2;max-width:400px;margin:0 auto 28px">' +
    form.name+' æ§˜ã€ã”ç”³è¾¼ã¿ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚<br>HQã®å¯©æŸ»å¾Œï¼ˆ1ã€œ3å–¶æ¥­æ—¥ï¼‰ã€LINEã«æ‰¿èªé€šçŸ¥ã‚’ãŠé€ã‚Šã—ã¾ã™ã€‚<br>æ‰¿èªé€šçŸ¥ã®ãƒªãƒ³ã‚¯ã‹ã‚‰æ¥­å‹™å§”è¨—å¥‘ç´„æ›¸ã¸ã®é›»å­ç½²åã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚' +
    (form.wantCard?'<br>ååˆºã¯HQãŒãƒ‡ã‚¶ã‚¤ãƒ³ç¢ºèªå¾Œã«ç™ºæ³¨ã—ã¾ã™ï¼ˆç´„1é€±é–“ã§åˆ°ç€ï¼‰ã€‚':'')+
    '</div>' +
    '<div style="display:inline-block;background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px 24px;text-align:left;font-size:12px;margin-bottom:24px">' +
    '<div style="font-size:10px;color:var(--muted);margin-bottom:8px">å—ä»˜æƒ…å ±</div>' +
    '<div>å—ä»˜ç•ªå·ï¼š<span class="mono" style="color:var(--gold)">PT-APP-'+Date.now().toString().slice(-8)+'</span></div>' +
    '<div style="margin-top:4px">ç”³è¾¼æ—¥æ™‚ï¼š'+new Date().toLocaleString('ja-JP')+'</div>' +
    '</div><br>' +
    '<a href="coreto-hub.html" style="color:var(--blue);font-size:12px">â† COREBLDGãƒˆãƒƒãƒ—ã«æˆ»ã‚‹</a>' +
    '</div>';
  for(var i=0;i<5;i++){var el=document.getElementById('s'+i);el.className='step done';el.querySelector('.step-dot').textContent='âœ“';}
}

goStep(0);
</script>
</body>
</html>
