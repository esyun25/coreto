<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CORETO â€” LINEé€£æº</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=DM+Mono:wght@400;500&family=Syne:wght@700;800&display=swap');
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#07090f;--card:#0f1119;--card2:#141720;--border:#1e2235;--border2:#252a3d;
  --gold:#c9a84c;--gold-dim:#7a5f22;--blue:#4f9cf9;--green:#34d399;--red:#f87171;
  --orange:#fb923c;--purple:#a78bfa;--line:#00b900;
  --muted:#4a5270;--sub:#7a849e;--text:#e2e6f3;
}
html,body{min-height:100%;font-family:'Noto Sans JP',sans-serif;background:var(--bg);color:var(--text)}
.hdr{height:54px;display:flex;align-items:center;justify-content:space-between;
  padding:0 26px;border-bottom:1px solid var(--border);
  background:rgba(7,9,15,.95);position:sticky;top:0;z-index:100}
.logo{font-family:'Syne',sans-serif;font-size:17px;font-weight:800;color:var(--gold);letter-spacing:3px}
/* Tab bar */
.tabs{display:flex;border-bottom:1px solid var(--border);background:var(--card);
  padding:0 24px;position:sticky;top:54px;z-index:90}
.tab{padding:14px 22px;font-size:12px;font-weight:700;color:var(--muted);cursor:pointer;
  border-bottom:2px solid transparent;transition:.15s;margin-bottom:-1px}
.tab:hover{color:var(--sub)}
.tab.on{color:var(--blue);border-bottom-color:var(--blue)}
/* Layout */
.main{max-width:900px;margin:0 auto;padding:28px 24px 80px}
/* Cards */
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;margin-bottom:16px}
.ch{padding:13px 20px;border-bottom:1px solid var(--border);
  display:flex;align-items:center;justify-content:space-between}
.ch-t{font-size:9px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;
  display:flex;align-items:center;gap:8px}
.ch-t::before{content:'';width:3px;height:11px;border-radius:2px;background:var(--line)}
.cb{padding:18px 20px}
/* Pills */
.pill{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;
  border-radius:6px;font-size:9px;font-weight:700}
.pg{background:rgba(52,211,153,.13);color:var(--green);border:1px solid rgba(52,211,153,.3)}
.pb{background:rgba(79,156,249,.12);color:var(--blue);border:1px solid rgba(79,156,249,.25)}
.pr{background:rgba(248,113,113,.12);color:var(--red);border:1px solid rgba(248,113,113,.3)}
.pm{background:rgba(74,82,112,.15);color:var(--sub);border:1px solid var(--border2)}
.pl{background:rgba(0,185,0,.12);color:var(--line);border:1px solid rgba(0,185,0,.3)}
/* Buttons */
.btn{padding:9px 18px;border-radius:9px;font-size:11px;font-weight:700;cursor:pointer;
  font-family:'Noto Sans JP',sans-serif;transition:.15s;border:none;
  display:inline-flex;align-items:center;gap:6px}
.btn-line{background:#00b900;color:#fff}
.btn-line:hover{filter:brightness(1.1)}
.btn-blue{background:linear-gradient(135deg,var(--blue),#3070c0);color:#fff}
.btn-ghost{background:transparent;border:1px solid var(--border2);color:var(--sub)}
.btn-ghost:hover{color:var(--text);border-color:var(--sub)}
.btn-ok{background:rgba(52,211,153,.12);border:1px solid rgba(52,211,153,.3);color:var(--green)}
.btn-danger{background:rgba(248,113,113,.12);border:1px solid rgba(248,113,113,.3);color:var(--red)}
.btn-sm{padding:5px 12px;font-size:10px;border-radius:7px}
.btn:disabled{opacity:.4;cursor:not-allowed}
/* Code display */
.code-box{
  background:var(--card2);border:2px solid var(--border2);border-radius:16px;
  padding:28px 24px;text-align:center;position:relative;overflow:hidden
}
.code-box::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(0,185,0,.05) 0%,transparent 60%);
  pointer-events:none
}
.code-digits{
  display:flex;gap:10px;justify-content:center;margin:16px 0
}
.code-digit{
  width:52px;height:64px;background:#090b13;border:2px solid var(--border2);
  border-radius:12px;display:flex;align-items:center;justify-content:center;
  font-family:'DM Mono',monospace;font-size:28px;font-weight:700;
  color:var(--gold);letter-spacing:0;transition:.3s
}
.code-digit.revealed{border-color:var(--line);background:rgba(0,185,0,.05);color:#00d900}
/* Timer ring */
.timer-wrap{display:flex;align-items:center;justify-content:center;gap:10px;margin:12px 0}
.timer-ring{width:40px;height:40px;position:relative}
.timer-ring svg{transform:rotate(-90deg)}
.timer-ring circle{fill:none;stroke-width:3}
.timer-ring .bg{stroke:var(--border2)}
.timer-ring .fg{stroke:var(--line);stroke-linecap:round;transition:stroke-dashoffset 1s linear}
.timer-ring .expired{stroke:var(--red)}
/* Table */
.tbl{width:100%;border-collapse:collapse}
.tbl th{padding:9px 14px;font-size:9px;color:var(--muted);font-weight:700;letter-spacing:.5px;
  text-transform:uppercase;border-bottom:1px solid var(--border);background:var(--card2);text-align:left}
.tbl td{padding:10px 14px;border-bottom:1px solid rgba(30,34,53,.5);font-size:12px;vertical-align:middle}
.tbl tr:last-child td{border:none}
.tbl tr:hover td{background:rgba(255,255,255,.013)}
.mono{font-family:'DM Mono',monospace}
/* KPI */
.kpi-row{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:20px}
.kpi{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px 16px}
.kv{font-family:'DM Mono',monospace;font-size:24px;font-weight:500;margin-bottom:3px}
.kl{font-size:10px;color:var(--muted)}
/* Input */
.field{margin-bottom:12px}
.field label{display:block;font-size:10px;color:var(--sub);margin-bottom:5px;font-weight:600}
.field input,.field select{width:100%;background:#090b13;border:1px solid var(--border2);
  border-radius:9px;padding:9px 13px;color:var(--text);font-size:13px;
  font-family:'Noto Sans JP',sans-serif;outline:none;transition:.15s}
.field input:focus,.field select:focus{border-color:var(--blue)}
/* Alert */
.al{display:flex;align-items:flex-start;gap:10px;padding:12px 16px;border-radius:10px;
  margin-bottom:14px;font-size:12px;line-height:1.7}
.al-info{background:rgba(79,156,249,.07);border:1px solid rgba(79,156,249,.2)}
.al-ok{background:rgba(52,211,153,.07);border:1px solid rgba(52,211,153,.2)}
.al-line{background:rgba(0,185,0,.07);border:1px solid rgba(0,185,0,.25)}
/* Status dot */
.dot-live{width:8px;height:8px;border-radius:50%;background:var(--green);
  display:inline-block;box-shadow:0 0 0 3px rgba(52,211,153,.2);margin-right:5px}
.dot-none{width:8px;height:8px;border-radius:50%;background:var(--muted);
  display:inline-block;margin-right:5px}
::-webkit-scrollbar{width:4px}
::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px}
</style>
</head>
<body>

<div class="hdr">
  <div style="display:flex;align-items:center;gap:12px">
    <div class="logo">CORETO</div>
    <div style="width:1px;height:18px;background:var(--border2)"></div>
    <span style="font-size:10px;color:var(--muted);letter-spacing:1px">LINEé€£æºç®¡ç†</span>
  </div>
  <div style="display:flex;align-items:center;gap:8px">
    <span style="font-size:11px;color:var(--sub)" id="hdr-user">å±±ç”° èª ï¼ˆ10012ï¼‰</span>
    <button class="btn btn-ghost btn-sm" onclick="location.href='coreto-hub.html'">ğŸ  ãƒ›ãƒ¼ãƒ </button>
  </div>
</div>

<div class="tabs">
  <div class="tab on" id="tab-agent" onclick="showView('agent')">ğŸ’¬ LINEé€£æºã™ã‚‹</div>
  <div class="tab" id="tab-hq"    onclick="showView('hq')">ğŸ¢ HQ ç´ä»˜ã‘ç®¡ç†</div>
</div>

<div class="main">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     VIEW: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå´ LINEé€£æº
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="view-agent">

  <!-- ç¾åœ¨ã®é€£æºçŠ¶æ³ -->
  <div class="card">
    <div class="ch">
      <div class="ch-t">ç¾åœ¨ã®é€£æºçŠ¶æ³</div>
      <span class="pill" id="status-pill" style="background:rgba(74,82,112,.15);color:var(--sub);border:1px solid var(--border2)">æœªé€£æº</span>
    </div>
    <div class="cb" id="status-body">
      <!-- JS ã§æç”» -->
    </div>
  </div>

  <!-- é€£æºæ‰‹é † -->
  <div class="card" id="link-card">
    <div class="ch"><div class="ch-t">LINEé€£æºã®æ‰‹é †</div></div>
    <div class="cb">

      <!-- Step 1 -->
      <div style="display:flex;gap:14px;margin-bottom:20px;align-items:flex-start">
        <div style="width:28px;height:28px;border-radius:50%;background:var(--line);flex-shrink:0;
                    display:flex;align-items:center;justify-content:center;font-size:12px;
                    font-weight:700;color:#fff">1</div>
        <div style="flex:1">
          <div style="font-size:13px;font-weight:700;margin-bottom:6px">CORETOå…¬å¼LINEã‚’å‹é”è¿½åŠ ã™ã‚‹</div>
          <div style="font-size:11px;color:var(--sub);margin-bottom:12px;line-height:1.8">
            ã¾ã è¿½åŠ ã—ã¦ã„ãªã„å ´åˆã¯ã€ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰å‹é”è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
          </div>
          <a href="https://line.me/R/ti/p/@coreto_official" target="_blank"
             style="display:inline-flex;align-items:center;gap:8px;padding:10px 20px;
                    background:#00b900;color:#fff;border-radius:10px;font-size:12px;
                    font-weight:700;text-decoration:none;font-family:'Noto Sans JP',sans-serif">
            <svg width="18" height="18" viewBox="0 0 48 48" fill="white">
              <path d="M24 4C12.95 4 4 11.86 4 21.5c0 5.8 3.27 10.95 8.4 14.24-.37 1.36-1.34 4.94-1.54 5.7-.24.94.35.93.73.68.3-.19 4.73-3.14 6.64-4.41.88.12 1.78.19 2.77.19 11.05 0 20-7.86 20-17.5S35.05 4 24 4z"/>
            </svg>
            CORETOå…¬å¼LINEã‚’å‹é”è¿½åŠ ã™ã‚‹
          </a>
        </div>
      </div>

      <!-- Divider -->
      <div style="width:2px;height:24px;background:var(--border2);margin-left:13px;margin-bottom:20px"></div>

      <!-- Step 2 -->
      <div style="display:flex;gap:14px;margin-bottom:20px;align-items:flex-start">
        <div style="width:28px;height:28px;border-radius:50%;background:var(--blue);flex-shrink:0;
                    display:flex;align-items:center;justify-content:center;font-size:12px;
                    font-weight:700;color:#fff">2</div>
        <div style="flex:1">
          <div style="font-size:13px;font-weight:700;margin-bottom:6px">é€£æºã‚³ãƒ¼ãƒ‰ã‚’ç™ºè¡Œã™ã‚‹</div>
          <div style="font-size:11px;color:var(--sub);margin-bottom:12px;line-height:1.8">
            ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨6æ¡ã®ã‚³ãƒ¼ãƒ‰ãŒç™ºè¡Œã•ã‚Œã¾ã™ï¼ˆæœ‰åŠ¹æœŸé™ï¼š30åˆ†ï¼‰ã€‚
          </div>

          <div id="code-area">
            <button class="btn btn-blue" onclick="generateCode()" id="gen-btn">
              ğŸ”‘ é€£æºã‚³ãƒ¼ãƒ‰ã‚’ç™ºè¡Œã™ã‚‹
            </button>
          </div>

          <!-- ã‚³ãƒ¼ãƒ‰è¡¨ç¤ºï¼ˆç™ºè¡Œå¾Œï¼‰ -->
          <div id="code-display" style="display:none;margin-top:14px">
            <div class="code-box">
              <div style="font-size:10px;color:var(--muted);letter-spacing:1.5px;
                          text-transform:uppercase;margin-bottom:8px">é€£æºã‚³ãƒ¼ãƒ‰</div>
              <div class="code-digits" id="code-digits">
                <!-- JS ã§æç”» -->
              </div>
              <div class="timer-wrap">
                <div class="timer-ring">
                  <svg width="40" height="40" viewBox="0 0 40 40">
                    <circle class="bg" cx="20" cy="20" r="17" stroke-dasharray="107" stroke-dashoffset="0"/>
                    <circle class="fg" id="timer-ring-fg" cx="20" cy="20" r="17"
                            stroke-dasharray="107" stroke-dashoffset="0"/>
                  </svg>
                </div>
                <div>
                  <div style="font-family:'DM Mono',monospace;font-size:16px;font-weight:700" id="timer-text">30:00</div>
                  <div style="font-size:9px;color:var(--muted)">æœ‰åŠ¹æœŸé™</div>
                </div>
              </div>
              <div style="font-size:11px;color:var(--muted)">æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚ŒãŸã‚‰å†ç™ºè¡Œã—ã¦ãã ã•ã„</div>
            </div>
          </div>
        </div>
      </div>

      <div style="width:2px;height:24px;background:var(--border2);margin-left:13px;margin-bottom:20px"></div>

      <!-- Step 3 -->
      <div style="display:flex;gap:14px;align-items:flex-start">
        <div style="width:28px;height:28px;border-radius:50%;background:var(--line);flex-shrink:0;
                    display:flex;align-items:center;justify-content:center;font-size:12px;
                    font-weight:700;color:#fff">3</div>
        <div style="flex:1">
          <div style="font-size:13px;font-weight:700;margin-bottom:6px">LINEã§ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã™ã‚‹</div>
          <div style="font-size:11px;color:var(--sub);line-height:1.9">
            CORETOå…¬å¼LINEã®ãƒˆãƒ¼ã‚¯ã‚’é–‹ãã€ä¸Šã®6æ¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ãã®ã¾ã¾é€ä¿¡ã—ã¦ãã ã•ã„ã€‚<br>
            ä¾‹ï¼šã€Œ<span style="font-family:'DM Mono',monospace;color:var(--gold)">381924</span>ã€ã¨é€ä¿¡ã™ã‚‹<br><br>
            âœ… ãƒœãƒƒãƒˆãŒã€Œå±±ç”° èª ï¼ˆ10012ï¼‰æ§˜ã€LINEé€£æºãŒå®Œäº†ã—ã¾ã—ãŸã€ã¨è¿”ä¿¡ã—ãŸã‚‰å®Œäº†ã§ã™ã€‚
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- é€£æºå®Œäº†æ¸ˆã¿è¡¨ç¤ºï¼ˆé€£æºå¾Œã«è¡¨ç¤ºï¼‰ -->
  <div class="card" id="linked-card" style="display:none">
    <div class="ch">
      <div class="ch-t">LINEé€£æºæƒ…å ±</div>
      <button class="btn btn-danger btn-sm" onclick="unlinkLine()">é€£æºã‚’è§£é™¤ã™ã‚‹</button>
    </div>
    <div class="cb">
      <div class="al al-ok" style="margin-bottom:16px">
        <span class="dot-live"></span>
        <div>LINEé€£æºãŒå®Œäº†ã—ã¦ã„ã¾ã™ã€‚èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚„é€šçŸ¥ã¯ã“ã®LINEã«å±Šãã¾ã™ã€‚</div>
      </div>
      <div style="display:flex;flex-direction:column;gap:0">
        <div style="display:flex;justify-content:space-between;padding:10px 0;
                    border-bottom:1px solid rgba(30,34,53,.4);font-size:12px">
          <span style="color:var(--sub)">é€£æºã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</span>
          <span style="color:var(--line);font-weight:700">@yamada_makoto</span>
        </div>
        <div style="display:flex;justify-content:space-between;padding:10px 0;
                    border-bottom:1px solid rgba(30,34,53,.4);font-size:12px">
          <span style="color:var(--sub)">LINEè¡¨ç¤ºå</span>
          <span>å±±ç”°èª ğŸ </span>
        </div>
        <div style="display:flex;justify-content:space-between;padding:10px 0;font-size:12px">
          <span style="color:var(--sub)">é€£æºæ—¥æ™‚</span>
          <span class="mono" style="font-size:11px">2026/01/15 14:32</span>
        </div>
      </div>
    </div>
  </div>

</div><!-- /view-agent -->


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     VIEW: HQ ç´ä»˜ã‘ç®¡ç†
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="view-hq" style="display:none">

  <div class="kpi-row">
    <div class="kpi"><div class="kv" style="color:var(--line)">18</div><div class="kl">LINEé€£æºæ¸ˆã¿</div></div>
    <div class="kpi"><div class="kv" style="color:var(--orange)">6</div><div class="kl">æœªé€£æº</div></div>
    <div class="kpi"><div class="kv" style="color:var(--blue)">3</div><div class="kl">ã‚³ãƒ¼ãƒ‰ç™ºè¡Œä¸­ï¼ˆæœ‰åŠ¹æœŸé™å†…ï¼‰</div></div>
    <div class="kpi"><div class="kv" style="color:var(--muted)">2</div><div class="kl">ã‚³ãƒ¼ãƒ‰æœŸé™åˆ‡ã‚Œ</div></div>
  </div>

  <!-- é€£æºæ¸ˆã¿ä¸€è¦§ -->
  <div class="card">
    <div class="ch">
      <div class="ch-t">é€£æºæ¸ˆã¿ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</div>
      <div style="display:flex;gap:8px">
        <input type="text" id="hq-search" placeholder="IDãƒ»æ°åã§æ¤œç´¢..."
               oninput="filterTable()"
               style="background:#090b13;border:1px solid var(--border2);color:var(--text);
                      padding:5px 12px;border-radius:7px;font-size:11px;outline:none;width:160px">
        <button class="btn btn-ghost btn-sm" onclick="exportCSV()">ğŸ“¥ CSV</button>
      </div>
    </div>
    <div style="overflow-x:auto">
      <table class="tbl" id="linked-table">
        <thead><tr>
          <th>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆID</th><th>æ°å</th><th>ç¨®åˆ¥</th><th>LINEè¡¨ç¤ºå</th>
          <th>LINE User ID</th><th>é€£æºæ—¥æ™‚</th><th>çŠ¶æ…‹</th><th>æ“ä½œ</th>
        </tr></thead>
        <tbody id="linked-tbody">
          <!-- JS ã§æç”» -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- æœªé€£æºã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ -->
  <div class="card">
    <div class="ch">
      <div class="ch-t">æœªé€£æºã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</div>
      <button class="btn btn-ghost btn-sm" onclick="remindAll()">ğŸ“¨ å…¨å“¡ã«Slackã§é€£æºä¾é ¼</button>
    </div>
    <div style="overflow-x:auto">
      <table class="tbl">
        <thead><tr>
          <th>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆID</th><th>æ°å</th><th>ç¨®åˆ¥</th><th>å…¥ä¼šæ—¥</th>
          <th>ã‚³ãƒ¼ãƒ‰çŠ¶æ…‹</th><th>æ“ä½œ</th>
        </tr></thead>
        <tbody id="unlinked-tbody">
          <!-- JS ã§æç”» -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- æ‰‹å‹•ç´ä»˜ã‘ï¼ˆHQæ“ä½œï¼‰ -->
  <div class="card">
    <div class="ch"><div class="ch-t">æ‰‹å‹•ç´ä»˜ã‘ï¼ˆHQæ“ä½œï¼‰</div></div>
    <div class="cb">
      <div class="al al-info" style="margin-bottom:16px">
        â„¹ï¸ <div>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè‡ªåŠ›ã§é€£æºã§ããªã„å ´åˆã‚„ã€ç®¡ç†ä¸Šã®ç†ç”±ã§HQãŒç›´æ¥ç´ä»˜ã‘ã‚’è¡Œã†å ´åˆã«ä½¿ç”¨ã—ã¾ã™ã€‚<br>
        LINE User IDã¯LINE Official Account Managerã®å‹é”ãƒªã‚¹ãƒˆã‹ã‚‰ç¢ºèªã§ãã¾ã™ã€‚</div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr 1fr auto;gap:12px;align-items:end">
        <div class="field" style="margin:0">
          <label>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆID</label>
          <input type="text" id="manual-agent-id" placeholder="ä¾‹ï¼š10012"
                 style="font-family:'DM Mono',monospace">
        </div>
        <div class="field" style="margin:0">
          <label>LINE User ID</label>
          <input type="text" id="manual-line-uid" placeholder="ä¾‹ï¼šU3f2a8c1d..."
                 style="font-family:'DM Mono',monospace;font-size:11px">
        </div>
        <div class="field" style="margin:0">
          <label>LINE è¡¨ç¤ºåï¼ˆç¢ºèªç”¨ï¼‰</label>
          <input type="text" id="manual-line-name" placeholder="ä¾‹ï¼šå±±ç”°èª ğŸ ">
        </div>
        <button class="btn btn-blue" onclick="manualLink()" style="height:40px;white-space:nowrap">
          ğŸ”— ç´ä»˜ã‘å®Ÿè¡Œ
        </button>
      </div>
    </div>
  </div>

  <!-- ã‚³ãƒ¼ãƒ‰ç™ºè¡Œå±¥æ­´ -->
  <div class="card">
    <div class="ch">
      <div class="ch-t">é€£æºã‚³ãƒ¼ãƒ‰ ç™ºè¡Œãƒ­ã‚°</div>
      <span class="pill pm">ç›´è¿‘7æ—¥</span>
    </div>
    <div style="overflow-x:auto">
      <table class="tbl">
        <thead><tr>
          <th>ã‚³ãƒ¼ãƒ‰</th><th>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</th><th>ç™ºè¡Œæ—¥æ™‚</th><th>æœ‰åŠ¹æœŸé™</th><th>çŠ¶æ…‹</th>
        </tr></thead>
        <tbody>
          <tr>
            <td class="mono" style="color:var(--gold);letter-spacing:3px">381924</td>
            <td>å±±ç”° èª ï¼ˆ10012ï¼‰</td>
            <td class="mono" style="font-size:10px">2026/02/21 14:32</td>
            <td class="mono" style="font-size:10px">2026/02/21 15:02</td>
            <td><span class="pill pg">âœ“ é€£æºæ¸ˆã¿</span></td>
          </tr>
          <tr>
            <td class="mono" style="color:var(--orange);letter-spacing:3px">729041</td>
            <td>éˆ´æœ¨ å¥å¤ªï¼ˆ10023ï¼‰</td>
            <td class="mono" style="font-size:10px">2026/02/20 09:15</td>
            <td class="mono" style="font-size:10px">2026/02/20 09:45</td>
            <td><span class="pill pb">ç™ºè¡Œä¸­</span></td>
          </tr>
          <tr>
            <td class="mono" style="color:var(--muted);letter-spacing:3px">504817</td>
            <td>æ¸¡è¾º éš†ï¼ˆ10041ï¼‰</td>
            <td class="mono" style="font-size:10px">2026/02/19 16:44</td>
            <td class="mono" style="font-size:10px">2026/02/19 17:14</td>
            <td><span class="pill pr">æœŸé™åˆ‡ã‚Œ</span></td>
          </tr>
          <tr>
            <td class="mono" style="color:var(--green);letter-spacing:3px">163082</td>
            <td>ä½è—¤ èŠ±å­ï¼ˆ10008ï¼‰</td>
            <td class="mono" style="font-size:10px">2026/02/18 11:20</td>
            <td class="mono" style="font-size:10px">2026/02/18 11:50</td>
            <td><span class="pill pg">âœ“ é€£æºæ¸ˆã¿</span></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

</div><!-- /view-hq -->
</div><!-- /main -->

<script>
// â”€â”€ Demo data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var LINKED = [
  { id:'10012', name:'å±±ç”° èª ',   type:'RE', lineDisplay:'å±±ç”°èª ğŸ ',      lineUid:'Uab12cd34ef', linkedAt:'2026/01/15 14:32', active:true },
  { id:'10008', name:'ä½è—¤ èŠ±å­', type:'RE', lineDisplay:'ã¯ãªã¡ã‚ƒã‚“ğŸ’',  lineUid:'U56gh78ij90', linkedAt:'2026/01/10 09:20', active:true },
  { id:'20005', name:'ç”°ä¸­ ç¾ç©‚', type:'HR', lineDisplay:'ç¾ç©‚ç”°ä¸­',      lineUid:'Ukl12mn34op', linkedAt:'2026/01/08 16:55', active:true },
  { id:'30007', name:'ä½è—¤ ç¾å’²', type:'PT', lineDisplay:'MisakiğŸŒ¸',     lineUid:'Uqr56st78uv', linkedAt:'2026/01/05 13:10', active:true },
];
var UNLINKED = [
  { id:'10023', name:'éˆ´æœ¨ å¥å¤ª', type:'RE', joinedAt:'2026/01/20', codeStatus:'ç™ºè¡Œä¸­' },
  { id:'10041', name:'æ¸¡è¾º éš†',   type:'RE', joinedAt:'2026/01/25', codeStatus:'æœŸé™åˆ‡ã‚Œ' },
  { id:'20009', name:'é«˜æ©‹ ä¸€éƒ', type:'HR', joinedAt:'2026/02/01', codeStatus:'æœªç™ºè¡Œ' },
];

// Current agent LINE status (demo: check if 10012 is linked)
var agentIsLinked = false; // toggle for demo

// â”€â”€ View switching â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showView(v) {
  document.getElementById('tab-agent').className = 'tab'+(v==='agent'?' on':'');
  document.getElementById('tab-hq').className    = 'tab'+(v==='hq'?' on':'');
  document.getElementById('view-agent').style.display = v==='agent'?'block':'none';
  document.getElementById('view-hq').style.display    = v==='hq'?'block':'none';
}

// â”€â”€ Agent view init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function initAgentView() {
  var pill = document.getElementById('status-pill');
  var body = document.getElementById('status-body');
  var linkCard = document.getElementById('link-card');
  var linkedCard = document.getElementById('linked-card');

  if (agentIsLinked) {
    pill.className = 'pill pl';
    pill.textContent = 'âœ“ é€£æºæ¸ˆã¿';
    body.innerHTML = '<div style="display:flex;align-items:center;gap:10px;font-size:12px">' +
      '<span class="dot-live"></span><span style="color:var(--green)">LINEé€£æºãŒå®Œäº†ã—ã¦ã„ã¾ã™</span></div>';
    linkCard.style.display = 'none';
    linkedCard.style.display = 'block';
  } else {
    pill.className = 'pill pm';
    pill.textContent = 'æœªé€£æº';
    body.innerHTML = '<div style="display:flex;align-items:center;gap:10px;font-size:12px">' +
      '<span class="dot-none"></span><span style="color:var(--muted)">ã¾ã LINEé€£æºãŒå®Œäº†ã—ã¦ã„ã¾ã›ã‚“ã€‚ä¸‹ã®æ‰‹é †ã«æ²¿ã£ã¦è¨­å®šã—ã¦ãã ã•ã„ã€‚</span></div>';
    linkCard.style.display = 'block';
    linkedCard.style.display = 'none';
  }
}

// â”€â”€ Code generation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var _code = '';
var _codeTimer = null;
var _codeSec = 1800; // 30åˆ†

function generateCode() {
  // 6æ¡ãƒ©ãƒ³ãƒ€ãƒ ã‚³ãƒ¼ãƒ‰
  _code = String(Math.floor(100000 + Math.random() * 900000));
  _codeSec = 1800;
  clearInterval(_codeTimer);

  document.getElementById('code-display').style.display = 'block';
  document.getElementById('gen-btn').textContent = 'ğŸ”„ ã‚³ãƒ¼ãƒ‰ã‚’å†ç™ºè¡Œã™ã‚‹';

  renderCodeDigits();
  startCodeTimer();
}

function renderCodeDigits() {
  var html = '';
  for (var i = 0; i < 6; i++) {
    html += '<div class="code-digit revealed" id="cd-' + i + '">' + _code[i] + '</div>';
  }
  document.getElementById('code-digits').innerHTML = html;
}

function startCodeTimer() {
  clearInterval(_codeTimer);
  var total = 1800;
  var circumference = 107; // 2*Ï€*17

  _codeTimer = setInterval(function() {
    _codeSec--;
    var m = Math.floor(_codeSec / 60);
    var s = _codeSec % 60;
    var timerText = document.getElementById('timer-text');
    var ringFg = document.getElementById('timer-ring-fg');
    if (!timerText) return;

    timerText.textContent = m + ':' + String(s).padStart(2, '0');
    var offset = circumference - (circumference * _codeSec / total);
    if (ringFg) {
      ringFg.style.strokeDashoffset = offset;
      if (_codeSec < 300) {
        ringFg.classList.add('expired');
        timerText.style.color = 'var(--red)';
      }
    }

    if (_codeSec <= 0) {
      clearInterval(_codeTimer);
      timerText.textContent = 'æœŸé™åˆ‡ã‚Œ';
      timerText.style.color = 'var(--red)';
      // æ¡ã‚’ç°è‰²ã«
      for (var i = 0; i < 6; i++) {
        var el = document.getElementById('cd-' + i);
        if (el) { el.style.color = 'var(--muted)'; el.style.borderColor = 'var(--border2)'; el.style.background = 'transparent'; }
      }
    }
  }, 1000);
}

function unlinkLine() {
  if (!confirm('LINEé€£æºã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ\nè§£é™¤å¾Œã¯èªè¨¼ã‚³ãƒ¼ãƒ‰ãŒLINEã«å±Šã‹ãªããªã‚Šã¾ã™ã€‚')) return;
  agentIsLinked = false;
  initAgentView();
}

// â”€â”€ HQ view functions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderHqTables() {
  // é€£æºæ¸ˆã¿
  var tbody = document.getElementById('linked-tbody');
  tbody.innerHTML = LINKED.map(function(r) {
    return '<tr>' +
      '<td class="mono" style="font-size:11px;color:var(--gold)">' + r.id + '</td>' +
      '<td style="font-weight:700">' + r.name + '</td>' +
      '<td><span class="pill ' + (r.type==='RE'?'pb':r.type==='HR'?'po':'pl') + '">' + r.type + '</span></td>' +
      '<td style="color:var(--line)">' + r.lineDisplay + '</td>' +
      '<td class="mono" style="font-size:10px;color:var(--muted)">' + r.lineUid + '</td>' +
      '<td class="mono" style="font-size:10px">' + r.linkedAt + '</td>' +
      '<td><span class="pill pg"><span class="dot-live" style="width:5px;height:5px"></span>é€£æºä¸­</span></td>' +
      '<td><button class="btn btn-danger btn-sm" onclick="hqUnlink(\'' + r.id + '\',\'' + r.name + '\')">è§£é™¤</button></td>' +
      '</tr>';
  }).join('');

  // æœªé€£æº
  var utbody = document.getElementById('unlinked-tbody');
  utbody.innerHTML = UNLINKED.map(function(r) {
    var statusPill = r.codeStatus === 'ç™ºè¡Œä¸­'
      ? '<span class="pill pb">ğŸ”‘ ç™ºè¡Œä¸­</span>'
      : r.codeStatus === 'æœŸé™åˆ‡ã‚Œ'
      ? '<span class="pill pr">æœŸé™åˆ‡ã‚Œ</span>'
      : '<span class="pill pm">æœªç™ºè¡Œ</span>';
    return '<tr>' +
      '<td class="mono" style="font-size:11px;color:var(--muted)">' + r.id + '</td>' +
      '<td style="font-weight:700">' + r.name + '</td>' +
      '<td><span class="pill ' + (r.type==='RE'?'pb':r.type==='HR'?'po':'pl') + '">' + r.type + '</span></td>' +
      '<td class="mono" style="font-size:11px">' + r.joinedAt + '</td>' +
      '<td>' + statusPill + '</td>' +
      '<td><div style="display:flex;gap:5px">' +
        '<button class="btn btn-ghost btn-sm" onclick="remindOne(\'' + r.id + '\',\'' + r.name + '\')">ğŸ“¨ é€£æºä¾é ¼</button>' +
      '</div></td>' +
      '</tr>';
  }).join('');
}

function filterTable() {
  var q = document.getElementById('hq-search').value.toLowerCase();
  var rows = document.querySelectorAll('#linked-tbody tr');
  rows.forEach(function(row) {
    row.style.display = row.textContent.toLowerCase().includes(q) ? '' : 'none';
  });
}

function hqUnlink(id, name) {
  if (!confirm(name + 'ï¼ˆ' + id + 'ï¼‰ã®LINEé€£æºã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ\næ¬¡å›ã®èªè¨¼ã‚³ãƒ¼ãƒ‰ãŒLINEã«å±Šã‹ãªããªã‚Šã¾ã™ã€‚')) return;
  LINKED = LINKED.filter(function(r) { return r.id !== id; });
  UNLINKED.push({ id:id, name:name, type:'RE', joinedAt:'â€”', codeStatus:'æœªç™ºè¡Œ' });
  renderHqTables();
  alert('âœ… ' + name + ' ã®LINEé€£æºã‚’è§£é™¤ã—ã¾ã—ãŸã€‚\nSlackã§æœ¬äººã«é€šçŸ¥ãŒå±Šãã¾ã™ã€‚');
}

function manualLink() {
  var agentId = document.getElementById('manual-agent-id').value.trim();
  var lineUid  = document.getElementById('manual-line-uid').value.trim();
  var lineName = document.getElementById('manual-line-name').value.trim();
  if (!agentId || !lineUid) { alert('ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆIDã¨LINE User IDã¯å¿…é ˆã§ã™'); return; }
  // ãƒ‡ãƒ¢: æœªé€£æºã‹ã‚‰é€£æºæ¸ˆã¿ã¸ç§»å‹•
  var target = UNLINKED.find(function(r) { return r.id === agentId; });
  if (!target) {
    if (!confirm('ID ' + agentId + ' ã¯æœªé€£æºãƒªã‚¹ãƒˆã«ã‚ã‚Šã¾ã›ã‚“ã€‚æ–°è¦ã§ç´ä»˜ã‘ã‚’è¿½åŠ ã—ã¾ã™ã‹ï¼Ÿ')) return;
    target = { id:agentId, name:'ï¼ˆID: '+agentId+'ï¼‰', type:'RE' };
  }
  LINKED.push({
    id: target.id, name: target.name, type: target.type,
    lineDisplay: lineName || 'ï¼ˆè¡¨ç¤ºåæœªå–å¾—ï¼‰',
    lineUid: lineUid,
    linkedAt: new Date().toLocaleString('ja-JP').replace(/\//g,'/').slice(0,-3),
    active: true
  });
  UNLINKED = UNLINKED.filter(function(r) { return r.id !== agentId; });
  document.getElementById('manual-agent-id').value = '';
  document.getElementById('manual-line-uid').value = '';
  document.getElementById('manual-line-name').value = '';
  renderHqTables();
  alert('âœ… æ‰‹å‹•ç´ä»˜ã‘ã‚’å®Ÿè¡Œã—ã¾ã—ãŸã€‚\nã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆID: ' + agentId + '\nLINE User ID: ' + lineUid);
}

function remindOne(id, name) {
  alert('ğŸ“¨ ' + name + 'ï¼ˆ' + id + 'ï¼‰ã«Slackã§LINEé€£æºä¾é ¼ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚');
}
function remindAll() {
  alert('ğŸ“¨ æœªé€£æºã®å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆ' + UNLINKED.length + 'åï¼‰ã«Slackã§LINEé€£æºä¾é ¼ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚');
}
function exportCSV() {
  var rows = [['ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆID','æ°å','ç¨®åˆ¥','LINEè¡¨ç¤ºå','LINE UserID','é€£æºæ—¥æ™‚']].concat(
    LINKED.map(function(r){ return [r.id,r.name,r.type,r.lineDisplay,r.lineUid,r.linkedAt]; })
  );
  var csv = rows.map(function(r){ return r.join(','); }).join('\n');
  var a = document.createElement('a');
  a.href = 'data:text/csv;charset=utf-8,\uFEFF'+encodeURIComponent(csv);
  a.download = 'coreto_line_links.csv';
  a.click();
}

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
initAgentView();
renderHqTables();
</script>
</body>
</html>
