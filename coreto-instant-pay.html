<!DOCTYPE html>
<html lang="ja">
<head>
  <!-- â”€â”€ Content Security Policy (XSSè»½æ¸›) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       å¤‰æ›´æ™‚: ä½¿ç”¨ã™ã‚‹å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚ªãƒªã‚¸ãƒ³ã‚’è¿½åŠ ã—ã¦ãã ã•ã„
       Kintoneè¿½åŠ æ™‚: connect-src ã« *.cybozu.com ã‚’è¿½åŠ 
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline'
      https://cdnjs.cloudflare.com
      https://js.stripe.com
      https://cdn-cgi/scripts;
    style-src 'self' 'unsafe-inline'
      https://fonts.googleapis.com;
    font-src 'self'
      https://fonts.gstatic.com;
    img-src 'self' data: blob:;
    connect-src 'self'
      https://hooks.slack.com
      https://hooks.zapier.com
      https://api.stripe.com
      https://js.stripe.com
      https://www.houjin-bangou.nta.go.jp
      https://www.retio.or.jp;
    frame-src 'none';
    object-src 'none';
    base-uri 'self';
  ">

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CORETO â€” å³æ™‚æ‰•ã„ç”³è«‹</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=DM+Mono:wght@400;500&family=Syne:wght@700;800&display=swap');
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#07090f;--card:#0f1119;--card2:#141720;--border:#1e2235;--border2:#252a3d;
  --gold:#c9a84c;--gold-dim:#7a5f22;--gold-bg:rgba(201,168,76,.07);
  --blue:#4f9cf9;--green:#34d399;--red:#f87171;--orange:#fb923c;--purple:#a78bfa;
  --muted:#4a5270;--sub:#7a849e;--text:#e2e6f3;
}
html,body{height:100%;font-family:'Noto Sans JP',sans-serif;background:var(--bg);color:var(--text)}

/* â”€â”€ Header â”€â”€ */
.header{display:flex;align-items:center;justify-content:space-between;padding:0 26px;height:54px;
  border-bottom:1px solid var(--border);background:rgba(7,9,15,.95);
  backdrop-filter:blur(14px);position:sticky;top:0;z-index:100;flex-shrink:0}
.logo{font-family:'Syne',sans-serif;font-size:17px;font-weight:800;color:var(--gold);letter-spacing:3px}

/* â”€â”€ View tabs â”€â”€ */
.view-tabs{display:flex;padding:0 26px;border-bottom:1px solid var(--border);background:var(--card2);flex-shrink:0}
.vt{padding:12px 20px;font-size:11px;font-weight:700;cursor:pointer;color:var(--muted);
  border-bottom:2px solid transparent;transition:all .15s;display:flex;align-items:center;gap:7px}
.vt.on{color:var(--blue);border-bottom-color:var(--blue)}

/* â”€â”€ Body â”€â”€ */
.body{max-width:960px;margin:0 auto;padding:28px 28px 80px}

/* â”€â”€ Section header â”€â”€ */
.sec-title{font-family:'Syne',sans-serif;font-size:17px;font-weight:800;margin-bottom:4px}
.sec-sub{font-size:11px;color:var(--sub);margin-bottom:22px}

/* â”€â”€ Cards â”€â”€ */
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;margin-bottom:16px}
.card-hdr{padding:14px 20px;border-bottom:1px solid var(--border);
  display:flex;align-items:center;justify-content:space-between}
.ch-title{font-size:9px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;
  display:flex;align-items:center;gap:8px}
.ch-title::before{content:'';width:3px;height:11px;border-radius:2px;background:var(--gold)}
.card-body{padding:20px}

/* â”€â”€ Pills â”€â”€ */
.pill{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:6px;font-size:9px;font-weight:700;white-space:nowrap}
.pill-green{background:rgba(52,211,153,.13);color:var(--green);border:1px solid rgba(52,211,153,.3)}
.pill-blue{background:rgba(79,156,249,.12);color:var(--blue);border:1px solid rgba(79,156,249,.25)}
.pill-orange{background:rgba(251,146,60,.12);color:var(--orange);border:1px solid rgba(251,146,60,.3)}
.pill-red{background:rgba(248,113,113,.12);color:var(--red);border:1px solid rgba(248,113,113,.3)}
.pill-muted{background:rgba(74,82,112,.15);color:var(--sub);border:1px solid var(--border2)}
.pill-gold{background:rgba(201,168,76,.13);color:var(--gold);border:1px solid var(--gold-dim)}

/* â”€â”€ Buttons â”€â”€ */
.btn{padding:9px 18px;border-radius:9px;font-size:11px;font-weight:700;cursor:pointer;
  font-family:'Noto Sans JP',sans-serif;transition:all .15s;border:none;
  display:inline-flex;align-items:center;gap:6px;white-space:nowrap}
.btn-gold{background:linear-gradient(135deg,var(--gold),#a8742a);color:#0a0c10}
.btn-gold:hover{filter:brightness(1.1);transform:translateY(-1px)}
.btn-blue{background:linear-gradient(135deg,var(--blue),#3070c0);color:#fff}
.btn-blue:hover{filter:brightness(1.1)}
.btn-ghost{background:transparent;border:1px solid var(--border2);color:var(--sub)}
.btn-ghost:hover{color:var(--text);border-color:var(--sub)}
.btn-danger{background:rgba(248,113,113,.12);border:1px solid rgba(248,113,113,.3);color:var(--red)}
.btn-success{background:rgba(52,211,153,.12);border:1px solid rgba(52,211,153,.3);color:var(--green)}
.btn-sm{padding:5px 12px;font-size:10px;border-radius:7px}
.btn:disabled{opacity:.4;cursor:not-allowed;transform:none!important}
.btn-lg{padding:14px 32px;font-size:14px;border-radius:11px}

/* â”€â”€ Fields â”€â”€ */
.field{margin-bottom:14px}
.field label{display:block;font-size:10px;color:var(--sub);margin-bottom:5px;font-weight:600}
.field input,.field select{width:100%;background:#090b13;border:1px solid var(--border2);
  border-radius:9px;padding:10px 14px;color:var(--text);font-size:13px;
  font-family:'Noto Sans JP',sans-serif;transition:border-color .15s;outline:none}
.field input:focus,.field select:focus{border-color:var(--blue)}
.field-hint{font-size:10px;color:var(--muted);margin-top:5px;line-height:1.7}
.req{color:var(--red)}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:14px}

/* â”€â”€ Alert â”€â”€ */
.alert{display:flex;align-items:flex-start;gap:10px;padding:12px 16px;border-radius:10px;
  margin-bottom:14px;font-size:12px;line-height:1.7}
.alert-warn{background:rgba(251,146,60,.07);border:1px solid rgba(251,146,60,.22)}
.alert-info{background:rgba(79,156,249,.07);border:1px solid rgba(79,156,249,.2)}
.alert-err{background:rgba(248,113,113,.08);border:1px solid rgba(248,113,113,.25)}
.alert-ok{background:rgba(52,211,153,.07);border:1px solid rgba(52,211,153,.22)}

/* â”€â”€ Table â”€â”€ */
.tbl{width:100%;border-collapse:collapse}
.tbl th{padding:9px 14px;font-size:9px;color:var(--muted);font-weight:700;
  letter-spacing:.5px;text-transform:uppercase;border-bottom:1px solid var(--border);
  background:var(--card2);text-align:left;white-space:nowrap}
.tbl td{padding:11px 14px;border-bottom:1px solid rgba(30,34,53,.5);font-size:12px;vertical-align:middle}
.tbl tr:last-child td{border:none}
.tbl tr:hover td{background:rgba(255,255,255,.012)}
.mono{font-family:'DM Mono',monospace}

/* â”€â”€ 2FA Screen â”€â”€ */
#tfa-screen{display:none;position:fixed;inset:0;background:var(--bg);z-index:500;
  align-items:center;justify-content:center;
  background-image:radial-gradient(ellipse at 30% 40%,rgba(79,156,249,.05),transparent 50%)}
.tfa-card{background:var(--card);border:1px solid var(--border2);border-radius:20px;
  width:420px;padding:40px 36px;text-align:center;position:relative;overflow:hidden}
.tfa-card::before{content:'';position:absolute;top:-40px;right:-40px;width:160px;height:160px;
  border-radius:50%;background:radial-gradient(circle,rgba(79,156,249,.07),transparent);
  pointer-events:none}
.tfa-logo{font-family:'Syne',sans-serif;font-size:13px;font-weight:800;color:var(--gold);
  letter-spacing:3px;margin-bottom:28px;opacity:.7}
.tfa-icon-wrap{width:72px;height:72px;border-radius:50%;margin:0 auto 20px;
  background:rgba(79,156,249,.1);border:2px solid rgba(79,156,249,.3);
  display:flex;align-items:center;justify-content:center;font-size:32px;
  position:relative}
.tfa-pulse{position:absolute;inset:-6px;border-radius:50%;border:1px solid rgba(79,156,249,.25);
  animation:tfa-pulse 2s ease-in-out infinite}
@keyframes tfa-pulse{0%,100%{transform:scale(1);opacity:.6}50%{transform:scale(1.12);opacity:.2}}
.tfa-title{font-family:'Syne',sans-serif;font-size:18px;font-weight:800;margin-bottom:6px}
.tfa-sub{font-size:11px;color:var(--sub);line-height:1.7;margin-bottom:28px}
.tfa-method-tabs{display:flex;gap:6px;justify-content:center;margin-bottom:22px}
.tfa-mt{padding:7px 16px;border-radius:8px;font-size:11px;font-weight:700;cursor:pointer;
  border:1px solid var(--border2);color:var(--muted);background:transparent;transition:all .15s;
  font-family:'Noto Sans JP',sans-serif}
.tfa-mt.on{border-color:var(--blue);color:var(--blue);background:rgba(79,156,249,.08)}

/* â”€â”€ èªè¨¼ã‚³ãƒ¼ãƒ‰å…¥åŠ› â”€â”€ */
.otp-wrap{display:flex;gap:8px;justify-content:center;margin-bottom:20px}
.otp-cell{width:52px;height:62px;background:#090b13;border:2px solid var(--border2);
  border-radius:10px;font-size:26px;font-weight:700;text-align:center;color:var(--text);
  font-family:'DM Mono',monospace;caret-color:var(--blue);transition:all .15s;outline:none}
.otp-cell:focus{border-color:var(--blue);box-shadow:0 0 0 3px rgba(79,156,249,.15)}
.otp-cell.filled{border-color:var(--border2)}
.otp-cell.error{border-color:var(--red);animation:shake .3s ease;background:rgba(248,113,113,.06)}
.otp-cell.success{border-color:var(--green);background:rgba(52,211,153,.06)}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}

.tfa-timer{font-size:11px;color:var(--muted);margin-bottom:16px}
.tfa-timer span{font-family:'DM Mono',monospace;color:var(--orange);font-weight:700}
.tfa-attempts{font-size:10px;color:var(--muted);margin-bottom:18px}
.tfa-attempts .dot{display:inline-block;width:8px;height:8px;border-radius:50%;
  background:var(--border2);margin:0 2px;transition:all .2s}
.tfa-attempts .dot.used{background:var(--red)}

/* â”€â”€ Lock screen â”€â”€ */
#lock-screen{display:none;position:fixed;inset:0;background:rgba(7,9,15,.97);z-index:600;
  align-items:center;justify-content:center;flex-direction:column;gap:20px;text-align:center}
.lock-icon{font-size:60px;margin-bottom:8px}

/* â”€â”€ Success overlay â”€â”€ */
#success-overlay{display:none;position:fixed;inset:0;background:rgba(7,9,15,.95);z-index:600;
  align-items:center;justify-content:center;flex-direction:column;gap:16px;text-align:center}
.success-ring{width:90px;height:90px;border-radius:50%;background:rgba(52,211,153,.12);
  border:2px solid rgba(52,211,153,.4);display:flex;align-items:center;justify-content:center;
  font-size:42px;animation:pop .4s cubic-bezier(.34,1.56,.64,1)}
@keyframes pop{from{transform:scale(0)}to{transform:scale(1)}}

/* â”€â”€ Breakdown â”€â”€ */
.breakdown-row{display:flex;justify-content:space-between;align-items:center;
  padding:8px 0;border-bottom:1px solid rgba(30,34,53,.5);font-size:12px}
.breakdown-row:last-child{border:none;padding-top:12px;font-size:14px;font-weight:700}

::-webkit-scrollbar{width:4px}::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px}

/* â”€â”€ ç´¹ä»‹ãƒªãƒ³ã‚¯ãƒ¢ãƒ¼ãƒ€ãƒ« â”€â”€ */
#ref-modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.65);z-index:9000;align-items:center;justify-content:center}
#ref-modal-overlay.open{display:flex}
#ref-modal{background:var(--card);border:1px solid var(--border2);border-radius:16px;padding:0;width:min(460px,92vw);overflow:hidden}
.ref-mhdr{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.ref-mhdr-t{font-family:'Syne',sans-serif;font-size:14px;font-weight:800;color:var(--gold)}
.ref-mbody{padding:20px}
.ref-url{background:var(--card2);border:1px solid var(--border2);border-radius:8px;padding:10px 12px;font-family:'DM Mono',monospace;font-size:11px;color:var(--sub);word-break:break-all;margin:10px 0;min-height:36px}
.ref-copy-btn{width:100%;padding:10px;border-radius:8px;border:none;cursor:pointer;font-family:inherit;font-size:13px;font-weight:700;background:var(--gold);color:#0a0c10;margin-top:4px}
.ref-copy-btn:hover{opacity:.9}

/* â”€â”€ ç´¹ä»‹ãƒªãƒ³ã‚¯ å·¦ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒœã‚¿ãƒ³ â”€â”€ */
#ref-float-btn {
  position: fixed;
  left: 0;
  top: 50%;
  transform: translateY(-50%) translateX(-100%) rotate(-90deg);
  transform-origin: right bottom;
  z-index: 8000;
  background: rgba(201,168,76,.18);
  border: 1px solid rgba(201,168,76,.4);
  border-bottom: none;
  border-radius: 8px 8px 0 0;
  color: var(--gold);
  padding: 6px 16px;
  font-size: 11px;
  font-weight: 700;
  font-family: inherit;
  cursor: pointer;
  white-space: nowrap;
  letter-spacing: .5px;
  transition: background .15s;
}
#ref-float-btn:hover { background: rgba(201,168,76,.32); }
</style>
<link rel="stylesheet" href="coreto-sp.css">

<style>
@media(max-width:768px){
  .body{padding:14px 14px 80px!important;max-width:100%!important}
  .card{border-radius:14px!important}
  .card-hdr{padding:12px 16px!important}
  .card-body{padding:14px 16px!important}
  /* æ®‹é«˜è¡¨ç¤ºã‚«ãƒ¼ãƒ‰ */
  .balance-card{padding:18px!important}
  .balance-amount{font-size:28px!important}
  /* é‡‘é¡å…¥åŠ›ã‚’å¤§ãã */
  .amount-input,#amount,input[id*="amount"]{
    font-size:28px!important;text-align:center!important;
    padding:16px 14px!important;min-height:64px!important;
    letter-spacing:1px!important;
  }
  /* å†…è¨³ */
  .breakdown-row{font-size:12px!important;padding:5px 0!important}
  /* ã‚°ãƒªãƒƒãƒ‰ã‚’1ã‚«ãƒ©ãƒ ã« */
  .g2{display:flex!important;flex-direction:column!important;gap:0!important}
  /* OTPå…¥åŠ› */
  input[id*="otp"],input[type="number"][maxlength="6"]{
    font-size:24px!important;letter-spacing:10px!important;
    text-align:center!important;min-height:58px!important;
  }
  /* OTPãƒ¢ãƒ¼ãƒ€ãƒ« */
  .otp-modal,.confirm-modal{
    border-radius:20px 20px 0 0!important;
    position:fixed!important;bottom:0!important;
    left:0!important;right:0!important;width:100%!important;
    max-height:80dvh!important;overflow-y:auto!important;
    padding:24px 20px calc(env(safe-area-inset-bottom)+20px)!important;
  }
  .btn-lg{min-height:54px!important;font-size:15px!important;border-radius:12px!important}
}
</style>
</head>
<body>

<div class="header">
  <div style="display:flex;align-items:center;gap:12px">
    <div class="logo">CORETO</div>
    <div style="width:1px;height:18px;background:var(--border2)"></div>
    <div style="font-size:10px;color:var(--muted);letter-spacing:1px">å³æ™‚æ‰•ã„ç”³è«‹</div>
  </div>
  <button onclick="window.location.href='coreto-hub.html'"
    style="font-size:10px;padding:5px 12px;border-radius:6px;border:1px solid var(--border2);
    background:transparent;color:var(--muted);cursor:pointer;font-family:'Noto Sans JP',sans-serif">
    â† ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
  </button>
</div>

<div class="view-tabs">
  <div class="vt on" onclick="switchView(0,this)">ğŸ’¸ å³æ™‚æ‰•ã„ç”³è«‹</div>
  <div class="vt" onclick="switchView(1,this)">ğŸ“‹ ç”³è«‹å±¥æ­´</div>
  <div class="vt" onclick="switchView(2,this)">ğŸ¢ HQå‡¦ç†ãƒ“ãƒ¥ãƒ¼</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     VIEW 0: ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ 
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="view-0">
<div class="body">

  <div class="sec-title">å³æ™‚æ‰•ã„ç”³è«‹</div>
  <div class="sec-sub">é€šå¸¸æŒ¯è¾¼ï¼ˆæ¯æœˆ25æ—¥ï¼‰ã‚’å¾…ãŸãšã«å³æ™‚ã§å ±é…¬ã‚’å—ã‘å–ã‚Œã¾ã™ã€‚ç”³è«‹å¾Œã«2æ®µéšèªè¨¼ãŒå¿…è¦ã§ã™ã€‚</div>

  <!-- Warning banners -->
  <div class="alert alert-warn">
    âš ï¸ <div>
      <strong>å³æ™‚æ‰•ã„ã«ã¤ã„ã¦ã®æ³¨æ„äº‹é …</strong><br>
      å³æ™‚æ‰•ã„ã¯ç”³è«‹å¾Œã«<strong>2æ®µéšèªè¨¼ï¼ˆSMSã«ã‚ˆã‚‹èªè¨¼ã‚³ãƒ¼ãƒ‰ï¼‰</strong>ãŒå¿…é ˆã§ã™ã€‚
    </div>
  </div>

  <!-- KYC / Account check -->
  <div class="card" style="margin-bottom:16px">
    <div class="card-hdr">
      <div class="ch-title">å—å–æ¡ä»¶ãƒã‚§ãƒƒã‚¯</div>
    </div>
    <div class="card-body">
      <div style="display:flex;flex-direction:column;gap:10px">
        <div style="display:flex;align-items:center;justify-content:space-between;
                    padding:10px 14px;background:var(--card2);border-radius:9px">
          <div style="display:flex;align-items:center;gap:10px">
            <span style="font-size:16px">âœ…</span>
            <div>
              <div style="font-size:12px;font-weight:700">eKYC æœ¬äººç¢ºèª</div>
              <div style="font-size:10px;color:var(--sub)">2025/11/15 æ‰¿èªæ¸ˆã¿</div>
            </div>
          </div>
          <span class="pill pill-green">ç¢ºèªæ¸ˆã¿</span>
        </div>
        <div style="display:flex;align-items:center;justify-content:space-between;
                    padding:10px 14px;background:var(--card2);border-radius:9px">
          <div style="display:flex;align-items:center;gap:10px">
            <span style="font-size:16px">âœ…</span>
            <div>
              <div style="font-size:12px;font-weight:700">å£åº§åç¾©ç¢ºèª</div>
              <div style="font-size:10px;color:var(--sub)">GMOã‚ãŠãã‚‰ Â·Â·Â·4567 ï¼ ãƒ¤ãƒãƒ€ ãƒã‚³ãƒˆ</div>
            </div>
          </div>
          <span class="pill pill-green">æœ¬äººåç¾©ç¢ºèªæ¸ˆã¿</span>
        </div>
        <div style="display:flex;align-items:center;justify-content:space-between;
                    padding:10px 14px;background:var(--card2);border-radius:9px">
          <div style="display:flex;align-items:center;gap:10px">
            <span style="font-size:16px">âœ…</span>
            <div>
              <div style="font-size:12px;font-weight:700">SMSèªè¨¼ç•ªå·</div>
              <div style="font-size:10px;color:var(--sub)">èªè¨¼å…ˆï¼š090-****-4321</div>
            </div>
          </div>
          <span class="pill pill-green">ç¢ºèªæ¸ˆã¿</span>
        </div>

      </div>
    </div>
  </div>

  <div class="g2" style="align-items:start">
    <!-- Left: Form -->
    <div>
      <div class="card">
        <div class="card-hdr"><div class="ch-title">ç”³è«‹å†…å®¹</div></div>
        <div class="card-body">

          <div class="field">
            <label>å‡ºé‡‘å¸Œæœ›é¡ï¼ˆå®Ÿéš›ã«å—ã‘å–ã‚‹é‡‘é¡ï¼‰<span class="req">*</span></label>
            <input type="number" id="req-amount" placeholder="ä¾‹ï¼š100000" min="10000" max="5000000"
                   style="font-family:'DM Mono',monospace;font-size:18px"
                   oninput="calcBreakdown()">
            <div class="field-hint">å…¥åŠ›ã—ãŸé‡‘é¡ãŒãã®ã¾ã¾æŒ¯è¾¼ã¾ã‚Œã¾ã™ï¼ˆæœ€ä½ï¼šÂ¥10,000ï¼‰</div>
          </div>

          <!-- Breakdown preview -->
          <div id="breakdown-wrap" style="display:none;background:var(--card2);border:1px solid var(--border);
               border-radius:11px;padding:16px;margin-bottom:16px">
            <div style="font-size:10px;color:var(--muted);margin-bottom:12px;font-weight:600;letter-spacing:.5px">å‡ºé‡‘ã‚’å®Ÿè¡Œã—ãŸå ´åˆã¯åˆ¥é€”ä»¥ä¸‹ã®è²»ç”¨ãŒå ±é…¬æ®‹é«˜ã‚ˆã‚Šå·®ã—å¼•ã‹ã‚Œã¾ã™ã€‚å‡ºé‡‘å¯èƒ½é¡ã¯è²»ç”¨ã‚’å·®ã—å¼•ã„ãŸé‡‘é¡ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚</div>
            <div class="breakdown-row">
              <span style="color:var(--sub)">å³æ™‚æ‰•ã„æ‰‹æ•°æ–™ï¼ˆ15%ï¼‰</span>
              <span class="mono" style="color:var(--orange)" id="bd-fee">â€”</span>
            </div>
            <div class="breakdown-row">
              <span style="color:var(--sub)">æºæ³‰å¾´åç¨</span>
              <span class="mono" style="color:var(--red)" id="bd-tax">â€”</span>
            </div>
          
          </div>

          <!-- 2FA method: SMS only -->
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;
                      padding:10px 14px;background:rgba(79,156,249,.07);
                      border:1px solid rgba(79,156,249,.2);border-radius:9px;font-size:12px">
            ğŸ“± <span style="color:var(--blue)">ç™»éŒ²ã®æºå¸¯ç•ªå·ã«SMSã§èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã¾ã™</span>
          </div>

          <button class="btn btn-gold btn-lg" style="width:100%;justify-content:center"
                  id="req-submit-btn" onclick="startRequest()" disabled>
            ğŸ” ç”³è«‹ã—ã¦2æ®µéšèªè¨¼ã¸
          </button>
        </div>
      </div>
    </div>

    <!-- Right: Info -->
    <div>
      <div class="card" style="margin-bottom:14px">
        <div class="card-hdr"><div class="ch-title">ç¾åœ¨å‡ºé‡‘å¯èƒ½ãªå ±é…¬é‡‘é¡</div></div>
        <div class="card-body">
          <div style="font-family:'DM Mono',monospace;font-size:36px;font-weight:700;
                      color:var(--gold);margin-bottom:4px">Â¥726,163</div>
          <div style="font-size:11px;color:var(--sub);margin-bottom:14px">é€šå¸¸æŒ¯è¾¼æ—¥ï¼š2026/03/25</div>
          <div style="font-size:10px;color:var(--muted);line-height:1.9;
                      background:var(--card2);padding:10px 12px;border-radius:8px">
            é€šå¸¸æŒ¯è¾¼æ—¥ï¼š2026/03/25<br>
            â€» ä¸Šè¨˜é‡‘é¡ã‚’ä¸Šé™ã¨ã—ã¦ä½•å›ã§ã‚‚å‡ºé‡‘ã§ãã¾ã™
          </div>
        </div>
      </div>

      <div class="card" style="margin-bottom:14px">
        <div class="card-hdr"><div class="ch-title">æŒ¯è¾¼å…ˆå£åº§</div></div>
        <div class="card-body">
          <div style="font-size:12px;line-height:2.2">
            GMOã‚ãŠãã‚‰ãƒãƒƒãƒˆéŠ€è¡Œ<br>
            ãƒ“ã‚¸ãƒã‚¹å–¶æ¥­éƒ¨ï¼ˆ010ï¼‰<br>
            æ™®é€šã€€<span class="mono" style="color:var(--gold)">1234567</span><br>
            <strong>ãƒ¤ãƒãƒ€ ãƒã‚³ãƒˆ</strong>
          </div>
          <div style="display:flex;align-items:center;gap:6px;margin-top:10px;
                      padding:8px 10px;background:rgba(52,211,153,.05);
                      border:1px solid rgba(52,211,153,.2);border-radius:8px;font-size:10px">
            âœ… <span style="color:var(--green)">æœ¬äººåç¾©ç¢ºèªæ¸ˆã¿</span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-hdr"><div class="ch-title">2æ®µéšèªè¨¼ã«ã¤ã„ã¦</div></div>
        <div class="card-body" style="font-size:11px;color:var(--sub);line-height:2">
          å³æ™‚æ‰•ã„ã¯ä¸æ­£åˆ©ç”¨é˜²æ­¢ã®ãŸã‚ã€ç”³è«‹å¾Œã«å¿…ãš2æ®µéšèªè¨¼ãŒå¿…è¦ã§ã™ã€‚<br><br>
          <strong style="color:var(--text)">èªè¨¼ã®æµã‚Œï¼š</strong><br>
          â‘  ç”³è«‹ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™<br>
          â‘¡ ç™»éŒ²ã®æºå¸¯ç•ªå·ã«SMSã§6æ¡ã®èªè¨¼ã‚³ãƒ¼ãƒ‰ãŒå±Šãï¼ˆæœ‰åŠ¹æœŸé™5åˆ†ï¼‰<br>
          â‘¢ èªè¨¼ã‚³ãƒ¼ãƒ‰å…¥åŠ›ã§ç¢ºèªå®Œäº†<br>
          â‘£ HQã«æŒ¯è¾¼ä¾é ¼ãŒè‡ªå‹•é€ä¿¡ã•ã‚Œã‚‹<br><br>
          <strong style="color:var(--orange)">3å›é€£ç¶šå¤±æ•—ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã™ã€‚</strong><br>
          è§£é™¤ã«ã¯HQã¸ã®é€£çµ¡ãŒå¿…è¦ã§ã™ã€‚
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     VIEW 1: ç”³è«‹å±¥æ­´
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="view-1" style="display:none">
<div class="body">
  <div class="sec-title">å³æ™‚æ‰•ã„ç”³è«‹å±¥æ­´</div>
  <div class="sec-sub">éå»ã®å³æ™‚æ‰•ã„ç”³è«‹ã¨èªè¨¼çµæœã®è¨˜éŒ²</div>

  <div class="card">
    <div class="card-hdr"><div class="ch-title">ç”³è«‹å±¥æ­´</div></div>
    <div style="overflow-x:auto">
      <table class="tbl">
        <thead><tr>
          <th>ç”³è«‹ID</th><th>ç”³è«‹æ—¥æ™‚</th><th>ç”³è«‹é¡</th><th>æ‰‹æ•°æ–™</th><th>æŒ¯è¾¼é¡</th>
          <th>èªè¨¼</th><th>èªè¨¼çŠ¶æ…‹</th><th>æŒ¯è¾¼çŠ¶æ…‹</th>
        </tr></thead>
        <tbody>
          <tr>
            <td class="mono" style="font-size:10px">IPY-2026-K7X3</td>
            <td class="mono" style="font-size:10px">2026/02/05 14:32</td>
            <td class="mono">Â¥300,000</td>
            <td class="mono" style="color:var(--orange)">Â¥6,000</td>
            <td class="mono" style="color:var(--green);font-weight:700">Â¥263,367</td>
            <td>ğŸ“± SMS</td>
            <td><span class="pill pill-green">âœ“ èªè¨¼æ¸ˆã¿</span></td>
            <td><span class="pill pill-green">æŒ¯è¾¼å®Œäº†</span></td>
          </tr>
          <tr>
            <td class="mono" style="font-size:10px">IPY-2025-M2N8</td>
            <td class="mono" style="font-size:10px">2025/12/18 09:15</td>
            <td class="mono">Â¥200,000</td>
            <td class="mono" style="color:var(--orange)">Â¥4,000</td>
            <td class="mono" style="color:var(--green);font-weight:700">Â¥175,578</td>
            <td>ğŸ“± SMS</td>
            <td><span class="pill pill-green">âœ“ èªè¨¼æ¸ˆã¿</span></td>
            <td><span class="pill pill-green">æŒ¯è¾¼å®Œäº†</span></td>
          </tr>
          <tr>
            <td class="mono" style="font-size:10px">IPY-2025-R5Q1</td>
            <td class="mono" style="font-size:10px">2025/11/02 17:44</td>
            <td class="mono">Â¥500,000</td>
            <td class="mono" style="color:var(--orange)">Â¥10,000</td>
            <td class="mono" style="color:var(--muted)">â€”</td>
            <td>ğŸ“± SMS</td>
            <td><span class="pill pill-red">âœ— ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ</span></td>
            <td><span class="pill pill-muted">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</span></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     VIEW 2: HQå‡¦ç†
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="view-2" style="display:none">
<div class="body">
  <div class="sec-title">HQ å³æ™‚æ‰•ã„å‡¦ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</div>
  <div class="sec-sub">2FAèªè¨¼æ¸ˆã¿ã®å³æ™‚æ‰•ã„ç”³è«‹ã‚’å‡¦ç†ã—ã¦ãã ã•ã„</div>

  <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:20px">
    <div style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px 16px">
      <div style="font-size:16px;margin-bottom:6px">â³</div>
      <div style="font-family:'DM Mono',monospace;font-size:26px;color:var(--orange)">3</div>
      <div style="font-size:10px;color:var(--muted)">æŒ¯è¾¼å¾…ã¡ï¼ˆ2FAæ¸ˆã¿ï¼‰</div>
    </div>
    <div style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px 16px">
      <div style="font-size:16px;margin-bottom:6px">ğŸ”’</div>
      <div style="font-family:'DM Mono',monospace;font-size:26px;color:var(--red)">1</div>
      <div style="font-size:10px;color:var(--muted)">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯ä¸­</div>
    </div>
    <div style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px 16px">
      <div style="font-size:16px;margin-bottom:6px">âœ…</div>
      <div style="font-family:'DM Mono',monospace;font-size:26px;color:var(--green)">12</div>
      <div style="font-size:10px;color:var(--muted)">ä»ŠæœˆæŒ¯è¾¼å®Œäº†</div>
    </div>
    <div style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px 16px">
      <div style="font-size:16px;margin-bottom:6px">ğŸ’°</div>
      <div style="font-family:'DM Mono',monospace;font-size:20px;color:var(--gold)">Â¥3,200,000</div>
      <div style="font-size:10px;color:var(--muted)">ä»Šæœˆå³æ™‚æ‰•ã„ç·é¡</div>
    </div>
  </div>

  <!-- Lock alert -->
  <div class="alert alert-err" style="margin-bottom:16px">
    ğŸ”’ <div>
      <strong>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆ</strong><br>
      éˆ´æœ¨ å¥å¤ªï¼ˆ10023ï¼‰ãŒ3å›èªè¨¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ç¢ºèªã«å¤±æ•—ã—ã€å³æ™‚æ‰•ã„æ©Ÿèƒ½ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™ã€‚
      æœ¬äººç¢ºèªå¾Œã€è§£é™¤ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚
      <div style="margin-top:8px">
        <button class="btn btn-danger btn-sm" onclick="unlockAccount('10023')">ğŸ”“ ãƒ­ãƒƒã‚¯ã‚’è§£é™¤ã™ã‚‹</button>
      </div>
    </div>
  </div>

  <!-- å…¨éŠ€ãƒãƒƒãƒå‡ºåŠ› -->
  <div class="card" style="margin-bottom:16px;border-color:rgba(201,168,76,.4)">
    <div class="card-hdr" style="background:rgba(201,168,76,.06)">
      <div class="ch-title" style="color:var(--gold)">ğŸ¦ å…¨éŠ€ãƒ‡ãƒ¼ã‚¿ä¸€æ‹¬å‡ºåŠ›</div>
      <div style="display:flex;align-items:center;gap:10px">
        <span style="font-size:11px;color:var(--muted)" id="batch-schedule">
          æ¬¡å›ãƒãƒƒãƒï¼š<span id="next-batch-time" style="color:var(--gold);font-weight:700"></span>
        </span>
        <button class="btn btn-gold btn-sm" onclick="exportZengin()" id="zengin-export-btn">
          ğŸ“¥ å…¨éŠ€ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
        </button>
      </div>
    </div>
    <div class="card-body">

      <!-- ãƒãƒƒãƒçŠ¶æ³ -->
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:16px">
        <div style="background:var(--card2);border-radius:8px;padding:10px 12px;text-align:center">
          <div style="font-size:20px;font-weight:900;color:var(--orange);font-family:'DM Mono',monospace" id="zg-pending-count">3</div>
          <div style="font-size:10px;color:var(--muted);margin-top:2px">æœªå‡¦ç†ä»¶æ•°</div>
        </div>
        <div style="background:var(--card2);border-radius:8px;padding:10px 12px;text-align:center">
          <div style="font-size:16px;font-weight:900;color:var(--gold);font-family:'DM Mono',monospace" id="zg-total-amt">Â¥833,498</div>
          <div style="font-size:10px;color:var(--muted);margin-top:2px">åˆè¨ˆæŒ¯è¾¼é¡</div>
        </div>
        <div style="background:var(--card2);border-radius:8px;padding:10px 12px;text-align:center">
          <div style="font-size:20px;font-weight:900;color:var(--green);font-family:'DM Mono',monospace" id="zg-done-today">0</div>
          <div style="font-size:10px;color:var(--muted);margin-top:2px">æœ¬æ—¥å‡ºåŠ›æ¸ˆã¿</div>
        </div>
        <div style="background:var(--card2);border-radius:8px;padding:10px 12px;text-align:center">
          <div style="font-size:16px;font-weight:900;color:var(--sub);font-family:'DM Mono',monospace" id="zg-last-export">â€”</div>
          <div style="font-size:10px;color:var(--muted);margin-top:2px">å‰å›å‡ºåŠ›</div>
        </div>
      </div>

      <!-- å‡ºåŠ›ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
      <div style="margin-bottom:12px">
        <div style="font-size:11px;color:var(--muted);margin-bottom:8px;font-weight:600;letter-spacing:.5px">å‡ºåŠ›å¯¾è±¡ï¼ˆæœªå‡¦ç†ç”³è«‹ï¼‰</div>
        <div id="zg-preview-list" style="display:flex;flex-direction:column;gap:6px"></div>
      </div>

      <!-- å…¨éŠ€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆèª¬æ˜ -->
      <div style="background:rgba(0,0,0,.2);border-radius:8px;padding:10px 14px;font-size:11px;color:var(--muted);line-height:1.8">
        ğŸ“‹ <strong style="color:var(--sub)">å…¨éŠ€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆå›ºå®šé•·120æ–‡å­—/è¡Œï¼‰</strong><br>
        ãƒ˜ãƒƒãƒ€ãƒ¼ â†’ ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚³ãƒ¼ãƒ‰ Ã— Nä»¶ â†’ ãƒˆãƒ¬ãƒ¼ãƒ©ãƒ¼ â†’ ã‚¨ãƒ³ãƒ‰ã®é †ã§å‡ºåŠ›ã€‚<br>
        ãƒãƒƒãƒˆãƒãƒ³ã‚­ãƒ³ã‚°ã®ã€Œç·åˆæŒ¯è¾¼ã€ç”»é¢ã‹ã‚‰ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ä¸€æ‹¬é€é‡‘ã§ãã¾ã™ã€‚
      </div>

      <!-- å‡ºåŠ›ãƒ­ã‚° -->
      <div style="margin-top:12px" id="zg-log-wrap" style="display:none">
        <div style="font-size:11px;color:var(--muted);margin-bottom:6px;font-weight:600">å‡ºåŠ›ãƒ­ã‚°</div>
        <div id="zg-log" style="font-family:'DM Mono',monospace;font-size:10px;color:var(--green);background:rgba(0,0,0,.3);border-radius:6px;padding:10px;line-height:1.8;max-height:120px;overflow-y:auto"></div>
      </div>
    </div>
  </div>

  <!-- Pending transfers -->
  <div class="card">
    <div class="card-hdr">
      <div class="ch-title">æŒ¯è¾¼å¾…ã¡ã‚­ãƒ¥ãƒ¼ï¼ˆ2FAèªè¨¼æ¸ˆã¿ï¼‰</div>
    </div>
    <div style="overflow-x:auto">
      <table class="tbl">
        <thead><tr>
          <th>ç”³è«‹ID</th><th>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</th><th>ç”³è«‹é¡</th><th>æŒ¯è¾¼é¡</th>
          <th>å£åº§ï¼ˆåç¾©ç¢ºèªï¼‰</th><th>2FAèªè¨¼</th><th>ç”³è«‹æ—¥æ™‚</th><th>æ“ä½œ</th>
        </tr></thead>
        <tbody>
          <tr>
            <td class="mono" style="font-size:10px">IPY-2026-P9W4</td>
            <td style="font-weight:700">å±±ç”° èª ï¼ˆ10012ï¼‰</td>
            <td class="mono">Â¥300,000</td>
            <td class="mono" style="color:var(--green);font-weight:700">Â¥263,367</td>
            <td style="font-size:11px">GMOã‚ãŠãã‚‰ Â·Â·Â·4567<br>
              <span class="pill pill-green" style="margin-top:3px">âœ“ æœ¬äººåç¾©</span></td>
            <td><span class="pill pill-blue">ğŸ“± SMS èªè¨¼æ¸ˆã¿</span></td>
            <td class="mono" style="font-size:10px">2026/02/20 10:32</td>
            <td>
              <button class="btn btn-success btn-sm" onclick="processTransfer('IPY-2026-P9W4','å±±ç”° èª ',263367)">
                ğŸ¦ æŒ¯è¾¼å®Ÿè¡Œ
              </button>
            </td>
          </tr>
          <tr>
            <td class="mono" style="font-size:10px">IPY-2026-A3R7</td>
            <td style="font-weight:700">ä½è—¤ èŠ±å­ï¼ˆ10008ï¼‰</td>
            <td class="mono">Â¥500,000</td>
            <td class="mono" style="color:var(--green);font-weight:700">Â¥438,945</td>
            <td style="font-size:11px">ä¸‰è±UFJ Â·Â·Â·9012<br>
              <span class="pill pill-green" style="margin-top:3px">âœ“ æœ¬äººåç¾©</span></td>
            <td><span class="pill pill-blue">ğŸ“± SMS èªè¨¼æ¸ˆã¿</span></td>
            <td class="mono" style="font-size:10px">2026/02/20 09:18</td>
            <td>
              <button class="btn btn-success btn-sm" onclick="processTransfer('IPY-2026-A3R7','ä½è—¤ èŠ±å­',127500)">
                ğŸ¦ æŒ¯è¾¼å®Ÿè¡Œ
              </button>
            </td>
          </tr>
          <tr>
            <td class="mono" style="font-size:10px">IPY-2026-Z6T2</td>
            <td style="font-weight:700">ç”°ä¸­ ç¾ç©‚ï¼ˆ20005ï¼‰</td>
            <td class="mono">Â¥150,000</td>
            <td class="mono" style="color:var(--green);font-weight:700">Â¥131,186</td>
            <td style="font-size:11px">PayPayéŠ€è¡Œ Â·Â·Â·7654<br>
              <span class="pill pill-green" style="margin-top:3px">âœ“ æœ¬äººåç¾©</span></td>
            <td><span class="pill pill-blue">ğŸ“± SMS èªè¨¼æ¸ˆã¿</span></td>
            <td class="mono" style="font-size:10px">2026/02/19 16:55</td>
            <td>
              <button class="btn btn-success btn-sm" onclick="processTransfer('IPY-2026-Z6T2','æ¸¡è¾º éš†',59500)">
                ğŸ¦ æŒ¯è¾¼å®Ÿè¡Œ
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     2FA SCREEN (full-screen overlay)
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="tfa-screen">
  <div class="tfa-card">
    <div class="tfa-logo">CORETO</div>
    <div class="tfa-icon-wrap">
      <div class="tfa-pulse"></div>
      <span id="tfa-icon">ğŸ’¬</span>
    </div>
    <div class="tfa-title">2æ®µéšèªè¨¼</div>
    <div class="tfa-sub" id="tfa-sub">
      ç™»éŒ²ã®æºå¸¯ç•ªå·ï¼ˆ090-****-4321ï¼‰ã«<br>
      SMSã§6æ¡ã®èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚<br>
      <strong style="color:var(--orange)">æœ‰åŠ¹æœŸé™ï¼š5åˆ†</strong>
    </div>



    <!-- èªè¨¼ã‚³ãƒ¼ãƒ‰å…¥åŠ› -->
    <div class="otp-wrap" id="otp-wrap">
      <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
             oninput="otpInput(this,0)" onkeydown="otpKey(event,0)" id="otp-0">
      <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
             oninput="otpInput(this,1)" onkeydown="otpKey(event,1)" id="otp-1">
      <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
             oninput="otpInput(this,2)" onkeydown="otpKey(event,2)" id="otp-2">
      <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
             oninput="otpInput(this,3)" onkeydown="otpKey(event,3)" id="otp-3">
      <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
             oninput="otpInput(this,4)" onkeydown="otpKey(event,4)" id="otp-4">
      <input class="otp-cell" maxlength="1" type="text" inputmode="numeric"
             oninput="otpInput(this,5)" onkeydown="otpKey(event,5)" id="otp-5">
    </div>

    <div class="tfa-timer">æœ‰åŠ¹æœŸé™ã¾ã§ <span id="tfa-countdown">5:00</span></div>

    <div class="tfa-attempts">
      æ®‹ã‚Šè©¦è¡Œå›æ•°ï¼š
      <span class="dot" id="dot-0"></span>
      <span class="dot" id="dot-1"></span>
      <span class="dot" id="dot-2"></span>
    </div>

    <button class="btn btn-ghost btn-sm" style="width:100%;justify-content:center;margin-bottom:10px"
            onclick="resendOtp()" id="resend-btn" disabled>
      ğŸ“¨ èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’å†é€ã™ã‚‹
    </button>
    <button class="btn btn-ghost btn-sm" style="width:100%;justify-content:center"
            onclick="cancelTfa()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
  </div>
</div>

<!-- â•â• Lock Screen â•â• -->
<div id="lock-screen">
  <div class="lock-icon">ğŸ”’</div>
  <div style="font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:var(--red)">
    ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã—ãŸ
  </div>
  <div style="font-size:13px;color:var(--sub);max-width:340px;line-height:1.8">
    èªè¨¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ç¢ºèªã«3å›å¤±æ•—ã—ãŸãŸã‚ã€å³æ™‚æ‰•ã„æ©Ÿèƒ½ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã—ãŸã€‚<br>
    è§£é™¤ã™ã‚‹ã«ã¯HQæœ¬éƒ¨ã«Slackã¾ãŸã¯ãƒ¡ãƒ¼ãƒ«ã§ã”é€£çµ¡ãã ã•ã„ã€‚
  </div>
  <div style="display:flex;gap:10px;margin-top:16px">
    <button class="btn btn-ghost" onclick="window.location.href='coreto-hub.html'">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</button>
    <button class="btn btn-danger" onclick="alert('HQã«Slackã§é€£çµ¡ã‚’é€ã‚Šã¾ã—ãŸã€‚')">HQã«é€£çµ¡ã™ã‚‹</button>
  </div>
</div>

<!-- â•â• Success Overlay â•â• -->
<div id="success-overlay">
  <div class="success-ring">âœ“</div>
  <div style="font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:var(--green)">
    èªè¨¼å®Œäº†ãƒ»ç”³è«‹å—ç†
  </div>
  <div style="font-size:13px;color:var(--sub);max-width:340px;line-height:1.8;text-align:center">
    2æ®µéšèªè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸã€‚<br>
    HQãŒæŒ¯è¾¼å‡¦ç†ã‚’è¡Œã„ã¾ã™ï¼ˆé€šå¸¸30åˆ†ã€œ2æ™‚é–“ä»¥å†…ï¼‰ã€‚<br>
    <strong style="color:var(--gold)" id="success-amount"></strong>
  </div>
  <div style="font-size:11px;color:var(--muted);margin-top:8px">
    ç”³è«‹IDï¼š<span class="mono" id="success-id"></span>
  </div>
  <button class="btn btn-gold" style="margin-top:20px" onclick="window.location.href='coreto-hub.html'">
    ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
  </button>
</div>

<script>
  // â”€â”€ Slacké€šçŸ¥è¨­å®š â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // æœ¬ç•ªé‹ç”¨å‰ã« Slack Incoming Webhook URL ã‚’è¨­å®šã—ã¦ãã ã•ã„
  // Slackç®¡ç†ç”»é¢ â†’ ã‚¢ãƒ—ãƒª â†’ Incoming Webhooks â†’ Webhook URLã‚’ã‚³ãƒ”ãƒ¼
  var SLACK_WEBHOOK = window.SLACK_CONFIG
    ? window.SLACK_CONFIG.GENERAL   // db.jsãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹å ´åˆ
    : 'YOUR_SLACK_WEBHOOK_URL';     // ç›´æ¥è¨­å®šã™ã‚‹å ´åˆã¯ã“ã“ã«è²¼ã‚Šä»˜ã‘

  function notifySlack(msg) {
    if (!SLACK_WEBHOOK || SLACK_WEBHOOK === 'YOUR_SLACK_WEBHOOK_URL') {
      console.log('[Slackï¼ˆæœªè¨­å®šï¼‰]', msg);
      return;
    }
    fetch(SLACK_WEBHOOK, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ text: msg }),
      mode: 'no-cors'
    }).catch(e => console.error('[Slacké€ä¿¡ã‚¨ãƒ©ãƒ¼]', e));
  }
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// â•â• AUTH GUARD (è¦ãƒ­ã‚°ã‚¤ãƒ³) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function() {
  var s = null;
  try { s = JSON.parse(sessionStorage.getItem('coreto_session') || 'null'); } catch(e) {}
  if (!s || !s.userId || !s.sessionToken || s.sessionToken.length !== 64) { sessionStorage.removeItem('coreto_session'); location.replace('coreto-login.html'); return; }
  var _la = new Date(s.loginAt).getTime(); if (isNaN(_la)||(Date.now()-_la)>28800000){ sessionStorage.removeItem('coreto_session'); alert('ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã¾ã—ãŸã€‚'); location.replace('coreto-login.html'); return; }
  window._SESSION = s;
  // HQå‡¦ç†ãƒ“ãƒ¥ãƒ¼ ã‚¿ãƒ–ã¯HQã®ã¿è¡¨ç¤º
  window.addEventListener('DOMContentLoaded', function() {
    var hqTab = document.querySelector('.vt:nth-child(3)');
    if (hqTab && s.type !== 'hq') hqTab.style.display = 'none';
  });
})();

// â”€â”€ View switch â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function switchView(i, btn) {
  document.querySelectorAll('.vt').forEach((t,j)=>t.classList.toggle('on',j===i));
  [0,1,2].forEach(j=>document.getElementById('view-'+j).style.display=j===i?'block':'none');
}

// SMSä¸€æœ¬åŒ– - methodå›ºå®š
let selectedMethod = 'sms';

// â”€â”€ Breakdown calc â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcBreakdown() {
  // å…¥åŠ›å€¤ = å®Ÿéš›ã«å—ã‘å–ã‚‹é‡‘é¡ï¼ˆå‡ºé‡‘å¸Œæœ›é¡ï¼‰
  const net = parseFloat(document.getElementById('req-amount').value)||0;
  const wrap = document.getElementById('breakdown-wrap');
  const btn  = document.getElementById('req-submit-btn');
  if (net < 10000) { wrap.style.display='none'; btn.disabled=true; return; }
  // é€†ç®—: gross = net / (1 - 0.15 - 0.1021) = net / 0.7479
  const gross = net / 0.7479;
  const fee   = Math.round(gross * 0.15);
  const tax   = gross <= 1e6
    ? Math.round(gross * 0.1021)
    : Math.round(1e6 * 0.1021 + (gross - 1e6) * 0.2042);
  const yen  = v => 'Â¥' + Math.round(v).toLocaleString();
  document.getElementById('bd-fee').textContent = yen(fee);
  document.getElementById('bd-tax').textContent = yen(tax);
  wrap.style.display = 'block';
  btn.disabled = false;
}

// â”€â”€ Start request â†’ open 2FA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let tfaOtp = '';
let tfaAttempts = 0;
let tfaTimer = null;
let tfaCountdown = 300;
let currentReqId = '';
let currentNetAmount = 0;

function startRequest() {
  const net = parseFloat(document.getElementById('req-amount').value)||0;
  if (net < 10000) return;
  currentNetAmount = net; // å…¥åŠ›å€¤ãŒãã®ã¾ã¾æŒ¯è¾¼é¡
  // Generate random request ID
  currentReqId = 'IPY-'+new Date().getFullYear()+'-'+randomId(4);
  // Generate dummy auth code (demo)
  tfaOtp = String(Math.floor(100000+Math.random()*900000));
  tfaAttempts = 0;
  openTfa();
}

function randomId(len) {
  const chars='ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  return Array.from({length:len},()=>chars[Math.floor(Math.random()*chars.length)]).join('');
}

function openTfa() {
  clearOtp();
  updateDots();
  document.getElementById('tfa-screen').style.display='flex';
  // Set method display
  document.getElementById('tfa-icon').textContent = 'ğŸ“±';
  document.getElementById('tfa-sub').innerHTML = `ç™»éŒ²ã®æºå¸¯ç•ªå·ï¼ˆ090-****-4321ï¼‰ã«<br>SMSã§6æ¡ã®èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚<br><strong style="color:var(--orange)">æœ‰åŠ¹æœŸé™ï¼š5åˆ†</strong><br><br><em style="font-size:10px;color:var(--muted)">[ãƒ‡ãƒ¢ç”¨ã‚³ãƒ¼ãƒ‰: ${tfaOtp}]</em>`;
  // Start countdown
  tfaCountdown = 300;
  clearInterval(tfaTimer);
  tfaTimer = setInterval(tickCountdown, 1000);
  document.getElementById('resend-btn').disabled = true;
  setTimeout(()=>document.getElementById('otp-0').focus(), 100);
}

function tickCountdown() {
  tfaCountdown--;
  const m = Math.floor(tfaCountdown/60);
  const s = tfaCountdown%60;
  document.getElementById('tfa-countdown').textContent = `${m}:${s.toString().padStart(2,'0')}`;
  if (tfaCountdown <= 60) document.getElementById('tfa-countdown').style.color='var(--red)';
  if (tfaCountdown <= 0) {
    clearInterval(tfaTimer);
    document.getElementById('tfa-countdown').textContent='0:00';
    document.getElementById('resend-btn').disabled = false;
    document.querySelectorAll('.otp-cell').forEach(c=>c.disabled=true);
  }
}

function resendOtp() {
  tfaOtp = String(Math.floor(100000+Math.random()*900000));
  clearOtp();
  tfaCountdown = 300;
  document.getElementById('tfa-countdown').style.color='var(--orange)';
  clearInterval(tfaTimer);
  tfaTimer = setInterval(tickCountdown, 1000);
  document.getElementById('resend-btn').disabled = true;
  document.querySelectorAll('.otp-cell').forEach(c=>c.disabled=false);
  const sub = document.getElementById('tfa-sub');
  sub.innerHTML = sub.innerHTML.replace(/\[ãƒ‡ãƒ¢ç”¨ã‚³ãƒ¼ãƒ‰: \d+\]/, `[ãƒ‡ãƒ¢ç”¨ã‚³ãƒ¼ãƒ‰: ${tfaOtp}]`);
  document.getElementById('otp-0').focus();
}

// LINEèªè¨¼å»ƒæ­¢ - SMSä¸€æœ¬åŒ–

function cancelTfa() {
  clearInterval(tfaTimer);
  document.getElementById('tfa-screen').style.display='none';
}

// â”€â”€ èªè¨¼ã‚³ãƒ¼ãƒ‰å…¥åŠ› handling â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function otpInput(el, idx) {
  const v = el.value.replace(/\D/g,'');
  el.value = v;
  el.classList.remove('error','success');
  if (v && idx < 5) document.getElementById('otp-'+(idx+1)).focus();
  if (idx===5 && v) checkOtp();
}
function otpKey(e, idx) {
  if (e.key==='Backspace' && !e.target.value && idx>0) {
    document.getElementById('otp-'+(idx-1)).focus();
  }
}
function clearOtp() {
  for(let i=0;i<6;i++){
    const c=document.getElementById('otp-'+i);
    c.value=''; c.classList.remove('error','success'); c.disabled=false;
  }
}
function checkOtp() {
  const entered = Array.from({length:6},(_,i)=>document.getElementById('otp-'+i).value).join('');
  if (entered === tfaOtp) {
    // Success
    for(let i=0;i<6;i++) document.getElementById('otp-'+i).classList.add('success');
    clearInterval(tfaTimer);
    setTimeout(showSuccess, 600);
  } else {
    // Fail
    for(let i=0;i<6;i++) document.getElementById('otp-'+i).classList.add('error');
    tfaAttempts++;
    updateDots();
    if (tfaAttempts >= 3) {
      clearInterval(tfaTimer);
      setTimeout(showLock, 800);
    } else {
      setTimeout(()=>{ clearOtp(); document.getElementById('otp-0').focus(); }, 900);
    }
  }
}
function updateDots() {
  for(let i=0;i<3;i++){
    document.getElementById('dot-'+i).classList.toggle('used', i<tfaAttempts);
  }
}

function showSuccess() {
  document.getElementById('tfa-screen').style.display='none';
  const ov = document.getElementById('success-overlay');
  ov.style.display='flex';
  document.getElementById('success-amount').textContent =
    'æŒ¯è¾¼äºˆå®šé¡ï¼šÂ¥'+currentNetAmount.toLocaleString();
  document.getElementById('success-id').textContent = currentReqId;

  // ğŸ”” HQã¸å³æ™‚æ‰•ã„ç”³è«‹ã®ç·Šæ€¥Slacké€šçŸ¥
  const session = JSON.parse(sessionStorage.getItem('coreto_session') || 'null');
  const agName = (typeof ME !== 'undefined' && ME.name) ? ME.name : (session ? session.userId : 'ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ');
  const fee = Math.round(currentNetAmount * 0.15);
  const payout = currentNetAmount - fee;
  const now = new Date();
  const ts = now.getFullYear() + '/' + String(now.getMonth()+1).padStart(2,'0') + '/' + String(now.getDate()).padStart(2,'0') + ' ' + String(now.getHours()).padStart(2,'0') + ':' + String(now.getMinutes()).padStart(2,'0');
  slackNotifyInstantPay({
    reqId: currentReqId,
    agName: agName,
    agId: session ? session.userId : 'â€”',
    amount: currentNetAmount,
    fee: fee,
    payout: payout,
    ts: ts,
  });
}
function showLock() {
  document.getElementById('tfa-screen').style.display='none';
  document.getElementById('lock-screen').style.display='flex';
}

// â”€â”€ HQ actions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function processTransfer(id, agName, amount) {
  if (!confirm(`ç”³è«‹ID ${id} ã®æŒ¯è¾¼ã‚’å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ\n\nå¯¾è±¡ï¼š${agName}\næŒ¯è¾¼é¡ï¼šÂ¥${Number(amount).toLocaleString()}\n\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚`)) return;
  // æŒ¯è¾¼å®Œäº†Slacké€šçŸ¥
  const now = new Date();
  const ts = now.getFullYear() + '/' + String(now.getMonth()+1).padStart(2,'0') + '/' + String(now.getDate()).padStart(2,'0') + ' ' + String(now.getHours()).padStart(2,'0') + ':' + String(now.getMinutes()).padStart(2,'0');
  slackNotifyTransferDone({ id, agName, amount, ts });
  // UIæ›´æ–°
  const btn = event.target.closest('button');
  if (btn) { btn.textContent = 'âœ… æŒ¯è¾¼æ¸ˆã¿'; btn.disabled = true; btn.style.background = 'var(--green)'; }
  showToast('âœ… æŒ¯è¾¼ã‚’å®Ÿè¡Œã—ã¾ã—ãŸ â€” ' + id);
}
function unlockAccount(id) {
  if (!confirm(`${id} ã®å³æ™‚æ‰•ã„ãƒ­ãƒƒã‚¯ã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ\næœ¬äººç¢ºèªãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚`)) return;
  alert(`ğŸ”“ ${id} ã®ãƒ­ãƒƒã‚¯ã‚’è§£é™¤ã—ã¾ã—ãŸã€‚ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«Slackã§é€šçŸ¥ã•ã‚Œã¾ã™ã€‚`);
}

// â”€â”€ ç´¹ä»‹ãƒªãƒ³ã‚¯ãƒ¢ãƒ¼ãƒ€ãƒ« â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var _refCurrentCode = '';
function openRefModal() {
  var overlay = document.getElementById('ref-modal-overlay');
  var selector = document.getElementById('ref-code-selector');
  var isExec = (typeof session !== 'undefined' && session && session.hqRole === 'exec')
            || (typeof CURRENT_USER !== 'undefined' && CURRENT_USER && CURRENT_USER.hqRole === 'exec');
  var agentId = (typeof session !== 'undefined' && session && session.userId) ? session.userId
              : (typeof ME !== 'undefined' && ME && ME.id) ? ME.id
              : (typeof AGENT !== 'undefined' && AGENT && AGENT.id) ? AGENT.id : '10012';
  if (isExec) {
    var SPECIAL = ['FOUNDER2026','WELCOME2026','GOLD_START','HR_PRO75'];
    var opts = SPECIAL.map(function(c){ return '<option value="'+c+'">â­ '+c+'</option>'; }).join('');
    selector.innerHTML =
      '<div style="margin-bottom:12px"><div style="font-size:10px;color:var(--sub);font-weight:600;margin-bottom:5px">ã‚³ãƒ¼ãƒ‰ç¨®åˆ¥</div>'
      +'<select id="ref-code-select" onchange="updateRefLink()" style="width:100%;padding:8px 10px;background:var(--card2);border:1px solid var(--border2);border-radius:8px;color:var(--text);font-size:12px;font-family:inherit">'
      +'<option value="'+agentId+'">è‡ªåˆ†ã®IDï¼ˆ'+agentId+'ï¼‰</option>'
      +'<optgroup label="â”€â”€ ç‰¹åˆ¥ã‚³ãƒ¼ãƒ‰ â”€â”€">'+opts+'</optgroup>'
      +'</select></div>';
    _refCurrentCode = agentId;
  } else {
    selector.innerHTML =
      '<div style="display:flex;align-items:center;gap:8px;margin-bottom:12px;padding:8px 12px;background:rgba(201,168,76,.06);border:1px solid rgba(201,168,76,.2);border-radius:8px">'
      +'<span style="font-size:11px;color:var(--muted)">ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ï¼š</span>'
      +'<span style="font-family:\'DM Mono\',monospace;font-size:13px;font-weight:700;color:var(--gold)">'+agentId+'</span>'
      +'</div>';
    _refCurrentCode = agentId;
  }
  updateRefLink();
  overlay.classList.add('open');
}
function updateRefLink() {
  var sel = document.getElementById('ref-code-select');
  if (sel) _refCurrentCode = sel.value;
  var base = location.origin + location.pathname.replace(/[^/]*$/, '') + 'coreto-agent-signup.html';
  var url = base + '?ref=' + encodeURIComponent(_refCurrentCode);
  document.getElementById('ref-url-display').textContent = url;
}
function closeRefModal() {
  document.getElementById('ref-modal-overlay').classList.remove('open');
}
function copyRefLink() {
  var url = document.getElementById('ref-url-display').textContent;
  navigator.clipboard.writeText(url).then(function() {
    var btn = document.querySelector('.ref-copy-btn');
    btn.textContent = 'âœ… ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ';
    setTimeout(function(){ btn.textContent = 'ğŸ“‹ ã‚³ãƒ”ãƒ¼'; }, 2000);
  }).catch(function() {
    var ta = document.createElement('textarea');
    ta.value = url; document.body.appendChild(ta); ta.select();
    document.execCommand('copy'); document.body.removeChild(ta);
  });
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SLACK é€šçŸ¥ï¼ˆå³æ™‚æ‰•ã„ï¼‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SLACK_WEBHOOK = 'YOUR_SLACK_WEBHOOK_URL'; // æœ¬ç•ªæ™‚ã«è¨­å®š

function slackPost(payload) {
  // æœ¬ç•ª: fetch(SLACK_WEBHOOK, { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(payload) });
  console.log('[Slack å³æ™‚æ‰•ã„é€šçŸ¥]', JSON.stringify(payload, null, 2));
}

// ç”³è«‹å—ä»˜é€šçŸ¥ï¼ˆHQã¸ï¼‰
function slackNotifyInstantPay({ reqId, agName, agId, amount, fee, payout, ts }) {
  const fmt = v => 'Â¥' + Number(v).toLocaleString();
  slackPost({
    text: '<!channel> ğŸš¨ *å³æ™‚æ‰•ã„ç”³è«‹ãŒå±Šãã¾ã—ãŸ*',
    attachments: [{
      color: '#e67e22',
      blocks: [
        { type: 'section', text: { type: 'mrkdwn',
          text: `*<!channel> ğŸš¨ å³æ™‚æ‰•ã„ç”³è«‹ â€” å¯¾å¿œãŒå¿…è¦ã§ã™*` } },
        { type: 'section', fields: [
          { type: 'mrkdwn', text: `*ç”³è«‹ID*\n\`${reqId}\`` },
          { type: 'mrkdwn', text: `*ç”³è«‹æ—¥æ™‚*\n${ts}` },
          { type: 'mrkdwn', text: `*ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ*\n${agName}ï¼ˆ${agId}ï¼‰` },
          { type: 'mrkdwn', text: `*2FAèªè¨¼*\nâœ… SMSèªè¨¼æ¸ˆã¿` },
          { type: 'mrkdwn', text: `*ç”³è«‹é¡*\n${fmt(amount)}` },
          { type: 'mrkdwn', text: `*æŒ¯è¾¼é¡ï¼ˆæ‰‹æ•°æ–™15%å·®å¼•å¾Œï¼‰*\n*${fmt(payout)}*` },
        ]},
        { type: 'section', text: { type: 'mrkdwn',
          text: `âš¡ *å³æ™‚æ‰•ã„ç®¡ç†ç”»é¢ã§æŒ¯è¾¼å®Ÿè¡Œã—ã¦ãã ã•ã„*\nhttps://esyun25.github.io/coreto/coreto-instant-pay.html` } },
        { type: 'context', elements: [
          { type: 'mrkdwn', text: `æ‰‹æ•°æ–™ï¼ˆ15%ï¼‰: ${fmt(fee)} | CORETO å³æ™‚æ‰•ã„ã‚·ã‚¹ãƒ†ãƒ ` }
        ]}
      ]
    }]
  });
}

// æŒ¯è¾¼å®Œäº†é€šçŸ¥ï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸ï¼‰
function slackNotifyTransferDone({ id, agName, amount, ts }) {
  const fmt = v => 'Â¥' + Number(v).toLocaleString();
  slackPost({
    text: `âœ… å³æ™‚æ‰•ã„æŒ¯è¾¼å®Œäº† â€” ${agName}`,
    attachments: [{
      color: '#2ecc71',
      blocks: [
        { type: 'section', text: { type: 'mrkdwn',
          text: `*âœ… å³æ™‚æ‰•ã„æŒ¯è¾¼ã‚’å®Ÿè¡Œã—ã¾ã—ãŸ*` } },
        { type: 'section', fields: [
          { type: 'mrkdwn', text: `*ç”³è«‹ID*\n\`${id}\`` },
          { type: 'mrkdwn', text: `*å®Ÿè¡Œæ—¥æ™‚*\n${ts}` },
          { type: 'mrkdwn', text: `*ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ*\n${agName}` },
          { type: 'mrkdwn', text: `*æŒ¯è¾¼é¡*\n*${fmt(amount)}*` },
        ]},
        { type: 'context', elements: [
          { type: 'mrkdwn', text: `GMOãƒãƒ¼ãƒãƒ£ãƒ«å£åº§ã‹ã‚‰é€é‡‘å‡¦ç†ã‚’é–‹å§‹ã—ã¾ã—ãŸ | CORETO` }
        ]}
      ]
    }]
  });
}

// Toasté€šçŸ¥
function showToast(msg) {
  let t = document.getElementById('ip-toast');
  if (!t) {
    t = document.createElement('div');
    t.id = 'ip-toast';
    t.style.cssText = 'position:fixed;bottom:24px;right:24px;background:#1e2a1e;border:1px solid var(--green);color:var(--green);padding:12px 20px;border-radius:10px;font-size:13px;font-weight:600;z-index:9999;opacity:0;transition:opacity .3s';
    document.body.appendChild(t);
  }
  t.textContent = msg;
  t.style.opacity = '1';
  setTimeout(() => { t.style.opacity = '0'; }, 3000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// å…¨éŠ€ãƒãƒƒãƒå‡ºåŠ›
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// æŒ¯è¾¼å¾…ã¡ãƒ‡ãƒ¼ã‚¿ï¼ˆæœ¬ç•ªã¯Kintoneã‹ã‚‰å–å¾—ï¼‰
const PENDING_TRANSFERS = [
  {
    reqId: 'IPY-2026-A3R7', agId: '10008', agName: 'ä½è—¤ èŠ±å­', agKana: 'ã‚µãƒˆã‚¦ ãƒãƒŠã‚³',
    reqAmt: 500000, payoutAmt: 438945,
    bankCode: '0005', bankName: 'ãƒŸãƒ„ãƒ“ã‚·UFJã‚®ãƒ³ã‚³ã‚¦', branchCode: '001', branchName: 'ãƒ›ãƒ³ãƒ†ãƒ³',
    accountType: 1, accountNo: '1234567', accountName: 'ã‚µãƒˆã‚¦ ãƒãƒŠã‚³',
    requestedAt: '2026/02/20 09:18', status: 'pending'
  },
  {
    reqId: 'IPY-2026-P9W4', agId: '10012', agName: 'å±±ç”° èª ', agKana: 'ãƒ¤ãƒãƒ€ ãƒã‚³ãƒˆ',
    reqAmt: 300000, payoutAmt: 263367,
    bankCode: '0310', bankName: 'GMOã‚¢ã‚ªã‚¾ãƒ©ãƒãƒƒãƒˆã‚®ãƒ³ã‚³ã‚¦', branchCode: '101', branchName: 'ãƒ›ãƒ³ãƒ†ãƒ³',
    accountType: 1, accountNo: '7654321', accountName: 'ãƒ¤ãƒãƒ€ ãƒã‚³ãƒˆ',
    requestedAt: '2026/02/20 10:32', status: 'pending'
  },
  {
    reqId: 'IPY-2026-Z6T2', agId: '20005', agName: 'ç”°ä¸­ ç¾ç©‚', agKana: 'ã‚¿ãƒŠã‚« ãƒŸãƒ›',
    reqAmt: 150000, payoutAmt: 131186,
    bankCode: '0033', bankName: 'ãƒšã‚¤ãƒšã‚¤ã‚®ãƒ³ã‚³ã‚¦', branchCode: '001', branchName: 'ãƒ›ãƒ³ãƒ†ãƒ³',
    accountType: 1, accountNo: '9876543', accountName: 'ã‚¿ãƒŠã‚« ãƒŸãƒ›',
    requestedAt: '2026/02/19 16:55', status: 'pending'
  },
];

// ä¾é ¼äººæƒ…å ±ï¼ˆæœ¬ç•ªã¯Kintone/è¨­å®šã‹ã‚‰å–å¾—ï¼‰
const REQUESTER = {
  code:       '1234567890',      // ä¾é ¼äººã‚³ãƒ¼ãƒ‰ï¼ˆ10æ¡ï¼‰
  name:       'ãƒ†ã‚¤ã‚³ã‚¯ã‚«ã‚¤ãƒãƒ„', // ä¾é ¼äººåï¼ˆã‚«ãƒŠ20æ–‡å­—ä»¥å†…ï¼‰
  bankCode:   '0310',            // ä¾é ¼äººéŠ€è¡Œã‚³ãƒ¼ãƒ‰
  bankName:   'GMOã‚¢ã‚ªã‚¾ãƒ©',
  branchCode: '101',
  branchName: 'ãƒ›ãƒ³ãƒ†ãƒ³',
  accountType: 1,                // 1=æ™®é€š 2=å½“åº§
  accountNo:  '1111111',
};

// â”€â”€ å…¨éŠ€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç”Ÿæˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildZenginRecord(fields) {
  // å…¨éŠ€æ¨™æº–ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ å›ºå®šé•·120æ–‡å­—
  return fields.map(([val, len, type]) => {
    const s = String(val === null || val === undefined ? '' : val);
    if (type === 'N') return s.replace(/[^0-9]/g, '').padStart(len, '0').slice(-len);
    // è‹±æ•°ã‚«ãƒŠï¼ˆåŠè§’ï¼‰
    const zen2han = str => str
      .replace(/[ï¼¡-ï¼ºï½-ï½šï¼-ï¼™]/g, c => String.fromCharCode(c.charCodeAt(0) - 0xFEE0))
      .replace(/ã€€/g, ' ');
    return zen2han(s).padEnd(len, ' ').slice(0, len);
  }).join('');
}

function generateZenginFile(transfers, valueDate) {
  const lines = [];
  const dateStr = valueDate.replace(/\//g, '').slice(2); // YYMMDDâ†’MMDDï¼ˆå…¨éŠ€ã¯4æ¡MMDDï¼‰
  const fullDate = valueDate.replace(/\//g, '').slice(0); // YYYYMMDD
  const zenginDate = fullDate.slice(4); // MMDD

  // â”€â”€ ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ¬ã‚³ãƒ¼ãƒ‰ â”€â”€
  lines.push(buildZenginRecord([
    ['21',                    2,  'C'],  // ç¨®åˆ¥ã‚³ãƒ¼ãƒ‰ï¼ˆç·åˆæŒ¯è¾¼=21ï¼‰
    ['0',                     1,  'N'],  // ã‚³ãƒ¼ãƒ‰åŒºåˆ†ï¼ˆ0=éŠ€è¡Œç•ªå·ï¼‰
    [REQUESTER.code,         10,  'N'],  // ä¾é ¼äººã‚³ãƒ¼ãƒ‰
    [REQUESTER.name,         40,  'C'],  // ä¾é ¼äººå
    [zenginDate,              4,  'N'],  // æŒ¯è¾¼æ—¥ï¼ˆMMDDï¼‰
    [REQUESTER.bankCode,      4,  'N'],  // ä¾é ¼äººéŠ€è¡Œç•ªå·
    [REQUESTER.bankName,     15,  'C'],  // ä¾é ¼äººéŠ€è¡Œå
    [REQUESTER.branchCode,    3,  'N'],  // ä¾é ¼äººæ”¯åº—ç•ªå·
    [REQUESTER.branchName,   15,  'C'],  // ä¾é ¼äººæ”¯åº—å
    ['',                      4,  'C'],  // é é‡‘ç¨®ç›®ï¼ˆæ–°è¦formatçœç•¥ï¼‰
    [REQUESTER.accountType,   1,  'N'],  // é é‡‘ç¨®ç›® 1=æ™®é€š
    [REQUESTER.accountNo,     7,  'N'],  // å£åº§ç•ªå·
    ['',                     17,  'C'],  // ãƒ€ãƒŸãƒ¼
  ]));

  // â”€â”€ ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚³ãƒ¼ãƒ‰ â”€â”€
  transfers.forEach(t => {
    lines.push(buildZenginRecord([
      ['02',                    2,  'C'],  // ç¨®åˆ¥ã‚³ãƒ¼ãƒ‰
      [t.bankCode,              4,  'N'],  // éŠ€è¡Œç•ªå·
      [t.bankName,             15,  'C'],  // éŠ€è¡Œå
      [t.branchCode,            3,  'N'],  // æ”¯åº—ç•ªå·
      [t.branchName,           15,  'C'],  // æ”¯åº—å
      ['',                      4,  'C'],  // ãƒ€ãƒŸãƒ¼
      [t.accountType,           1,  'N'],  // é é‡‘ç¨®ç›® 1=æ™®é€š
      [t.accountNo,             7,  'N'],  // å£åº§ç•ªå·
      [t.accountName,          30,  'C'],  // å—å–äººå
      [t.payoutAmt,            10,  'N'],  // æŒ¯è¾¼é‡‘é¡
      ['Y',                     1,  'C'],  // æ–°è¦ã‚³ãƒ¼ãƒ‰ï¼ˆY=æ–°è¦ï¼‰
      ['',                      0,  'C'],  // EDIæƒ…å ±çœç•¥ â†’ pad rest
    ].filter((_, i) => i < 11)));
    // æ®‹ã‚Š7æ–‡å­—ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°
    const last = lines[lines.length - 1];
    if (last.length < 120) lines[lines.length - 1] = last.padEnd(120, ' ');
  });

  // â”€â”€ ãƒˆãƒ¬ãƒ¼ãƒ©ãƒ¼ãƒ¬ã‚³ãƒ¼ãƒ‰ â”€â”€
  const totalAmt = transfers.reduce((s, t) => s + t.payoutAmt, 0);
  lines.push(buildZenginRecord([
    ['08',                    2,  'C'],  // ç¨®åˆ¥ã‚³ãƒ¼ãƒ‰
    [transfers.length,        6,  'N'],  // åˆè¨ˆä»¶æ•°
    [totalAmt,               12,  'N'],  // åˆè¨ˆé‡‘é¡
    ['',                    100,  'C'],  // ãƒ€ãƒŸãƒ¼
  ]));

  // â”€â”€ ã‚¨ãƒ³ãƒ‰ãƒ¬ã‚³ãƒ¼ãƒ‰ â”€â”€
  lines.push('9'.padEnd(120, ' '));

  return lines.join('\r\n'); // Windowsæ”¹è¡Œï¼ˆéŠ€è¡Œã‚·ã‚¹ãƒ†ãƒ å¯¾å¿œï¼‰
}

// â”€â”€ æ¬¡å›ãƒãƒƒãƒæ™‚åˆ»è¡¨ç¤º â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateNextBatchTime() {
  const now = new Date();
  const h = now.getHours();
  let nextBatch;
  if (h < 8) {
    nextBatch = new Date(now); nextBatch.setHours(8,0,0,0);
  } else if (h < 17) {
    nextBatch = new Date(now); nextBatch.setHours(17,0,0,0);
  } else {
    nextBatch = new Date(now); nextBatch.setDate(nextBatch.getDate()+1); nextBatch.setHours(8,0,0,0);
  }
  const diff = nextBatch - now;
  const hh = Math.floor(diff/3600000);
  const mm = Math.floor((diff%3600000)/60000);
  const el = document.getElementById('next-batch-time');
  if (el) {
    const label = nextBatch.getHours() === 8 ? 'æœãƒãƒƒãƒï¼ˆ8:00ï¼‰' : 'å¤•ãƒãƒƒãƒï¼ˆ17:00ï¼‰';
    el.textContent = label + ' ã¾ã§ ' + hh + 'æ™‚é–“' + mm + 'åˆ†';
  }
}

// â”€â”€ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªã‚¹ãƒˆæç”» â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderZenginPreview() {
  const el = document.getElementById('zg-preview-list');
  if (!el) return;
  const pending = PENDING_TRANSFERS.filter(t => t.status === 'pending');
  if (!pending.length) {
    el.innerHTML = '<div style="font-size:12px;color:var(--muted);padding:8px">æœªå‡¦ç†ã®ç”³è«‹ã¯ã‚ã‚Šã¾ã›ã‚“</div>';
    return;
  }
  el.innerHTML = pending.map(t => `
    <div style="display:flex;align-items:center;justify-content:space-between;
                background:var(--card2);border-radius:7px;padding:8px 12px;font-size:11px">
      <div style="display:flex;align-items:center;gap:10px">
        <input type="checkbox" class="zg-chk" data-id="${t.reqId}" checked
               style="accent-color:var(--gold);width:14px;height:14px;cursor:pointer"
               onchange="updateZenginSummary()">
        <div>
          <span style="font-family:'DM Mono',monospace;font-size:10px;color:var(--gold)">${t.reqId}</span>
          <span style="margin-left:8px;font-weight:600">${t.agName}</span>
          <span style="margin-left:6px;color:var(--muted)">${t.bankName.slice(0,8)}â€¦ Â·Â·Â·${t.accountNo.slice(-4)}</span>
        </div>
      </div>
      <div style="text-align:right">
        <div style="font-weight:700;color:var(--green);font-family:'DM Mono',monospace">Â¥${t.payoutAmt.toLocaleString()}</div>
        <div style="font-size:9px;color:var(--muted)">${t.requestedAt}</div>
      </div>
    </div>
  `).join('');
  updateZenginSummary();
}

function updateZenginSummary() {
  const checked = Array.from(document.querySelectorAll('.zg-chk:checked'));
  const ids = checked.map(c => c.dataset.id);
  const selected = PENDING_TRANSFERS.filter(t => ids.includes(t.reqId));
  const total = selected.reduce((s, t) => s + t.payoutAmt, 0);
  const cntEl = document.getElementById('zg-pending-count');
  const amtEl = document.getElementById('zg-total-amt');
  if (cntEl) cntEl.textContent = selected.length;
  if (amtEl) amtEl.textContent = 'Â¥' + total.toLocaleString();
}

// â”€â”€ å…¨éŠ€ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ãƒ¡ã‚¤ãƒ³ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function exportZengin() {
  const checked = Array.from(document.querySelectorAll('.zg-chk:checked'));
  const ids = checked.map(c => c.dataset.id);
  const targets = PENDING_TRANSFERS.filter(t => ids.includes(t.reqId));

  if (!targets.length) {
    alert('å‡ºåŠ›å¯¾è±¡ã®ç”³è«‹ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
    return;
  }

  if (!confirm(`ã€å…¨éŠ€ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ç¢ºèªã€‘\n\nå‡ºåŠ›ä»¶æ•°ï¼š${targets.length}ä»¶\nåˆè¨ˆæŒ¯è¾¼é¡ï¼šÂ¥${targets.reduce((s,t)=>s+t.payoutAmt,0).toLocaleString()}\n\nãƒãƒƒãƒˆãƒãƒ³ã‚­ãƒ³ã‚°ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦é€é‡‘ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚\n\nå‡ºåŠ›ã—ã¾ã™ã‹ï¼Ÿ`)) return;

  // æŒ¯è¾¼æ—¥ï¼ç¿Œå–¶æ¥­æ—¥ï¼ˆç°¡æ˜“è¨ˆç®—ï¼‰
  const now = new Date();
  const next = new Date(now); next.setDate(next.getDate()+1);
  if (next.getDay()===0) next.setDate(next.getDate()+1);
  if (next.getDay()===6) next.setDate(next.getDate()+2);
  const valueDate = next.getFullYear()+'/'+(next.getMonth()+1).toString().padStart(2,'0')+'/'+next.getDate().toString().padStart(2,'0');

  // å…¨éŠ€ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
  const content = generateZenginFile(targets, valueDate);

  // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆShift-JISå¤‰æ›ã¯æœ¬ç•ªã§å®Ÿè£…ã€ä»Šã¯UTF-8ï¼‰
  const ts = now.getFullYear().toString().slice(2)+(now.getMonth()+1).toString().padStart(2,'0')+now.getDate().toString().padStart(2,'0')+now.getHours().toString().padStart(2,'0')+now.getMinutes().toString().padStart(2,'0');
  const filename = 'CORETO_ZENGN_' + ts + '.txt';
  const blob = new Blob([content], {type:'text/plain;charset=utf-8'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = filename;
  a.click();
  URL.revokeObjectURL(a.href);

  // ãƒ­ã‚°è¡¨ç¤º
  const logWrap = document.getElementById('zg-log-wrap');
  const logEl = document.getElementById('zg-log');
  if (logWrap) logWrap.style.display = 'block';
  const nowStr = now.getFullYear()+'/'+(now.getMonth()+1).toString().padStart(2,'0')+'/'+now.getDate().toString().padStart(2,'0')+' '+now.getHours().toString().padStart(2,'0')+':'+now.getMinutes().toString().padStart(2,'0');
  if (logEl) {
    logEl.innerHTML += `[${nowStr}] âœ… å…¨éŠ€ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›: ${filename} / ${targets.length}ä»¶ / Â¥${targets.reduce((s,t)=>s+t.payoutAmt,0).toLocaleString()}\n`;
  }

  // å‡ºåŠ›æ¸ˆã¿ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–°
  const doneEl = document.getElementById('zg-done-today');
  const lastEl = document.getElementById('zg-last-export');
  if (doneEl) doneEl.textContent = parseInt(doneEl.textContent||'0') + targets.length;
  if (lastEl) lastEl.textContent = nowStr.slice(11);

  // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°ï¼ˆå‡ºåŠ›æ¸ˆã¿ï¼‰
  targets.forEach(t => { t.status = 'exported'; });
  renderZenginPreview();
  updateZenginSummary();

  // Slacké€šçŸ¥
  slackNotifyZenginExport({ count: targets.length, total: targets.reduce((s,t)=>s+t.payoutAmt,0), filename, valueDate, ts: nowStr });

  showToast('âœ… å…¨éŠ€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ â€” ' + filename);
}

// â”€â”€ Slacké€šçŸ¥ï¼ˆå…¨éŠ€å‡ºåŠ›ï¼‰â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function slackNotifyZenginExport({ count, total, filename, valueDate, ts }) {
  slackPost({
    text: `ğŸ“¥ å…¨éŠ€ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›å®Œäº† â€” ${count}ä»¶ Â¥${total.toLocaleString()}`,
    attachments: [{
      color: '#c9a840',
      blocks: [
        { type: 'section', text: { type: 'mrkdwn',
          text: '*ğŸ“¥ å…¨éŠ€ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‡ºåŠ›ã•ã‚Œã¾ã—ãŸ â€” ãƒãƒƒãƒˆãƒãƒ³ã‚­ãƒ³ã‚°ã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’ãŠé¡˜ã„ã—ã¾ã™*' }},
        { type: 'section', fields: [
          { type: 'mrkdwn', text: `*å‡ºåŠ›æ—¥æ™‚*\n${ts}` },
          { type: 'mrkdwn', text: `*ãƒ•ã‚¡ã‚¤ãƒ«å*\n\`${filename}\`` },
          { type: 'mrkdwn', text: `*ä»¶æ•°*\n${count}ä»¶` },
          { type: 'mrkdwn', text: `*åˆè¨ˆæŒ¯è¾¼é¡*\n*Â¥${total.toLocaleString()}*` },
          { type: 'mrkdwn', text: `*æŒ¯è¾¼æ—¥*\n${valueDate}ï¼ˆç¿Œå–¶æ¥­æ—¥ï¼‰` },
        ]},
        { type: 'section', text: { type: 'mrkdwn',
          text: 'âš ï¸ *ãƒãƒƒãƒˆãƒãƒ³ã‚­ãƒ³ã‚°ã®ã€Œç·åˆæŒ¯è¾¼ã€ç”»é¢ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦é€é‡‘ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚*' }},
      ]
    }]
  });
}

// â”€â”€ åˆæœŸåŒ– â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function initZengin() {
  // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆå¾Œã«æç”»ã™ã‚‹ãŸã‚é…å»¶
  setTimeout(() => {
    updateNextBatchTime();
    renderZenginPreview();
    setInterval(updateNextBatchTime, 60000); // 1åˆ†æ¯ã«æ›´æ–°
  }, 100);

  // ã‚¿ãƒ–ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ã‚‚æç”»
  const tab = document.querySelector('.vt:nth-child(3)');
  if (tab) {
    const orig = tab.onclick;
    tab.onclick = function(e) {
      if (orig) orig.call(this, e);
      setTimeout(() => { updateNextBatchTime(); renderZenginPreview(); }, 150);
    };
  }
})();
</script>

<div id="ref-modal-overlay" onclick="if(event.target===this)closeRefModal()">
  <div id="ref-modal">
    <div class="ref-mhdr">
      <div class="ref-mhdr-t">ğŸ”— ç´¹ä»‹ãƒªãƒ³ã‚¯ç™ºè¡Œ</div>
      <button onclick="closeRefModal()" style="background:none;border:none;color:var(--muted);font-size:20px;cursor:pointer;line-height:1">Ã—</button>
    </div>
    <div class="ref-mbody">
      <div style="font-size:11px;color:var(--sub);margin-bottom:14px;line-height:1.8">ã“ã®ãƒªãƒ³ã‚¯ã‹ã‚‰å…¥ä¼šã™ã‚‹ã¨ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ãŒè‡ªå‹•å…¥åŠ›ã•ã‚Œã¾ã™ã€‚</div>
      <div id="ref-code-selector"></div>
      <div style="font-size:10px;color:var(--muted);margin-bottom:4px;font-weight:600;letter-spacing:.5px">ç™ºè¡Œãƒªãƒ³ã‚¯</div>
      <div class="ref-url" id="ref-url-display">â€”</div>
      <button class="ref-copy-btn" onclick="copyRefLink()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
    </div>
  </div>
</div>

<button id="ref-float-btn" onclick="openRefModal()">ğŸ”— ç´¹ä»‹ãƒªãƒ³ã‚¯ç™ºè¡Œ</button>

<nav class="sp-bottom-nav" id="sp-pay-nav" style="display:none">
  <a href="coreto-agent-mypage.html" class="sp-nav-item">
    <span class="sp-nav-icon">ğŸ </span>
    <span class="sp-nav-label">ãƒ›ãƒ¼ãƒ </span>
  </a>
  <a href="coreto-pipeline.html" class="sp-nav-item">
    <span class="sp-nav-icon">ğŸ“‹</span>
    <span class="sp-nav-label">æ¡ˆä»¶</span>
  </a>
  <button class="sp-nav-item on">
    <span class="sp-nav-icon">ğŸ’¸</span>
    <span class="sp-nav-label">å³æ™‚æ‰•ã„</span>
  </button>
  <a href="coreto-kyc.html" class="sp-nav-item">
    <span class="sp-nav-icon">ğŸªª</span>
    <span class="sp-nav-label">KYC</span>
  </a>
  <a href="coreto-account-settings.html" class="sp-nav-item">
    <span class="sp-nav-icon">âš™ï¸</span>
    <span class="sp-nav-label">è¨­å®š</span>
  </a>
</nav>
<script>
if(window.innerWidth<=768){
  var nav=document.getElementById('sp-pay-nav');
  if(nav) nav.style.display='flex';
  document.body.style.paddingBottom='calc(68px + env(safe-area-inset-bottom))';
  // é‡‘é¡å…¥åŠ›ã‚’å¤§ãã
  document.querySelectorAll('#amount,input[type=number]').forEach(function(el){
    el.style.fontSize='24px';
    el.style.textAlign='center';
  });
  // å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚ºãƒ¼ãƒ ã‚¤ãƒ³é˜²æ­¢
  document.querySelectorAll('input,select').forEach(function(el){
    if(parseFloat(window.getComputedStyle(el).fontSize) < 16) el.style.fontSize = '16px';
  });
}
</script>

<script src="coreto-sp-init.js" data-nav="sp-bottom-nav"></script>
</body>
</html>
